<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>我的 2022 节点</title>
      <link href="/posts/124/"/>
      <url>/posts/124/</url>
      
        <content type="html"><![CDATA[<h1>我的2022节点</h1><p>时光飞逝，日月如梭，转眼间时间的齿轮就来到了2023年——的三月份，是时候写一下2022年的年终总结了。昨天和室友闲聊，说这是我在这里的第一个春天，转眼间我已经来这里半年了。室友说：你读博的时间都是你的青春，你人生中最好的五年，所以一定要多多记录这个阶段每个春夏秋冬发生的事。是啊，大学毕业是我人生中最后一个强制节点。至于博士，春去秋来，全年无休，如果不记录一下，时间会在无意识中消逝。</p><p>4月，收到美国offer。（但是6月2日才看到letter，对自己感到无语）</p><p>6月10日，本科毕业答辩。</p><p>6月13日，离开校园。</p><p>6月27日，和aohui第一次短途旅行去沈阳（去递签）。以后要和他一起旅行好多次。</p><p>7月26日，和aohui分别，在这之前，和对方度过了最快乐的一个学期和两个假期。一起去图书馆写论文，打羽毛球，一起吃一日三餐，去校园的各个角落探险，去晨跑，去做实验，去散步。</p><p>8月1日，出签。</p><p>8月13日，出发去美国。父母和金声来送我。于LA转机，幸运地过了海关。</p><p>8月14日（美东8月13日）开始月租生活。室友带我去了Walmart，中超，StopShop，汉堡王。</p><p>8月21日，第一次去学校，交到了第一个印度朋友，第一次见到导师。领到了ID。</p><p>8月22日，学期开始，感觉只能听懂教授讲的内容，笑话什么的理解有困难。</p><p>9月，陆续收到SSN，医疗保险，checking账户。</p><p>9月14日，收到第一次工资。</p><p>10月的某一天，考了Learner Permit，19/20。</p><p>10月的某一天，开了信用卡，正式开始攒信用记录。</p><p>11月，为买车焦虑，凑钱，看车，被汇率和车价折磨。</p><p>12月19日，开始倒计时。Fail掉了第一次路考。迷茫。</p><p>12月21日，买车和保险。卖车的sale老爷爷跟我说congratulations。说看了我的年龄和他女儿一样大，而我已经在异国他乡自己生活了。</p><p>12月30日，给最喜欢的教授发去新年祝福，教授回复&quot;You are a very smart woman who should go far.&quot;</p><p>23年1月6日，通过路考。</p><p>1月13日，收到正式驾照。困了我两个月的实验终于做出来了。</p><p>1月13日，5.a.m计划正式开始。</p><p>1月19日，这一天的日记里说自己很想aohui。新年。</p><p>1月27日，5.a.m计划无疾而终。</p><p>2月8日，第一次报税，会收到退税。心态很宽松，实验做得不错，顺利地过渡到了下一个阶段。</p><p>2月24日，第一次载同学们去了电影院，看了Antman，无聊，肤浅。</p><p>2月28日，在Goldman Sachs开了saving账户开始存钱。希望以后能从一叶小舟变成一艘巨轮。</p><p>3月5日，很想去Arizona定居。</p><p>总体来说，这半年过得还是很充实的，发生了很多事。不敢说成长了很多，但是也鼓起了很多次勇气。从不敢开口说话，开口前要打好草稿，到现在在英语环境里感到舒服，不以自己的口语为耻，也是改变了不少。这里非常平静，让人可以自由地向外探索，也可以关注到自身成长。生活上，感觉遇到的人都很热情，普遍的自信也感染到我。学术上，导师给我创造了自由的环境让我探索，同事也给我提供了很多必要的帮助和精神鼓励。aohui不在身边，很多事情只能自己做，但是这也很好，给双方从远处了解自己和审视对方的机会，对关系也没有坏处。这一年，我独立做出了很多决定，我第一次如此强烈地感受到作为一个成年人，脚如何踩到大地上，如何站稳，如何融入社会，如何在社交关系中找寻自我，是于我自身成长发生剧变的一年。</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智齿 -2</title>
      <link href="/posts/53490/"/>
      <url>/posts/53490/</url>
      
        <content type="html"><![CDATA[<p>刚拔完左边两颗智齿，嘴里还含着血，强忍着疼痛写下这篇文章。</p><p>4 颗智齿在一年前就陆陆续续长出来了，这期间也是痛苦不断。特别是刚长出来的时候，长歪的智齿经常刮到口腔侧壁，甚至有好几次都咬破了，吃什么都得小心翼翼的，动作不敢太嚣张。智齿基本长出来之后，刮口腔壁的现象好了一些，但是一旦刮到就会非常疼，因为智齿是歪的，一刮着就会把肉挤进下面的牙里，相当于自己咬自己……毕设期间没有太多时间，又是在外省，就想着到家里再去拔。临近开学，越发觉得左下的智齿在顶前面的牙，时不时感觉隐隐作痛，就想着哪天去医院拍个片子看看要不要拔。</p><p>这不今天就去了，一到医院口腔科，看到医生在玩蜘蛛纸牌？？表明想拔智齿后，医生就开了个单让我去放射科拍片子。医生还特意说，如果想快点，可以直接用手机拍电脑屏幕上的片给他。这点还是挺好的，省去了等片子的时间。拍完片子给医生一看，下面两颗都是阻生齿，比较难拔。医生建议我先拔左边两颗，我问能不能先把下面的左右两颗拔了，医生说不能同时拔两边的，因为这样吃不了东西。医生还反复问我有没有吃早饭，因为拔完之后基本上就吃不了东西了，所以拔之前一定要多吃点。行，又是开单子、缴费、拿药一顿操作，准备开始拔牙。</p><center>  <figure>    <img src="https://s2.loli.net/2022/09/01/49lTVAJzypQqWmY.png" alt="左边" style="zoom:30%;" /><img src="https://s2.loli.net/2022/09/01/LoIW67mt23Rb9ip.png" alt="右边" style="zoom: 38%;" />  </figure></center><p>刚躺上台子，还不是很紧张，以为会很顺利。旁边的助理护士在准备麻药，医生则在准备拔牙的器具。麻药准备好后，护士叫我张大嘴，拿个什么东西清理了一下牙齿，应该是消毒吧。麻醉的过程还是很疼的，针头扎进牙龈，不是只扎进去一点点，而是一段一段地往深了扎，感觉扎了至少有一厘米深。能很清楚地感觉到针头扎进了牙龈，而且注射并不是一下打完就完事，针头边注射边还在转动，应该是为了麻醉得更均匀。下面打完了打上面，这一下真的是疼到了，扎得特别快特别深，疼得我还叫了一下，身体也不自主地绷紧了。总算是打完了，护士叫我休息一下等麻药生效。</p><p>慢慢地，左边没有了知觉，感觉不到左半边牙的存在，这种感觉就像是坐久了腿麻了一样。我还特地摸了摸下巴，完全没有感觉了。由于左边下面那颗是阻生齿，需要先把突出的那一小块给切掉，这样才能把整个牙齿拔出来。医生拿出了小电锯，助理护士就拿着一个会喷水的管子，应该是用来清理和降温的。电锯一接触牙齿，因为麻药起效没有什么感觉，但是牙齿被磨碎散发的石灰味让人有点反胃。再加上牙龈被切掉后不可避免会流血，就这样石灰味、血味和不停分泌的口水混合在一起，在嘴里翻腾。口水积累到一定程度，会不自觉的下咽，那就更觉得恶心了，干呕了好几次。切了几分钟，医生试着把小块牙齿拔下来，可能是牙太硬了，拔了好几次牙也是纹丝不动。医生说了一句，“敲几下吧”，助理护士就拿来了小锤子。医生就拿着凿子顶住切开的缝，护士在旁边敲。因为有麻药的作用，那种感觉很难描述，不是很疼，但是下巴感觉被什么用力撞了一样，冲击力很大。敲了有 5、6 下，医生又拿起镊子开始拔，没几下那小块牙齿就下来了，终于松了一口气。但是难的还在后面。</p><img src="https://s2.loli.net/2022/09/01/YcszOPkyMClJr8N.png" alt="切掉小块牙" style="zoom:60%;" /><p>把阻碍切掉后，医生开始拔整颗牙。大牙不愧是大牙，生命力及其顽强，非常牢固，任凭医生怎么用力拔也没拔下来。应该是切的不够，被前面的牙挡住了所以才拔不下来。医生又拿起电锯开始切，嘴里又是翻腾的石灰味、血味和口水味……医生再次拿起了镊子，这下应该能下来了吧。谢天谢地，这次终于拔下来了。能微微感觉到牙齿连接到牙龈的部分被撕扯下来的过程，像是什么东西被拉断一样，一个字，疼。一拔出来牙龈就开始大量出血，医生拿了好几个棉球吸血。牙齿拔出来后牙龈上就留下了个洞，再加上之前切牙造成的损伤，导致创伤面有点大，需要用线把创面缝上。缝的过程没什么感觉，也不疼，很快就缝好了。</p><p>下面解决好后，开始弄上面。我以为也会像下面那样麻烦，但是好像没花到 10 秒医生就搞定了。不是阻生齿好拔多了，拿镊子夹住后硬拔就能拔下来，虽然那一瞬间很疼，好在快。上面的创面不大，没有缝针。医生拿了两个棉球放到嘴里，让我至少咬住半小时。到这里算是结束了。</p><p>在椅子上躺了一会，由于麻药药效还在，不会很疼。只是过 2 分钟就要吐一次口水，准确的说是血加口水，量还不小，嘴里一股腥味。等了一会觉得没什么问题后就回家了，过七天拆线。医生开了一个止痛药和防感染药，这几天吃。</p><p>回到家后，麻药开始慢慢退了，疼痛感也渐渐加剧。maomao 提醒我赶紧吃止痛药，不得不说确实有用，到现在也只是微微的疼，甚至还能写文章。医生嘱托今天两小时内不能进食，不能吃热的和硬的食物。看来今天只能喝喝粥了。这时候嘴里还是会不停地流血和口水，过会儿就得吐一次。差不多 2 个小时后血就慢慢变少了，麻醉感也没有了，稍微有点疼。只能喝喝水，嘴张太大很疼。</p><p>不敢想象还要再拔/疼一次……不过下次应该会好一些，右边的没有左边的难拔。算上拍片子和药钱，两颗智齿花费一共 900 左右。除了挂号走医保，其他全部自费，不能医保报销，肉疼！！</p><p><img src="https://s2.loli.net/2022/09/01/EiHRtTgIx6L3vVS.png" alt="费用"></p><p>如果你看到了这篇文章，碰巧也想拔智齿，下面几点或许会有用：</p><ul><li>尽早拔，不要等到疼得不行了再去</li><li>拔之前吃饱饭，喝够水，拔完张嘴会很疼</li><li>抹点润唇膏，长时间张嘴会干</li><li>裤兜里的东西拿出来，躺着可能会掉</li></ul>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly 主题 Footer 美化，简洁大气</title>
      <link href="/posts/26947/"/>
      <url>/posts/26947/</url>
      
        <content type="html"><![CDATA[<p>先上效果，页脚包含博客的一些文章分类和常用链接，便于快速定位。</p><p><img src="https://s2.loli.net/2022/08/29/S16N9J3VOdjRBte.jpg" alt="我的页脚"></p><p>定位到 Butterfly 主题文件夹，打开 <code>hexo-theme-butterfly/layout/includes/footer.pug</code> 文件，修改如下，具体的内容根据需要修改。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#ah-footer</span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 博客文章</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&#x27;/archives/&#x27;, data-pjax-state=&#x27;&#x27;) 全部文章</span><br><span class="line">      a.footer-item(href=&#x27;/tags/&#x27;, data-pjax-state=&#x27;&#x27;) 文章标签</span><br><span class="line">      a.footer-item(href=&#x27;/categories/&#x27;, data-pjax-state=&#x27;&#x27;) 文章分类</span><br><span class="line"></span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 学习笔记</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&#x27;/tags/R/&#x27;, data-pjax-state=&#x27;&#x27;) R 语言</span><br><span class="line">      a.footer-item(href=&#x27;/tags/Python/&#x27;, data-pjax-state=&#x27;&#x27;) Python</span><br><span class="line">      a.footer-item(href=&#x27;/tags/Linux/&#x27;, data-pjax-state=&#x27;&#x27;) Linux</span><br><span class="line"></span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 博客链接</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&#x27;/friends/&#x27;, data-pjax-state=&#x27;&#x27;) 友链动态</span><br><span class="line">      a.footer-item(href=&#x27;/link/&#x27;, data-pjax-state=&#x27;&#x27;) 友情链接</span><br><span class="line">      a.footer-item(href=&#x27;/bb/&#x27;, data-pjax-state=&#x27;&#x27;) 哔哔点啥</span><br><span class="line"></span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 博客改造</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&#x27;/posts/43603/&#x27;, data-pjax-state=&#x27;&#x27;) 博客部署</span><br><span class="line">      a.footer-item(href=&#x27;/categories/博客魔改/&#x27;, data-pjax-state=&#x27;&#x27;) 博客魔改</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">  .footer-group</span><br><span class="line">    h3.footer-title 关于本站</span><br><span class="line">    .footer-links</span><br><span class="line">      a.footer-item(href=&#x27;/about/&#x27;, data-pjax-state=&#x27;&#x27;) 关于博主</span><br><span class="line">      a.footer-item(href=&#x27;/cc/&#x27;, data-pjax-state=&#x27;&#x27;) 版权协议</span><br><span class="line">      a.footer-item(onclick=&#x27;btf.scrollToDest(0, 500)&#x27;) 回到顶部</span><br><span class="line"></span><br><span class="line">#fotter-copyright(style=&#x27;font-size:90%&#x27;)</span><br><span class="line">  .copyrights</span><br><span class="line">    span= _p(&#x27;Copyright © 2022 Aohuiliu. &#x27;)</span><br><span class="line">    span= _p(&#x27; All rights reserved.&#x27;)</span><br><span class="line">  .framework-info</span><br><span class="line">    span= _p(&#x27;Powered by&#x27;) + &#x27; &#x27;</span><br><span class="line">    a(href=&#x27;https://hexo.io&#x27;) Hexo</span><br><span class="line">    span.footer-separator &amp;</span><br><span class="line">    a(href=&#x27;https://github.com/jerryc127/hexo-theme-butterfly&#x27;)= &#x27;Butterfly&#x27;</span><br></pre></td></tr></table></figure><p>结构搞定后，还需要 CSS，打开 <code>hexo-theme-butterfly/source/css/_layout/footer.styl</code> 文件，修改如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#footer</span></span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">1rem</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#fotter-copyright</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">2rem</span></span><br><span class="line">  <span class="attribute">color</span>: var(--font-color)</span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">color</span>: var(--font-color)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$theme</span>-link-color</span><br><span class="line">      <span class="attribute">text-decoration</span>: underline</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.footer-separator</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#ah-footer</span></span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  <span class="attribute">flex-direction</span>: row</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">900px</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1rem</span> auto</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">2rem</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">1rem</span></span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.footer-group</span></span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">100px</span></span><br><span class="line">    <span class="attribute">text-align</span>: center</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.footer-links</span></span><br><span class="line">      <span class="attribute">display</span>: flex</span><br><span class="line">      <span class="attribute">flex-direction</span>: column</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">a</span><span class="selector-class">.footer-item</span></span><br><span class="line">        <span class="attribute">color</span>: var(--font-color)</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">1rem</span></span><br><span class="line">        <span class="attribute">margin</span>: .<span class="number">38rem</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">color</span>: var(--btn-hover-color)</span><br></pre></td></tr></table></figure><p>保存后 Hexo 三连即可看到效果。</p>]]></content>
      
      
      <categories>
          
          <category> 博客魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>响应更迅速，去除 macOS Dock 栏显示和隐藏的延时</title>
      <link href="/posts/28191/"/>
      <url>/posts/28191/</url>
      
        <content type="html"><![CDATA[<h2 id="问题描述">问题描述</h2><p>笔记本屏幕有点小，打开 Dock 的自动隐藏功能后稍微会好一点，可以多看几行字。但是问题来了，这个自动隐藏功能好是好，就是把鼠标移过去的时候，Dock 总会延时那么几秒才出现。猜测是系统为了防止误触发设置的延时，不喜欢的话可以去除。</p><p><img src="https://s2.loli.net/2022/08/08/MZDBqwCRPKksO7o.png" alt="Dock 出现有延时"></p><h2 id="解决方法">解决方法</h2><p>打开终端，输入以下命令即可。</p><p><strong>Intel 芯片：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.dock autohide-delay -float 0 &amp;&amp; killall Dock</span><br></pre></td></tr></table></figure><p><strong>M1 芯片：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.apple.dock autohide-delay -float 0 &amp;&amp; defaults write com.apple.dock autohide-time-modifier -float 0.4 &amp;&amp; killall Dock</span><br></pre></td></tr></table></figure><p>如果不想要，可以用以下命令恢复默认值。</p><p><strong>Intel 芯片：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults delete com.apple.dock autohide-delay &amp;&amp; killall Dock</span><br></pre></td></tr></table></figure><p><strong>M1 芯片：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defaults delete com.apple.dock autohide-delay &amp;&amp; defaults delete com.apple.dock autohide-time-modifier &amp;&amp; killall Dock</span><br></pre></td></tr></table></figure><p>搞定！现在只要把鼠标靠近屏幕边缘，Dock 立马就会出现了，一离开屏幕边缘 Dock 马上就会退出，美滋滋。</p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>写在一周年</title>
      <link href="/posts/56172/"/>
      <url>/posts/56172/</url>
      
        <content type="html"><![CDATA[<p>啊，转眼间竟然和 aohuiliu 在一起一周年了。这篇文章的主旨就是赞美他。</p><p>前几天看他博客，这才发现他在 6.27 发的那条紧张。6.27 是我去美国大使馆面签的时间，他发的时间是我通过了门口基础检查，自己一个人进到办公室里的时间。一周前，我准备签证材料，并交了面签费，预约了面签日期的那一天，他说我陪你一起去，还订了我们两个人的火车票，这是我们两个第一次一起出远门。出发的那一天，为了赶早上 6 点的火车，我们4点就起床了。上一次我这么早起来，是为了去机场送他回家。只不过这一次我不会一个人流着眼泪坐地铁，回家只能看见没叠的被子，几小时前，我们还在里面共枕而眠。痛苦的回忆总是生动的。</p><p>留学这件事贯穿了我们在一起的整段时光，我们相遇于大三下学期，正是我开始认真准备留学，从最开始的丹麦、到无疾而终的新加坡再到最后意料之外的美国。一年以来，我从未真正放心过一次，也没有庆祝过阶段性的胜利，在还没踏上异国土地时，一切都只是可能。我的所有焦虑，所有鼓起勇气的行动，他都是见证者。那个夏天，我还很天真地觉得我会有一天能心无旁骛地享受和他的恋爱，可以全身心去经营这段关系，留学的烂摊子总有一天会结束，而这一天肯定会在毕业前。在一次又一次希望落空后，我逐渐认清现实。aohuiliu 的命运某种程度上和我也很相似，都是从天而降的幸运，又因为各种原因落空，最后获得了一个 75% 的 happy ending。美好的东西总是不那么纯粹，或者说美好是一件复杂的事。</p><p>说回面签，这是我去美国的最后一道难关。aohui 买票的时候说他没问题，他在火车上也能睡，我说我不行，我只能在床上睡。可是那天早上 aohui 一点也没睡，我却因为有他在身边，在车上熟睡了 1 小时。虽然我还嘲笑了他：不是说很能睡吗。其实，这是他 involved 在我的事情上的表现，哪怕这件事意味着和他的分离。他总是这样，事事细心，事事上心。</p><p>他的情感不比我的粗糙，我们一些细小的情绪也能相通。在我害怕开口问问题的时候，他有意识地鼓励我去表达；在我们一起陷入散漫的时候，他会指出这些问题并引导我改正；他不会过多干涉我的事，只是默默关注，从没掉队。他能感受到我的感受，甚至更多。我的情绪被他包裹，我一回头他总是在。我变得有计划性，也开始学会珍惜时间。他以一种不高高在上的方式让我变得更好。我印象里的他是沉默的，95% 有求必应的（剩下 5% 是在他程序跑不通的时候），克制而细腻的。他是我的伴侣，也是我最好的朋友。</p><p>我不相信所谓纯粹的爱，爱总是泥沙俱下，包含着控制、利益和虚荣。在这之前我收到的爱，很多都需要我用独立人格去交换。当我真正开始珍惜我独立个体的身份时，这些爱都会原形毕露，但同时也有一些爱会被吸引过来——对我来说，就是来自他的爱。一个人能给予怎样的爱，很大程度上取决于他本身是怎样的人。aohui 给我的爱，是细腻的，是尊重的，是引人向上的，正如我所认识的他。</p><p>Aohui,  Happy anniversary!</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随想 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 常用命令</title>
      <link href="/posts/19568/"/>
      <url>/posts/19568/</url>
      
        <content type="html"><![CDATA[<h2 id="命令格式与目录处理命令ls">命令格式与目录处理命令ls</h2><p>命令格式： 命令 [-option] [agreement]</p><p>​简化选项（一个-调用）：-a = --all（完整选项，两个-调用）</p><h3 id="目录处理命令：ls（list）">目录处理命令：ls（list）</h3><p>路径：/bin/ls</p><p>权限：所有用户</p><p>查看隐藏文件：<code>ls -a</code>（“.”开头的是隐藏文件）</p><p>查看根目录： <code>ls /</code></p><p>显示长格式： <code>ls -l</code>，可简写为<code>ll</code></p><p>显示人性化格式： <code>ls -h（lh/hl）</code></p><p>显示目录信息，而不显示目录下文件的信息：<code>ls -d（ld）</code></p><p>查看文件incode索引节点： <code>ls -i</code>，相当于文件id</p><p>total：总引用量</p><p>后6部分：</p><ol start="2"><li>引用计数（4，20，5…）</li><li>chenlong：所有者</li><li>staff：所属组</li><li>文件大小：默认单位字节</li><li>文件最后一次修改时间</li><li>文件名</li></ol><p><strong>文件和用户的关系：</strong></p><p>​User：所有者，<u>只能有一个</u>，可以转变，一般是创建人</p><p>​Group：所属组，用户的集合</p><p>​Others：其他人，既不是user也不是group</p><p><strong>rwxr-xr-x</strong></p><p>​文件类型：d：direct，目录；l：link，软连接；-：文件</p><p>​文件权限：r读/w写/x执行，没有特定权限使用-表示</p><p>​后9位3位一组，分别表示U，G，O的权限</p><h2 id="目录处理命令">目录处理命令</h2><h3 id="mkdir">mkdir</h3><p>不要在根目录下随便创建目录</p><p>默认下只能在已有目录下创建新目录</p><p>递归创建：<code>-p</code>，建立多级目录</p><p>同时创建多个目录：[参数]部分并列写，用空格分开即可</p><blockquote><p>eg：mkdir ./Desktop/Linux/test1 ./Desktop/Linux/test2</p></blockquote><h3 id="cd">cd</h3><p>切换到指定目录</p><h3 id="pwd（print-working-directory）">pwd（print working directory）</h3><p>显示当前目录</p><h3 id="cd-…">cd …</h3><p>.表示当前目录，…表示当前目录的上一级目录</p><h3 id="rmdir">rmdir</h3><p>删除目录，只能删除空目录，哈哈</p><h3 id="cp（copy）">cp（copy）</h3><p><code>cp -rp</code> [原文件或目录][目标目录]：可以同时复制多个文件，只需要在最后写目标目录</p><p><code>cp -r</code> 复制目录</p><p><code>-p</code> 保留文件属性：可以复制创建时间，如果不加此选项，生成的复制文件以当前时间为准</p><p>复制的同时改名：写完目标目录后路径加改后的文件名</p><blockquote><p>cp -r ./Linux/test/makedir ./Linux/test/changename</p></blockquote><h3 id="mv：剪切，move">mv：剪切，move</h3><p>mv [原文件或目录] [目标目录]</p><p>剪切同时改名，如果在同一目录下，即为改名</p><h3 id="clear">clear</h3><p>清屏</p><h3 id="rm">rm</h3><p>只能删除文件</p><p><code>-f</code>：强制执行</p><p><code>-r</code>：删除目录</p><p><code>ctrl+c</code>：终止操作</p><h2 id="文件处理命令">文件处理命令</h2><h3 id="touch">touch</h3><p>创建文件，注意指定路径，如无指定路径，即在当前路径下创建文件</p><p>文件名：理论上除了/不能用别的都可以，但是不要随便起。</p><p>文件名中包含空格，会创建两个文件（即touch可以创建多个文件）</p><p>如果一定要带空格， 用双引号括起来，但是还是别了，所有别的操作都要加引号</p><p>后缀名有没有无所谓</p><h3 id="cat">cat</h3><p>查看文件</p><p><code>-n</code>：浏览同时加行号</p><p>长文件：不适合</p><h3 id="tac">tac</h3><p>反向列示，显示内容</p><h3 id="more">more</h3><p>分页显示文件内容，空格/F翻页，回车下一行，<code>q</code>退出浏览</p><h3 id="less">less</h3><p>分页显示文件内容，可向上翻页</p><p>pageup/u一页一页向上翻</p><p>上箭头一行行翻</p><p>浏览状态中输入“<code>/➕关键词</code>”搜索，按<code>n</code>（next）找到下一处，可遍历文件</p><h3 id="head">head</h3><p>显示文件前几行</p><p><code>-n</code>指定行数，默认为前10行</p><h3 id="tail">tail</h3><p>显示文件后几行</p><p><code>-n</code> 用法与head一样</p><p><code>-f</code> 动态显示文件末尾内容</p><h2 id="链接命令">链接命令</h2><h3 id="ln">ln</h3><p><code>-s</code> [原文件][目标文件]：创建软连接，后缀名.soft</p><p>默认生成硬链接：后缀名.hard</p><p><strong>软链接和硬链接的特征</strong></p><ul><li><p>软：类似windows快捷方式，所有人都具有同样的操作权限，lrwxrwxrwx</p><p>​文件很小，只是符号，箭头指向源文件，源文件路径改变/被删除，则找不到</p></li><li><p>硬：cp -p+同步更新，源文件丢失也可以正常访问，通过i节点识别，每个文件都具有i节点，但i节点不一定只对应一个文件，硬链接和源文件具有同样的i节点</p></li><li><p>硬链接的应用场景：实时备份</p></li><li><p>硬链接的局限：不能跨分区，不能针对目录使用，软链接都可</p></li></ul><hr><h2 id="权限管理命令chmod">权限管理命令chmod</h2><p>change the permissions mode of a file</p><p>语法：<code>chmod \[&#123;ugoa&#125;&#123;+-=&#125;&#123;rwx&#125;] [文件/目录]</code></p><p>同时赋予多个权限</p><blockquote><p>chmod g+w,o-r <a href="http://xn--48s02uimm87gwkax38k.md">学院管理政策.md</a></p></blockquote><p>直接等于</p><blockquote><p>chmod g=rwx <a href="http://xn--48s02uimm87gwkax38k.md">学院管理政策.md</a></p></blockquote><p>用数字管理权限：</p><ul><li><p>r =4</p></li><li><p>w=2</p></li><li><p>x=1</p><p>-&gt; rwx=7</p><p>-&gt; rw-=6</p><p>-&gt; r-- =4</p></li></ul><p>写出来数字要能对应权限</p><blockquote><p>e.g: 532 -&gt; r-x-wx-w-</p></blockquote><blockquote><p>e.g: chmod 640 <a href="http://xn--48s02uimm87gwkax38k.md">学院管理政策.md</a></p></blockquote><p>-R 选项：递归修改，修改目录下的所有文件权限</p><h3 id="文件与目录的权限">文件与目录的权限</h3><p>对于文件：</p><ul><li>r : cat/more/less/head/tail</li><li>w: vim</li><li>x: script command</li></ul><p>对于目录：</p><ul><li>r：ls</li><li>w：touch/rm/mkdir/rmdir</li><li>x : cd</li></ul><p>对于目录，r和x权限总是同时出现的</p><p><strong>对于文件，能够删除这个文件并不等价于对文件本身w权限，而是等价于对于其所在目录有w权限</strong></p><h2 id="其他权限管理命令">其他权限管理命令</h2><h3 id="chown">chown</h3><p>change file ownership，改变文件所有者</p><p>语法：<code>chown \[用户] [文件或目录]</code></p><p>root权限可以随意改变所有者</p><p>改变所有者之前确定该用户存在</p><h3 id="chgrp">chgrp</h3><p>语法：<code>chgrp \[用户组] [文件/目录]</code></p><p>改变文件所属组</p><h3 id="umask">umask</h3><p>-S 以rwx形式显示新建文件缺省权限</p><p>功能：显示、设置文件的缺省权限</p><p>注意：linux中新建文件没有x权限</p><p>umask值：0022</p><p>0: 特殊权限</p><p>022: — -w-</p><p>真正对应的权限应该为其与777的逻辑与（同时具有的权限则失去）</p><img src="https://s2.loli.net/2022/07/12/i1atPm7Rg35Npxj.png" alt="umask" style="zoom:50%;" /><p>更改默认缺省权限：umask xxx</p><hr><h2 id="文件搜索命令find">文件搜索命令find</h2><h3 id="find">find</h3><p>搜索会占用大量服务器资源，尽量少用；搜索范围越小越好，搜索条件越精准越好</p><p>windows搜索软件：everything</p><p>语法：<code>find \[搜索范围] [选项] [匹配条件]</code></p><p>选项：</p><ul><li><p><code>-name</code> ：精准搜索，只有名字init的文件会被搜索出来</p><blockquote><p>find /etc init</p></blockquote><ul><li><code>*searchname*</code> ：搜索所有包含init的文件</li></ul><blockquote><p>find /etc *init*</p></blockquote><ul><li><code>Searchname*</code> :搜索以init开头的文件</li></ul><blockquote><p>find /etc init*</p></blockquote><ul><li><code>?</code>表示精确字符：指定有几个字符, 搜索init后面有三个字符的文件</li></ul><blockquote><p>find /etc init???</p></blockquote></li><li><p>-iname：不严格区分大小写</p></li><li><p>-size：根据文件大小查找，要换算成数据块单位（Linux系统中存储文件的最小单位）</p><p>1 数据块 = 512 字节 = 0.5 k</p><p>100 MB = 102400 KB = 204800 数据块</p><blockquote><p>find / -size +204800 # 在根目录下搜索大于100 MB的文件</p></blockquote></li><li><p>-user：根据所有者查找</p><blockquote><p>find /home -user shenchao # 在沈超家目录下查找</p></blockquote></li><li><p>-group：根据所属组查找</p></li><li><p>-amin：根据访问时间查找 access</p></li><li><p>-cmin：查找属性改变的文件 change</p><blockquote><p>find /etc -cmin -(+=)5 # 在etc目录下查找5分钟内被更改过属性的文件</p></blockquote></li><li><p>-mmin：查找内容改变的文件 modify</p></li><li><p>-a：and 两个条件同时满足</p></li><li><p>-o：or 两个条件满足一个即可</p><blockquote><p>find /etc -size +163840 -a -size =204800 # 在etc下查找大于80 MB小于100 MB的文件</p></blockquote></li><li><p>-type： 根据文件类型查找 f文件，d目录，l软连接文件</p><blockquote><p>find /etc -name init* -a -type f</p></blockquote></li><li><p>对查找到的结果执行操作：</p><p>**-exec/ok 命令 {}; **     表示对搜索结果执行操作</p><p>-exec和-ok的区别：-ok会挨个询问每个文件是否要执行操作</p><blockquote><p>find /etc -name init* -a -type f -exec ls -l {};</p></blockquote></li><li><p>-inum：查找i节点对应的文件，可以用来找硬链接，还有文件名很奇怪的文件</p><blockquote><p>find . -inum 31531 -exec rm {};  # 在当前目录下查找i节点为31531的文件并删除</p></blockquote></li></ul><h2 id="其他文件搜索命令">其他文件搜索命令</h2><h3 id="locate">locate</h3><p>秒搜，但是有延迟，需要文件资料库更新</p><p>语法：locate 文件名</p><p>手动更新文件资料库：updatedb</p><p>但是注意文件资料库的收录范围，不在范围里也可能找不到</p><p>-i选项：不区分大小写</p><h3 id="which">which</h3><p>查找命令所在路径，以及<strong>别名</strong>信息</p><p>语法：which 命令</p><h3 id="Whereis">Whereis</h3><p>搜索命令所在目录及<strong>帮助文档</strong>路径</p><p>语法：whereis 命令</p><h3 id="grep">grep</h3><p>查找文件内容，关键字所在位置</p><p>语法：grep [选项] “搜索内容” 文件名</p><p>-i 不区分大小写</p><p>-v 排除指定字串</p><p>-n 输出行号</p><p>–color=auto 搜索出的关键字用颜色显示</p><blockquote><p>grep -v ^# /etc/inittab #排除以#为开头的行，可以不查看文件注释</p></blockquote><p>如果不加^，可能会同时排除行中含有#的行内容。</p><hr><h2 id="man">man</h2><p>语法: man [命令或配置文件]</p><blockquote><p>man ls</p><p>/-d #搜索关于-d选项的内容</p><p>q #退出</p></blockquote><p>查看配置文件的帮助：存放信息，格式</p><blockquote><p>man services</p></blockquote><p><strong>不需要加绝对路径，就写配置文件的名称即可</strong></p><blockquote><p>man passwd</p></blockquote><p>passwd：同时是一种命令和一种配置文件</p><p>用whereis查看会显示两种:man1和man5，1表示命令的帮助，5表示配置文件的帮助</p><blockquote><p>man 5 passwd</p></blockquote><h2 id="whatis">whatis</h2><p>查看命令简短信息</p><blockquote><p>whatis ls</p></blockquote><h2 id="apropos">apropos</h2><p>查看配置文件简短信息，加命令名称（无路径）即可</p><h2 id="–help">–help</h2><p>查看命令选项</p><p>语法：命令 --help</p><blockquote><p>touch --help</p></blockquote><h2 id="date">date</h2><p>查看/更改系统时间</p><p>更改系统时间，格式先用man date查看一下，就不用背了</p><h2 id="info">info</h2><p>和man差不多</p><h2 id="help">help</h2><p>查看shell内置命令的帮助信息</p><p>shell内置命令：umask, if, case</p><p>如果对shell内置命令用which/whereis找不到，会得到shell（bash）的帮助信息</p><hr><h2 id="useradd">useradd</h2><p>语法：useradd 用户名</p><h2 id="passwd">passwd</h2><p>设置用户密码</p><p>passwd 用户名</p><p>root可以更改所有用户的密码，还可以更改很简单的密码，但是不要</p><p>普通用户可以更改密码，但太简单的不会被系统接受</p><h2 id="who">who</h2><p>查看登陆用户的信息</p><ol><li>登录用户名</li><li>登录终端：tty表示本地终端，pts表示远程终端</li><li>登录时段</li><li>登陆机器IP地址，如果没有则为本机</li></ol><h2 id="w">w</h2><p>查看更详细的登录信息</p><ol><li>当前系统的时间</li><li>up：Linux已经连续运用的时间（uptime命令也可以查看）</li><li>users：使用过的用户数</li><li>load average：1，5，15min的服务器负载，大于5很大</li><li>IDLE：空闲时间</li><li>PCPU：当前循环中进行中命令对应的进程占用的CPU时间</li><li>JCPU：累计占用的CPU时间</li><li>WHAT：当前用户正在进行什么命令</li></ol><hr><h2 id="gzip">gzip</h2><p>语法：gzip [文件]</p><p>压缩后文件格式：gz</p><h2 id="gunzip-gzip-d">gunzip/gzip -d</h2><p>解压缩.gz的压缩文件</p><p>gunzip [压缩文件]</p><ul><li><p>压缩比可以达到一倍，很惊人</p></li><li><p><u>只能压缩文件</u></p></li><li><p>不保留原文件</p></li></ul><h2 id="tar">tar</h2><p>打包目录</p><p>语法：tar 选项[-zcf] [压缩后文件名] [目录]</p><p>-c 打包</p><p>-v 显示详细信息</p><p>-f 指定文件名，最后写上.tar（没有也能行，但不好）</p><p>-z 打包同时压缩</p><p>打包完成之后在gz压缩一下，即.tar.gz，常见于源代码压缩</p><blockquote><p>tar -zcf Jpan.tar.gz Japan #打包的同时压缩（-z表示用gzip压缩）</p></blockquote><h2 id="tar解压缩">tar解压缩</h2><p>-x 解包</p><p>其他选项相同</p><blockquote><p>Tar -zxvf Japan.tar.gz</p></blockquote><h2 id="zip">zip</h2><p>windows和linux都支持，一般linux支持的压缩格式windows都支持</p><p>zip [选项] [压缩后文件名] [文件或目录]</p><p>-r 压缩目录</p><p>压缩后格式 .zip</p><p>压缩效果一般</p><h2 id="unzip">unzip</h2><p>解压</p><h2 id="bzip2">bzip2</h2><p>bzip2 选项[-k] [文件]</p><p>-k ：产生压缩文件后保留原文件</p><p>压缩后文件格式：.bz2</p><blockquote><p>tar -jcf Japan.tar.bz2 Jpan #打包的同时用bzip2压缩（-j表示用bzip2压缩）</p></blockquote><h2 id="bunzip2">bunzip2</h2><p>bunzip2 选项[-k] [压缩文件]</p><blockquote><p>tar -xjf Japan.tar.bz2 #解压tar.bz2压缩的文件</p></blockquote><hr><h2 id="shutdown">shutdown</h2><p>语法：shutdown [选项] 时间选项</p><p>选项：</p><p>-c 取消前一个关机命令</p><blockquote><p>定时关机算错了</p></blockquote><p>-h 关机</p><blockquote><p>shutdown -h now #立即关机</p><p>shutdown -h 20:30 #定时关机</p></blockquote><p>-r 重启</p><blockquote><p>shutdown -r now #立即重启</p></blockquote><p><strong>服务器不能关机，只能重启</strong></p><h2 id="其他关机命令">其他关机命令</h2><p>halt</p><p>poweroff #不要随便用</p><p>init 0</p><h2 id="其他重启命令">其他重启命令</h2><p>reboot</p><p>init 6</p><h2 id="系统运行级别">系统运行级别</h2><p>0:关机</p><p>1:单用户，启动最核心服务，用于修复，相当于windows安全模式</p><p>2:不完全多用户，不含NFS服务（文件传输系统，方便但不安全），也不包含网络服务</p><p>3:完全多用户，完全命令行模式，无图形界面</p><p>4:未分配</p><p>5:图形界面</p><p>6:重启</p><blockquote><p>cat /etc/inittab #进程配置文件，修改系统默认运行级别</p><p>runlevel #查询系统运行级别</p></blockquote><h2 id="logout">logout</h2><p>退出登陆</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文本编辑器 vim</title>
      <link href="/posts/36326/"/>
      <url>/posts/36326/</url>
      
        <content type="html"><![CDATA[<p>全屏幕文本编辑去，Linux/UNIX上最常用的文本编辑器，用于建立、编织、显示文本文件。</p><p>Vim 没有菜单，只有命令。</p><img src="https://s2.loli.net/2022/07/12/2yp1jcPqfwaADWK.jpg" alt="IMG_0067" style="zoom: 33%;" /><p>进入编辑模式：在命令模式里输入冒号，命令执行完后自动回到命令模式</p><h2 id="插入命令">插入命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>a</code></td><td>在光标所在字符后插入</td></tr><tr><td><code>i</code></td><td>在光标所在字符前插入</td></tr><tr><td><code>o</code></td><td>在光标下插入新行</td></tr><tr><td><code>A</code></td><td>在光标所在行尾插入</td></tr><tr><td><code>I</code></td><td>在光标所在行行首插入</td></tr><tr><td><code>O</code></td><td>在光标上插入新行</td></tr></tbody></table><h2 id="定位命令">定位命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>:set nu</code></td><td>设置行号</td></tr><tr><td><code>:set nonu</code></td><td>取消行号</td></tr><tr><td><code>gg</code></td><td>到第一行</td></tr><tr><td><code>G</code></td><td>到最后一行</td></tr><tr><td><code>nG</code></td><td>到第n行</td></tr><tr><td><code>:n</code></td><td>到第n行</td></tr></tbody></table><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>$</code></td><td>移至行尾</td></tr><tr><td><code>0</code></td><td>移至行首</td></tr></tbody></table><h2 id="删除命令">删除命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>x</code></td><td>删除光标所在处字符</td></tr><tr><td><code>nx</code></td><td>删除光标所在处后n个字符</td></tr><tr><td><code>dd</code></td><td>删除光标所在行，ndd删除n行</td></tr><tr><td><code>dG</code></td><td>删除光标所在行到文件末尾内容</td></tr><tr><td><code>D</code></td><td>删除光标所在处到行尾内容</td></tr><tr><td><code>:n1,n2d</code></td><td>删除指定范围的行</td></tr></tbody></table><h2 id="复制和剪切命令">复制和剪切命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>yy</code></td><td>复制当前行</td></tr><tr><td><code>nyy</code></td><td>复制当前行以下n行</td></tr><tr><td><code>dd</code></td><td>剪切当前行</td></tr><tr><td><code>ndd</code></td><td>剪切当前行以下n行</td></tr><tr><td><code>p，P</code></td><td>黏贴在当前光标所在行下或行上</td></tr></tbody></table><h2 id="替换和取消命令">替换和取消命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>r</code></td><td>取代光标所在处字符</td></tr><tr><td><code>R</code></td><td>从光标所在处开始替换字符，按Esc结束</td></tr><tr><td><code>u</code></td><td>取消上一步操作</td></tr></tbody></table><h2 id="搜索和搜索替换命令">搜索和搜索替换命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>/string</code></td><td>搜索置顶字符串，忽略大小写：set ic，恢复大小写</td></tr><tr><td><code>n</code></td><td>搜索置顶字符串的下一个出现位置</td></tr><tr><td><code>:%s/old/new/g</code></td><td>全文替换指定字符串</td></tr><tr><td><code>:n1,n2s/old/new/g</code></td><td>在一定范围内替换置顶字符串</td></tr></tbody></table><p>:表示进入编辑模式</p><p>替换模式：</p><ul><li>%s：全文替换</li><li>起始行，终止行s：s表示指定范围</li><li>/string：替换文本</li><li>/target：目标文本</li><li>/g：替换</li><li>/c：替换时询问</li></ul><h2 id="保存和退出命令">保存和退出命令</h2><table><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td><code>:w</code></td><td>保存修改</td></tr><tr><td><code>:w new_filename</code></td><td>另存为指定文件</td></tr><tr><td><code>:wq</code></td><td>保存修改并退出</td></tr><tr><td><code>ZZ</code></td><td>快捷键，保存修改并推出</td></tr><tr><td><code>:q!</code></td><td>不保存修改退出</td></tr><tr><td><code>:wq!</code></td><td>保存修改并退出（文件所有者及root可使用）</td></tr></tbody></table><hr><h2 id="vim-使用技巧">vim 使用技巧</h2><p><code>:r 文件名</code>：将文件导入到光标所在位置</p><p><code>:! 命令</code>：在不退出vim的情况下执行相应的命令</p><p><code>:r !命令</code>：将命令执行的结果导入到光标所在位置</p><p><code>:map ^vp I#&lt;ESC&gt;</code>：^表示control键，^v表示设置快捷键，p表示按control+p触发快捷键，后面跟需要操作，I表示光标移至本行行首并进入插入模式，插入#，<code>&lt;ESC&gt;</code>表示按ESC键退出插入模式。</p><p>即本串代码设置了一个通过用control+p触发的快捷键，将光标所在行注释掉（在行首加#，并回到命令模式）。</p><p><code>:map ^vB 0x</code>：本串代码设置了用control+B的快捷键，用于去掉本行的注释</p><p><code>:map ^vm ikrysachen1204@gmail.com&lt;ESC&gt;</code>：本串代码设置了用control+m触发的插入邮箱的快捷键。</p><p><code>:n1,n2s/^/#/g</code>：连续行注释</p><ul><li>n1,n2s：指定替换范围</li><li>/^：表示行首</li><li>/#：替换为的字符</li><li>/g：替换时不询问</li></ul><p><code>:n1,n2s/^#//g</code>：连续行去掉注释</p><ul><li>/^#：表示行首的#符号</li></ul><p><code>:n1,n2s/^/\/\//g</code>：对于用//作为注释符号的语言，要插入注释时注意将/转义</p><p><code>ab mymail krysachen1204@gmail.com</code>：当输入mymail的时候输入enter或空格会替换为邮箱</p><p>存储快捷键的配置文件位置：家目录下的.vimrc文件中</p><p>mac：～/.vimrc</p><p>Linux：/home/username/.vimrc</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 学习笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R 学习笔记</title>
      <link href="/posts/15547/"/>
      <url>/posts/15547/</url>
      
        <content type="html"><![CDATA[<h2 id="R-数据类型">R 数据类型</h2><h3 id="向量">向量</h3><p>概念类似于Python里的列表，只能存储<strong>相同类型</strong>的数据。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">x <span class="operator">=</span> <span class="number">1</span> <span class="comment"># 创建标量</span></span><br><span class="line"><span class="comment"># 创建向量</span></span><br><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">mode<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;numeric&quot;</span></span><br><span class="line"></span><br><span class="line">z <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">mode<span class="punctuation">(</span>z<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;logical&quot;</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">100</span><span class="punctuation">)</span> <span class="comment"># 1到100的向量</span></span><br><span class="line">seq<span class="punctuation">(</span>from<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> to<span class="operator">=</span><span class="number">20</span><span class="punctuation">,</span> by<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span> <span class="comment"># 创建等差数列，参数可省略。</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">4</span>  <span class="number">7</span> <span class="number">10</span> <span class="number">13</span> <span class="number">16</span> <span class="number">19</span></span><br><span class="line"><span class="operator">?</span>seq <span class="comment"># 获取帮助</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span> <span class="comment"># x的每个元素重复2次</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="built_in">rep</span><span class="punctuation">(</span>x<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 重复指定次数</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 向量运算</span></span><br><span class="line">y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">x<span class="operator">+</span>y</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span></span><br><span class="line">x<span class="operator">**</span><span class="number">2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">4</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><h3 id="向量索引">向量索引</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 输出向量长度</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span> <span class="comment"># R从1开始</span></span><br><span class="line">integer<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">]</span> <span class="comment"># 不输出第10个</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">26</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">73</span><span class="punctuation">]</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">97</span><span class="punctuation">]</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 不输出第10个和第1个</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">73</span><span class="punctuation">]</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">97</span><span class="punctuation">]</span>  <span class="number">99</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 批量索引</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line">x<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 选择索引</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">5</span> <span class="number">10</span></span><br><span class="line">x<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 可以重复索引</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">5</span> <span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">Error <span class="keyword">in</span> x<span class="punctuation">[</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">:</span> 量度数目不对 <span class="comment"># 矛盾</span></span><br><span class="line"></span><br><span class="line">x<span class="punctuation">[</span>x<span class="operator">&gt;</span><span class="number">3</span><span class="punctuation">]</span> <span class="comment"># 简单的if语句</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span>  <span class="number">13</span>  <span class="number">14</span>  <span class="number">15</span>  <span class="number">16</span>  <span class="number">17</span>  <span class="number">18</span>  <span class="number">19</span>  <span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span>  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span>  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">73</span><span class="punctuation">]</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">97</span><span class="punctuation">]</span> <span class="number">100</span></span><br><span class="line">x<span class="punctuation">[</span>x<span class="operator">&gt;</span><span class="number">5</span> <span class="operator">&amp;</span> x<span class="operator">&lt;</span><span class="number">8</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line">y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 逻辑语句</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">integer<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 两个一循环</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">F</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span> <span class="number">10</span></span><br><span class="line">y<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="comment"># 不足以NA代替</span></span><br><span class="line"></span><br><span class="line">z <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;a&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;b&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;c&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;d&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;e&#x27;</span><span class="punctuation">)</span></span><br><span class="line">z</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span> <span class="string">&quot;e&quot;</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>z<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;two&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;four&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;five&#x27;</span><span class="punctuation">)</span> <span class="comment"># 给z的元素添加名字</span></span><br><span class="line">z</span><br><span class="line">  one   two three  four  five </span><br><span class="line">  <span class="string">&quot;a&quot;</span>   <span class="string">&quot;b&quot;</span>   <span class="string">&quot;c&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span> </span><br><span class="line">z<span class="punctuation">[</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">]</span> <span class="comment"># 索引</span></span><br><span class="line">one </span><br><span class="line"><span class="string">&quot;a&quot;</span> </span><br><span class="line">z<span class="punctuation">[</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;b&#x27;</span> <span class="comment"># 赋值</span></span><br><span class="line">z</span><br><span class="line">  one   two three  four  five </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;b&quot;</span>   <span class="string">&quot;c&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span> </span><br><span class="line">z<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;x&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;y&#x27;</span><span class="punctuation">)</span> <span class="comment"># 批量赋值</span></span><br><span class="line">z</span><br><span class="line">  one   two three  four  five </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span> </span><br><span class="line">z<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;x&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;y&#x27;</span><span class="punctuation">)</span></span><br><span class="line">z</span><br><span class="line">  one   two three  four  five             </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> </span><br><span class="line"><span class="string">&#x27;b&#x27;</span> <span class="operator">%in%</span> z <span class="comment"># 判断</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line">z<span class="punctuation">[</span>z <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;a&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;b&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;d&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;e&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"> one four five </span><br><span class="line"> <span class="string">&quot;b&quot;</span> <span class="string">&quot;d&quot;</span>  <span class="string">&quot;e&quot;</span> </span><br><span class="line">append<span class="punctuation">(</span>x <span class="operator">=</span> z<span class="punctuation">,</span> values <span class="operator">=</span> <span class="string">&#x27;zzz&#x27;</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span> <span class="comment"># 插入元素</span></span><br><span class="line">        one   two three  four  five             </span><br><span class="line"><span class="string">&quot;zzz&quot;</span>   <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> </span><br><span class="line">append<span class="punctuation">(</span>x <span class="operator">=</span> z<span class="punctuation">,</span> values <span class="operator">=</span> <span class="string">&#x27;zzz&#x27;</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">  one         two three  four  five             </span><br><span class="line">  <span class="string">&quot;b&quot;</span> <span class="string">&quot;zzz&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> </span><br><span class="line">append<span class="punctuation">(</span>x <span class="operator">=</span> z<span class="punctuation">,</span> values <span class="operator">=</span> <span class="string">&#x27;zzz&#x27;</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">  one   two       three  four  five             </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span> <span class="string">&quot;zzz&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> </span><br><span class="line">append<span class="punctuation">(</span>x <span class="operator">=</span> z<span class="punctuation">,</span> values <span class="operator">=</span> <span class="string">&#x27;zzz&#x27;</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">  one   two three  four  five                   </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span> <span class="string">&quot;zzz&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> </span><br><span class="line">append<span class="punctuation">(</span>x <span class="operator">=</span> z<span class="punctuation">,</span> values <span class="operator">=</span> <span class="string">&#x27;zzz&#x27;</span><span class="punctuation">,</span> after <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">  one   two three  four  five                   </span><br><span class="line">  <span class="string">&quot;b&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span>   <span class="string">&quot;d&quot;</span>   <span class="string">&quot;e&quot;</span>   <span class="string">&quot;x&quot;</span>   <span class="string">&quot;y&quot;</span> <span class="string">&quot;zzz&quot;</span> </span><br><span class="line">rm<span class="punctuation">(</span>z<span class="punctuation">)</span> <span class="comment"># 删除向量</span></span><br><span class="line">z</span><br><span class="line">错误<span class="operator">:</span> 找不到对象<span class="string">&#x27;z&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除向量中的元素（不常用）</span></span><br><span class="line">y</span><br><span class="line">                                      <span class="number">5</span> </span><br><span class="line"><span class="string">&quot;1&quot;</span> <span class="string">&quot;2&quot;</span> <span class="string">&quot;3&quot;</span> <span class="string">&quot;4&quot;</span> <span class="string">&quot;5&quot;</span> <span class="string">&quot;6&quot;</span> <span class="string">&quot;7&quot;</span> <span class="string">&quot;8&quot;</span> <span class="string">&quot;9&quot;</span> <span class="string">&quot;e&quot;</span> </span><br><span class="line">y<span class="punctuation">[</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">                                    </span><br><span class="line"><span class="string">&quot;1&quot;</span> <span class="string">&quot;2&quot;</span> <span class="string">&quot;3&quot;</span> <span class="string">&quot;4&quot;</span> <span class="string">&quot;5&quot;</span> <span class="string">&quot;6&quot;</span> <span class="string">&quot;7&quot;</span> <span class="string">&quot;8&quot;</span> <span class="string">&quot;9&quot;</span> </span><br><span class="line">y <span class="operator">&lt;-</span> y<span class="punctuation">[</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">y</span><br><span class="line">                                    </span><br><span class="line"><span class="string">&quot;1&quot;</span> <span class="string">&quot;2&quot;</span> <span class="string">&quot;3&quot;</span> <span class="string">&quot;4&quot;</span> <span class="string">&quot;5&quot;</span> <span class="string">&quot;6&quot;</span> <span class="string">&quot;7&quot;</span> <span class="string">&quot;8&quot;</span> <span class="string">&quot;9&quot;</span> </span><br><span class="line"></span><br><span class="line">euro</span><br><span class="line">        ATS         BEF         DEM         ESP         FIM         FRF         IEP         ITL </span><br><span class="line">  <span class="number">13.760300</span>   <span class="number">40.339900</span>    <span class="number">1.955830</span>  <span class="number">166.386000</span>    <span class="number">5.945730</span>    <span class="number">6.559570</span>    <span class="number">0.787564</span> <span class="number">1936.270000</span> </span><br><span class="line">        LUF         NLG         PTE </span><br><span class="line">  <span class="number">40.339900</span>    <span class="number">2.203710</span>  <span class="number">200.482000</span> </span><br><span class="line">euro<span class="punctuation">[</span><span class="string">&#x27;PTE&#x27;</span><span class="punctuation">]</span></span><br><span class="line">    PTE </span><br><span class="line"><span class="number">200.482</span> </span><br></pre></td></tr></table></figure><h3 id="矩阵与数组">矩阵与数组</h3><p>矩阵是<strong>二维</strong>的，有行和列，每个元素类型要相同，可以看成向量的扩充。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># R内置数据集</span></span><br><span class="line">head<span class="punctuation">(</span>iris3<span class="punctuation">)</span> <span class="comment"># 三种鸢尾花数据</span></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Setosa</span><br><span class="line"></span><br><span class="line">     Sepal L. Sepal W. Petal L. Petal W.</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.1</span>      <span class="number">3.5</span>      <span class="number">1.4</span>      <span class="number">0.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">4.9</span>      <span class="number">3.0</span>      <span class="number">1.4</span>      <span class="number">0.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">4.7</span>      <span class="number">3.2</span>      <span class="number">1.3</span>      <span class="number">0.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">4.6</span>      <span class="number">3.1</span>      <span class="number">1.5</span>      <span class="number">0.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.0</span>      <span class="number">3.6</span>      <span class="number">1.4</span>      <span class="number">0.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.4</span>      <span class="number">3.9</span>      <span class="number">1.7</span>      <span class="number">0.4</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Versicolor</span><br><span class="line"></span><br><span class="line">     Sepal L. Sepal W. Petal L. Petal W.</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">7.0</span>      <span class="number">3.2</span>      <span class="number">4.7</span>      <span class="number">1.4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.4</span>      <span class="number">3.2</span>      <span class="number">4.5</span>      <span class="number">1.5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.9</span>      <span class="number">3.1</span>      <span class="number">4.9</span>      <span class="number">1.5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.5</span>      <span class="number">2.3</span>      <span class="number">4.0</span>      <span class="number">1.3</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.5</span>      <span class="number">2.8</span>      <span class="number">4.6</span>      <span class="number">1.5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.7</span>      <span class="number">2.8</span>      <span class="number">4.5</span>      <span class="number">1.3</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> Virginica</span><br><span class="line"></span><br><span class="line">     Sepal L. Sepal W. Petal L. Petal W.</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.3</span>      <span class="number">3.3</span>      <span class="number">6.0</span>      <span class="number">2.5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">5.8</span>      <span class="number">2.7</span>      <span class="number">5.1</span>      <span class="number">1.9</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">7.1</span>      <span class="number">3.0</span>      <span class="number">5.9</span>      <span class="number">2.1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.3</span>      <span class="number">2.9</span>      <span class="number">5.6</span>      <span class="number">1.8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">6.5</span>      <span class="number">3.0</span>      <span class="number">5.8</span>      <span class="number">2.2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">,</span><span class="punctuation">]</span>      <span class="number">7.6</span>      <span class="number">3.0</span>      <span class="number">6.6</span>      <span class="number">2.1</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>state.x77<span class="punctuation">)</span> <span class="comment"># 美国50个州8个指标</span></span><br><span class="line">           Population Income Illiteracy Life Exp Murder HS Grad Frost   Area</span><br><span class="line">Alabama          <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska            <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona          <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">Arkansas         <span class="number">2110</span>   <span class="number">3378</span>        <span class="number">1.9</span>    <span class="number">70.66</span>   <span class="number">10.1</span>    <span class="number">39.9</span>    <span class="number">65</span>  <span class="number">51945</span></span><br><span class="line">California      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line">Colorado         <span class="number">2541</span>   <span class="number">4884</span>        <span class="number">0.7</span>    <span class="number">72.06</span>    <span class="number">6.8</span>    <span class="number">63.9</span>   <span class="number">166</span> <span class="number">103766</span></span><br><span class="line"></span><br><span class="line">heatmap<span class="punctuation">(</span>state.x77<span class="punctuation">)</span> <span class="comment"># 矩阵可直接绘制热图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建矩阵</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 按行分配</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>   <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">16</span>   <span class="number">17</span>   <span class="number">18</span>   <span class="number">19</span>   <span class="number">20</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 行列数必须是数据个数的因数</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="operator">:</span> 数据长度<span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>不是矩阵列数<span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span>的整倍数</span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="operator">:</span> 数据长度<span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>不是矩阵行数<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span>的整倍</span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 多时按顺序分配</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">9</span>   <span class="number">10</span>   <span class="number">11</span>   <span class="number">12</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span>   <span class="number">16</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">,</span> byrow <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 少时重复分配</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>    <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span>   <span class="number">16</span>   <span class="number">17</span>   <span class="number">18</span>   <span class="number">19</span>    <span class="number">20</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>    <span class="number">10</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">15</span>   <span class="number">16</span>   <span class="number">17</span>   <span class="number">18</span>   <span class="number">19</span>    <span class="number">20</span></span><br><span class="line"></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">3</span>    <span class="number">5</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">4</span>    <span class="number">6</span>    <span class="number">8</span></span><br><span class="line">cnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;C1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;C2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;C3&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;C4&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rnames <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;R1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;R2&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dimnames</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>rnames<span class="punctuation">,</span>cnames<span class="punctuation">)</span> <span class="comment"># 命名行列</span></span><br><span class="line">m</span><br><span class="line">   C1 C2 C3 C4</span><br><span class="line">R1  <span class="number">1</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">7</span></span><br><span class="line">R2  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="comment"># 显示对象的维数</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">)</span> <span class="comment"># 改变行列数</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">9</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span> <span class="comment"># 生成矩阵</span></span><br><span class="line">x</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br></pre></td></tr></table></figure><p>矩阵索引</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">x</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">4</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="comment"># 第1行</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">4</span> <span class="number">7</span></span><br><span class="line">x<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="comment"># 第1列</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 索引多个</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">4</span> <span class="number">7</span></span><br><span class="line">x<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># 索引子集</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="comment"># 不加逗号显示行第一个</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="comment">#负号表示不显示</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br><span class="line">x<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line">x<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">           Population Income Illiteracy Life Exp Murder HS Grad Frost   Area</span><br><span class="line">Alabama          <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska            <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona          <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">Arkansas         <span class="number">2110</span>   <span class="number">3378</span>        <span class="number">1.9</span>    <span class="number">70.66</span>   <span class="number">10.1</span>    <span class="number">39.9</span>    <span class="number">65</span>  <span class="number">51945</span></span><br><span class="line">California      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line">Colorado         <span class="number">2541</span>   <span class="number">4884</span>        <span class="number">0.7</span>    <span class="number">72.06</span>    <span class="number">6.8</span>    <span class="number">63.9</span>   <span class="number">166</span> <span class="number">103766</span></span><br><span class="line">state.x77<span class="punctuation">[</span><span class="string">&#x27;California&#x27;</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="comment"># 通过dimname索引</span></span><br><span class="line">Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost       Area </span><br><span class="line">  <span class="number">21198.00</span>    <span class="number">5114.00</span>       <span class="number">1.10</span>      <span class="number">71.71</span>      <span class="number">10.30</span>      <span class="number">62.60</span>      <span class="number">20.00</span>  <span class="number">156361.00</span> </span><br></pre></td></tr></table></figure><p>矩阵运算与线性代数中一致。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">m</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line">n</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span>   <span class="number">21</span></span><br><span class="line">m<span class="operator">+</span>n</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>   <span class="number">11</span>   <span class="number">19</span>   <span class="number">27</span>   <span class="number">35</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">5</span>   <span class="number">13</span>   <span class="number">21</span>   <span class="number">29</span>   <span class="number">37</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">7</span>   <span class="number">15</span>   <span class="number">23</span>   <span class="number">31</span>   <span class="number">39</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">9</span>   <span class="number">17</span>   <span class="number">25</span>   <span class="number">33</span>   <span class="number">41</span></span><br><span class="line">m<span class="operator">*</span>n <span class="comment"># 内积，对应元素想乘</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>   <span class="number">30</span>   <span class="number">90</span>  <span class="number">182</span>  <span class="number">306</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">6</span>   <span class="number">42</span>  <span class="number">110</span>  <span class="number">210</span>  <span class="number">342</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">12</span>   <span class="number">56</span>  <span class="number">132</span>  <span class="number">240</span>  <span class="number">380</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="number">20</span>   <span class="number">72</span>  <span class="number">156</span>  <span class="number">272</span>  <span class="number">420</span></span><br><span class="line">m <span class="operator">%*%</span> t<span class="punctuation">(</span>n<span class="punctuation">)</span> <span class="comment"># 外积，即线代中的A×B</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">610</span>  <span class="number">655</span>  <span class="number">700</span>  <span class="number">745</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">660</span>  <span class="number">710</span>  <span class="number">760</span>  <span class="number">810</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">710</span>  <span class="number">765</span>  <span class="number">820</span>  <span class="number">875</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">760</span>  <span class="number">820</span>  <span class="number">880</span>  <span class="number">940</span></span><br><span class="line"></span><br><span class="line">rowSums<span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="comment"># 行和</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">45</span> <span class="number">50</span> <span class="number">55</span> <span class="number">60</span></span><br><span class="line">colSums<span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="comment"># 列和</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">10</span> <span class="number">26</span> <span class="number">42</span> <span class="number">58</span> <span class="number">74</span></span><br><span class="line">rowMeans<span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="comment"># 行平均值</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span></span><br><span class="line">colMeans<span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="comment"># 列平均值</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">2.5</span>  <span class="number">6.5</span> <span class="number">10.5</span> <span class="number">14.5</span> <span class="number">18.5</span></span><br><span class="line"></span><br><span class="line">n</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></span><br><span class="line">diag<span class="punctuation">(</span>n<span class="punctuation">)</span> <span class="comment"># 方阵对角线的值</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">5</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><p>数组即多维矩阵。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dim1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A5&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dim2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;B1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;B2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dim3 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;C1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;C2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">x <span class="operator">&lt;-</span> array<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">dimnames</span> <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>dim1<span class="punctuation">,</span>dim2<span class="punctuation">,</span>dim3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># array创建数组</span></span><br><span class="line">x</span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C1</span><br><span class="line"></span><br><span class="line">   B1 B2</span><br><span class="line">A1  <span class="number">1</span>  <span class="number">6</span></span><br><span class="line">A2  <span class="number">2</span>  <span class="number">7</span></span><br><span class="line">A3  <span class="number">3</span>  <span class="number">8</span></span><br><span class="line">A4  <span class="number">4</span>  <span class="number">9</span></span><br><span class="line">A5  <span class="number">5</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">,</span> <span class="punctuation">,</span> C2</span><br><span class="line"></span><br><span class="line">   B1 B2</span><br><span class="line">A1 <span class="number">11</span> <span class="number">16</span></span><br><span class="line">A2 <span class="number">12</span> <span class="number">17</span></span><br><span class="line">A3 <span class="number">13</span> <span class="number">18</span></span><br><span class="line">A4 <span class="number">14</span> <span class="number">19</span></span><br><span class="line">A5 <span class="number">15</span> <span class="number">20</span></span><br></pre></td></tr></table></figure><h3 id="列表">列表</h3><p>R中最复杂的数据结构，可以用来存储不同的数据，例如向量、矩阵、数据框、列表等。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">a <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">20</span></span><br><span class="line">b <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;a&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;b&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;d&#x27;</span><span class="punctuation">)</span></span><br><span class="line">mode<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;list&quot;</span></span><br><span class="line"><span class="built_in">c</span> <span class="operator">&lt;-</span> mtcars</span><br><span class="line">d <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">mlist <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">,</span>d<span class="punctuation">)</span> <span class="comment"># 创建列表</span></span><br><span class="line">mlist</span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"></span><br><span class="line">mlist <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>first<span class="operator">=</span>a<span class="punctuation">,</span>second<span class="operator">=</span>b<span class="punctuation">,</span>third<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">,</span>fourth<span class="operator">=</span>d<span class="punctuation">)</span></span><br><span class="line">mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>third</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>fourth</span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span>   <span class="number">17</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span>   <span class="number">18</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span>   <span class="number">19</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span>   <span class="number">20</span></span><br><span class="line"></span><br><span class="line">mlist <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&#x27;first&#x27;</span><span class="operator">=</span>a<span class="punctuation">)</span></span><br><span class="line">mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>列表索引</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mlist<span class="punctuation">[</span><span class="string">&#x27;second&#x27;</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"></span><br><span class="line">mlist<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="comment"># 一个[]输出列表的子集</span></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;list&quot;</span></span><br><span class="line"></span><br><span class="line">mlist<span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="comment"># 两个[]输出数元素本身的数据类型</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;character&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="operator">$</span>third<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mlist<span class="operator">$</span>fourth<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;matrix&quot;</span> <span class="string">&quot;array&quot;</span> </span><br><span class="line"></span><br><span class="line">mlist<span class="punctuation">[</span><span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> iris <span class="comment"># 要用两个[]</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In mlist<span class="punctuation">[</span><span class="number">5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> iris <span class="operator">:</span></span><br><span class="line">  number of items to replace is not a multiple of replacement <span class="built_in">length</span></span><br><span class="line">mlist<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> iris</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除元素</span></span><br><span class="line">mlist <span class="operator">&lt;-</span> mlist<span class="punctuation">[</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line">mlist<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">mlist</span><br><span class="line"><span class="operator">$</span>first</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>second</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>third</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="数据框">数据框</h3><p>类似于表格，每一列长度和数据类型必须相同，且必须命名，每行可不相同。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br><span class="line">iris</span><br><span class="line">    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span><br><span class="line"><span class="number">1</span>            <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">2</span>            <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">3</span>            <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa</span><br><span class="line">...</span><br><span class="line">mtcars</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据框</span></span><br><span class="line">state <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>state.name<span class="punctuation">,</span>state.abb<span class="punctuation">,</span>state.x77<span class="punctuation">)</span></span><br><span class="line">state</span><br><span class="line">                   state.name state.abb Population Income Illiteracy Life.Exp Murder HS.Grad Frost</span><br><span class="line">Alabama               Alabama        AL       <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span></span><br><span class="line">Alaska                 Alaska        AK        <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span></span><br><span class="line">Arizona               Arizona        AZ       <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span></span><br><span class="line">...</span><br><span class="line">rownames<span class="punctuation">(</span>state<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Alabama&quot;</span>        <span class="string">&quot;Alaska&quot;</span>         <span class="string">&quot;Arizona&quot;</span>        <span class="string">&quot;Arkansas&quot;</span>       <span class="string">&quot;California&quot;</span>    </span><br><span class="line"> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span> <span class="string">&quot;Colorado&quot;</span>       <span class="string">&quot;Connecticut&quot;</span>    <span class="string">&quot;Delaware&quot;</span>       <span class="string">&quot;Florida&quot;</span>        <span class="string">&quot;Georgia&quot;</span>       </span><br><span class="line"><span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="string">&quot;Hawaii&quot;</span>         <span class="string">&quot;Idaho&quot;</span>          <span class="string">&quot;Illinois&quot;</span>       <span class="string">&quot;Indiana&quot;</span>        <span class="string">&quot;Iowa&quot;</span>          </span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="string">&quot;Kansas&quot;</span>         <span class="string">&quot;Kentucky&quot;</span>       <span class="string">&quot;Louisiana&quot;</span>      <span class="string">&quot;Maine&quot;</span>          <span class="string">&quot;Maryland&quot;</span>      </span><br><span class="line"><span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> <span class="string">&quot;Massachusetts&quot;</span>  <span class="string">&quot;Michigan&quot;</span>       <span class="string">&quot;Minnesota&quot;</span>      <span class="string">&quot;Mississippi&quot;</span>    <span class="string">&quot;Missouri&quot;</span>      </span><br><span class="line"><span class="punctuation">[</span><span class="number">26</span><span class="punctuation">]</span> <span class="string">&quot;Montana&quot;</span>        <span class="string">&quot;Nebraska&quot;</span>       <span class="string">&quot;Nevada&quot;</span>         <span class="string">&quot;New Hampshire&quot;</span>  <span class="string">&quot;New Jersey&quot;</span>    </span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="string">&quot;New Mexico&quot;</span>     <span class="string">&quot;New York&quot;</span>       <span class="string">&quot;North Carolina&quot;</span> <span class="string">&quot;North Dakota&quot;</span>   <span class="string">&quot;Ohio&quot;</span>          </span><br><span class="line"><span class="punctuation">[</span><span class="number">36</span><span class="punctuation">]</span> <span class="string">&quot;Oklahoma&quot;</span>       <span class="string">&quot;Oregon&quot;</span>         <span class="string">&quot;Pennsylvania&quot;</span>   <span class="string">&quot;Rhode Island&quot;</span>   <span class="string">&quot;South Carolina&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span> <span class="string">&quot;South Dakota&quot;</span>   <span class="string">&quot;Tennessee&quot;</span>      <span class="string">&quot;Texas&quot;</span>          <span class="string">&quot;Utah&quot;</span>           <span class="string">&quot;Vermont&quot;</span>       </span><br><span class="line"><span class="punctuation">[</span><span class="number">46</span><span class="punctuation">]</span> <span class="string">&quot;Virginia&quot;</span>       <span class="string">&quot;Washington&quot;</span>     <span class="string">&quot;West Virginia&quot;</span>  <span class="string">&quot;Wisconsin&quot;</span>      <span class="string">&quot;Wyoming&quot;</span>       </span><br><span class="line">colnames<span class="punctuation">(</span>state<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;state.name&quot;</span> <span class="string">&quot;state.abb&quot;</span>  <span class="string">&quot;Population&quot;</span> <span class="string">&quot;Income&quot;</span>     <span class="string">&quot;Illiteracy&quot;</span> <span class="string">&quot;Life.Exp&quot;</span>   <span class="string">&quot;Murder&quot;</span>    </span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="string">&quot;HS.Grad&quot;</span>    <span class="string">&quot;Frost&quot;</span>      <span class="string">&quot;Area&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 索引</span></span><br><span class="line">state<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">                   state.name</span><br><span class="line">Alabama               Alabama</span><br><span class="line">Alaska                 Alaska</span><br><span class="line">Arizona               Arizona</span><br><span class="line">...</span><br><span class="line">state<span class="punctuation">[</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span></span><br><span class="line">               state.abb</span><br><span class="line">Alabama               AL</span><br><span class="line">Alaska                AK</span><br><span class="line">Arizona               AZ</span><br><span class="line">...</span><br><span class="line">state<span class="operator">$</span>Murder</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">15.1</span> <span class="number">11.3</span>  <span class="number">7.8</span> <span class="number">10.1</span> <span class="number">10.3</span>  <span class="number">6.8</span>  <span class="number">3.1</span>  <span class="number">6.2</span> <span class="number">10.7</span> <span class="number">13.9</span>  <span class="number">6.2</span>  <span class="number">5.3</span> <span class="number">10.3</span>  <span class="number">7.1</span>  <span class="number">2.3</span>  <span class="number">4.5</span> <span class="number">10.6</span> <span class="number">13.2</span>  <span class="number">2.7</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>  <span class="number">8.5</span>  <span class="number">3.3</span> <span class="number">11.1</span>  <span class="number">2.3</span> <span class="number">12.5</span>  <span class="number">9.3</span>  <span class="number">5.0</span>  <span class="number">2.9</span> <span class="number">11.5</span>  <span class="number">3.3</span>  <span class="number">5.2</span>  <span class="number">9.7</span> <span class="number">10.9</span> <span class="number">11.1</span>  <span class="number">1.4</span>  <span class="number">7.4</span>  <span class="number">6.4</span>  <span class="number">4.2</span>  <span class="number">6.1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">2.4</span> <span class="number">11.6</span>  <span class="number">1.7</span> <span class="number">11.0</span> <span class="number">12.2</span>  <span class="number">4.5</span>  <span class="number">5.5</span>  <span class="number">9.5</span>  <span class="number">4.3</span>  <span class="number">6.7</span>  <span class="number">3.0</span>  <span class="number">6.9</span></span><br><span class="line">state<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;FL&quot;</span> <span class="string">&quot;GA&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;IN&quot;</span> <span class="string">&quot;IA&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;ME&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="string">&quot;MD&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;MS&quot;</span> <span class="string">&quot;MO&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NH&quot;</span> <span class="string">&quot;NJ&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;ND&quot;</span> <span class="string">&quot;OH&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;PA&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span> <span class="string">&quot;RI&quot;</span> <span class="string">&quot;SC&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;UT&quot;</span> <span class="string">&quot;VT&quot;</span> <span class="string">&quot;VA&quot;</span> <span class="string">&quot;WA&quot;</span> <span class="string">&quot;WV&quot;</span> <span class="string">&quot;WI&quot;</span> <span class="string">&quot;WY&quot;</span></span><br><span class="line">state<span class="punctuation">[</span><span class="string">&#x27;California&#x27;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">           state.name state.abb Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">California California        CA      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line"></span><br><span class="line">women</span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>state<span class="punctuation">[</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="comment"># 单括号仍为数据框</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>state<span class="punctuation">[[</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="comment"># 双括号为数据本身</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;character&quot;</span></span><br><span class="line">state<span class="punctuation">[[</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;FL&quot;</span> <span class="string">&quot;GA&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;IN&quot;</span> <span class="string">&quot;IA&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;ME&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="string">&quot;MD&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;MS&quot;</span> <span class="string">&quot;MO&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NH&quot;</span> <span class="string">&quot;NJ&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;ND&quot;</span> <span class="string">&quot;OH&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;PA&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span> <span class="string">&quot;RI&quot;</span> <span class="string">&quot;SC&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;UT&quot;</span> <span class="string">&quot;VT&quot;</span> <span class="string">&quot;VA&quot;</span> <span class="string">&quot;WA&quot;</span> <span class="string">&quot;WV&quot;</span> <span class="string">&quot;WI&quot;</span> <span class="string">&quot;WY&quot;</span></span><br><span class="line">state<span class="punctuation">[</span><span class="string">&#x27;state.abb&#x27;</span><span class="punctuation">]</span></span><br><span class="line">               state.abb</span><br><span class="line">Alabama               AL</span><br><span class="line">Alaska                AK</span><br><span class="line">Arizona               AZ</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="因子">因子</h3><p>因子是R中重要的概念。</p><p>R中变量类型</p><ol><li>名义型变量：没有顺序分别，相互独立，如省份名。</li><li>有序型变量：介于二者之间，不同值之间有顺序关系，但不是连续的数量变化，如good、better、best。</li><li>连续型变量：某个范围中的任意值，如存储年龄、身高、GDP的变量。</li></ol><p>一般，字符型数据多为名义型变量，数值型数据多为连续型变量。</p><p>名义型变量和有序型变量在R中称为因子，这些变量的可能值称为一个水平level，如good，better，best都称为一个level。</p><p><strong>因子的最大作用是用来分类，计算频数和频率。</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内置数据集</span></span><br><span class="line">state.region</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> South         West          West          South         West          West         </span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> Northeast     South         South         South         West          West         </span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span> North Central North Central North Central North Central South         South        </span><br><span class="line">...         </span><br><span class="line">Levels<span class="operator">:</span> Northeast South North Central West</span><br><span class="line"></span><br><span class="line">state.division</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> East South Central Pacific            Mountain           West South Central</span><br><span class="line"> <span class="punctuation">[</span><span class="number">5</span><span class="punctuation">]</span> Pacific            Mountain           New England        South Atlantic    </span><br><span class="line"> <span class="punctuation">[</span><span class="number">9</span><span class="punctuation">]</span> South Atlantic     South Atlantic     Pacific            Mountain          </span><br><span class="line">...        </span><br><span class="line"><span class="number">9</span> Levels<span class="operator">:</span> New England Middle Atlantic South Atlantic ... Pacific</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义因子</span></span><br><span class="line">f <span class="operator">&lt;-</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">f</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">mtcars<span class="operator">$</span>cyl</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line">factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以设置顺序</span></span><br><span class="line">factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;two&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> ordered <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;two&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;four&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> one   one   two   three three</span><br><span class="line">Levels<span class="operator">:</span> one <span class="operator">&lt;</span> two <span class="operator">&lt;</span> three <span class="operator">&lt;</span> four</span><br><span class="line">factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;five&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;five&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;two&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> ordered <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;one&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;two&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;three&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;four&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;</span><span class="literal">NA</span> <span class="operator">&lt;</span><span class="literal">NA</span> two   three three <span class="comment"># 因子不能含有没有的level</span></span><br><span class="line">Levels<span class="operator">:</span> one <span class="operator">&lt;</span> two <span class="operator">&lt;</span> three <span class="operator">&lt;</span> four</span><br><span class="line"></span><br><span class="line">plot<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span> <span class="comment"># 散点图</span></span><br><span class="line">plot<span class="punctuation">(</span>factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 因子做出条形图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cut函数可将向量按要求分隔为因子</span></span><br><span class="line">n <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">20</span></span><br><span class="line">cut<span class="punctuation">(</span>n<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>   <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>  <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">12</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span></span><br><span class="line">Levels<span class="operator">:</span> <span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">]</span> <span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line">mtcars<span class="operator">$</span>wt</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2.620</span> <span class="number">2.875</span> <span class="number">2.320</span> <span class="number">3.215</span> <span class="number">3.440</span> <span class="number">3.460</span> <span class="number">3.570</span> <span class="number">3.190</span> <span class="number">3.150</span> <span class="number">3.440</span> <span class="number">3.440</span> <span class="number">4.070</span> <span class="number">3.730</span> <span class="number">3.780</span> <span class="number">5.250</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="number">5.424</span> <span class="number">5.345</span> <span class="number">2.200</span> <span class="number">1.615</span> <span class="number">1.835</span> <span class="number">2.465</span> <span class="number">3.520</span> <span class="number">3.435</span> <span class="number">3.840</span> <span class="number">3.845</span> <span class="number">1.935</span> <span class="number">2.140</span> <span class="number">1.513</span> <span class="number">3.170</span> <span class="number">2.770</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="number">3.570</span> <span class="number">2.780</span></span><br><span class="line"><span class="built_in">range</span><span class="punctuation">(</span>mtcars<span class="operator">$</span>wt<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.513</span> <span class="number">5.424</span></span><br><span class="line">plot<span class="punctuation">(</span>cut<span class="punctuation">(</span>mtcars<span class="operator">$</span>wt<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 直接画出频数条形图</span></span><br></pre></td></tr></table></figure><h3 id="缺失数据">缺失数据</h3><p>NA（not available）代表缺失值，用来存储缺失数据，表示没有。注意没有不是0，可能是任何值。</p><p>NaN代表不可能值，不存在。</p><p>Inf表示无穷大，-Inf为无穷小。</p><p>在R中有相关包和函数可以处理缺失值，如VIM包。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NaN</span></span><br><span class="line"><span class="literal">NA</span><span class="operator">+</span><span class="number">1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line"><span class="number">0</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NaN</span></span><br><span class="line"><span class="number">1</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">Inf</span></span><br><span class="line"><span class="operator">-</span><span class="number">1</span><span class="operator">/</span><span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="literal">Inf</span></span><br><span class="line"></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="literal">NaN</span><span class="punctuation">,</span> <span class="literal">Inf</span><span class="punctuation">,</span> <span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">is.na</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="built_in">is.infinite</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="built_in">is.nan</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line">a</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="built_in">sum</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line">mean<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line"><span class="built_in">sum</span><span class="punctuation">(</span>a<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># na.rm = T，计算时跳过缺失值</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">55</span></span><br><span class="line">mean<span class="punctuation">(</span>a<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5.5</span></span><br><span class="line"></span><br><span class="line">a</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span> <span class="literal">NA</span> <span class="literal">NA</span></span><br><span class="line">b <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span>a<span class="punctuation">)</span> <span class="comment"># 去除缺失数据</span></span><br><span class="line">b</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;na.action&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">6</span> <span class="number">7</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;class&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;omit&quot;</span></span><br><span class="line"><span class="built_in">is.na</span><span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="built_in">sum</span><span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">a</span><br><span class="line">       state.name state.area</span><br><span class="line"><span class="number">1</span>            <span class="operator">&lt;</span><span class="literal">NA</span>     <span class="number">51609</span></span><br><span class="line"><span class="number">2</span>            <span class="operator">&lt;</span><span class="literal">NA</span>    <span class="number">589757</span></span><br><span class="line"><span class="number">3</span>         Arizona     <span class="number">113909</span></span><br><span class="line"><span class="number">4</span>        Arkansas      <span class="number">53104</span></span><br><span class="line"><span class="number">5</span>      California     <span class="number">158693</span></span><br><span class="line"></span><br><span class="line">na.omit<span class="punctuation">(</span>a<span class="punctuation">)</span> <span class="comment"># 为数据框时删除此行</span></span><br><span class="line">       state.name state.area</span><br><span class="line"><span class="number">3</span>         Arizona     <span class="number">113909</span></span><br><span class="line"><span class="number">4</span>        Arkansas      <span class="number">53104</span></span><br><span class="line"><span class="number">5</span>      California     <span class="number">158693</span></span><br></pre></td></tr></table></figure><h3 id="字符串">字符串</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算字符串长度</span></span><br><span class="line">nchar<span class="punctuation">(</span><span class="string">&#x27;hello&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;hell o&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;world&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;!&#x27;</span><span class="punctuation">)</span> <span class="comment"># 空格也算</span></span><br><span class="line">nchar<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">5</span> <span class="number">1</span></span><br><span class="line"><span class="built_in">month.name</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;January&quot;</span>   <span class="string">&quot;February&quot;</span>  <span class="string">&quot;March&quot;</span>     <span class="string">&quot;April&quot;</span>     <span class="string">&quot;May&quot;</span>       <span class="string">&quot;June&quot;</span>      <span class="string">&quot;July&quot;</span>     </span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="string">&quot;August&quot;</span>    <span class="string">&quot;September&quot;</span> <span class="string">&quot;October&quot;</span>   <span class="string">&quot;November&quot;</span>  <span class="string">&quot;December&quot;</span> </span><br><span class="line">nchar<span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">7</span> <span class="number">8</span> <span class="number">5</span> <span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">9</span> <span class="number">7</span> <span class="number">8</span> <span class="number">8</span></span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span> <span class="comment"># 向量的长度，注意区分二者</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">12</span></span><br><span class="line">nchar<span class="punctuation">(</span><span class="number">12345</span><span class="punctuation">)</span> <span class="comment"># 为数字时当成字符串处理</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span></span><br><span class="line">nchar<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span> <span class="number">133</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串拼接</span></span><br><span class="line">paste<span class="punctuation">(</span><span class="string">&#x27;hello&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;world&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;!&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;hello world !&quot;</span></span><br><span class="line">paste<span class="punctuation">(</span><span class="string">&#x27;hello&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;world&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;!&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span> <span class="comment"># 可选分隔符，默认空格</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;hello-world-!&quot;</span></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Zhao&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Qian&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Sun&#x27;</span><span class="punctuation">)</span> <span class="comment"># 注意向量</span></span><br><span class="line">paste<span class="punctuation">(</span>a<span class="punctuation">,</span> <span class="string">&#x27;Ming&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Zhao Ming&quot;</span> <span class="string">&quot;Qian Ming&quot;</span> <span class="string">&quot;Sun Ming&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串提取</span></span><br><span class="line">substr<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">month.name</span><span class="punctuation">,</span> start <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> stop <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Jan&quot;</span> <span class="string">&quot;Feb&quot;</span> <span class="string">&quot;Mar&quot;</span> <span class="string">&quot;Apr&quot;</span> <span class="string">&quot;May&quot;</span> <span class="string">&quot;Jun&quot;</span> <span class="string">&quot;Jul&quot;</span> <span class="string">&quot;Aug&quot;</span> <span class="string">&quot;Sep&quot;</span> <span class="string">&quot;Oct&quot;</span> <span class="string">&quot;Nov&quot;</span> <span class="string">&quot;Dec&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 大小写转换</span></span><br><span class="line">toupper<span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;JANUARY&quot;</span>   <span class="string">&quot;FEBRUARY&quot;</span>  <span class="string">&quot;MARCH&quot;</span>     <span class="string">&quot;APRIL&quot;</span>     <span class="string">&quot;MAY&quot;</span>       <span class="string">&quot;JUNE&quot;</span>      <span class="string">&quot;JULY&quot;</span>     </span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="string">&quot;AUGUST&quot;</span>    <span class="string">&quot;SEPTEMBER&quot;</span> <span class="string">&quot;OCTOBER&quot;</span>   <span class="string">&quot;NOVEMBER&quot;</span>  <span class="string">&quot;DECEMBER&quot;</span> </span><br><span class="line">tolower<span class="punctuation">(</span><span class="built_in">month.name</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;january&quot;</span>   <span class="string">&quot;february&quot;</span>  <span class="string">&quot;march&quot;</span>     <span class="string">&quot;april&quot;</span>     <span class="string">&quot;may&quot;</span>       <span class="string">&quot;june&quot;</span>      <span class="string">&quot;july&quot;</span>     </span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="string">&quot;august&quot;</span>    <span class="string">&quot;september&quot;</span> <span class="string">&quot;october&quot;</span>   <span class="string">&quot;november&quot;</span>  <span class="string">&quot;december&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 局部大小写转换-正则表达式</span></span><br><span class="line"><span class="comment"># 待学</span></span><br><span class="line">gsub<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串匹配</span></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Zhao&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Qian&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Sun&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Li&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;Sun&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;a&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;ao&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;au&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line">integer<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A+&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;AC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;A+&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">,</span> fixed <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">grep<span class="punctuation">(</span><span class="string">&#x27;A+&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">,</span> fixed <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 含有fixed参数表示支持正则表达式，+表示任何字符</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">match<span class="punctuation">(</span><span class="string">&#x27;A&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span> <span class="comment"># match不支持正则表达式</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">NA</span></span><br><span class="line">match<span class="punctuation">(</span><span class="string">&#x27;A+&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line">match<span class="punctuation">(</span><span class="string">&#x27;AC&#x27;</span><span class="punctuation">,</span> a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串分隔</span></span><br><span class="line">strsplit<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;hello my dear.&#x27;</span><span class="punctuation">,</span> split <span class="operator">=</span> <span class="string">&#x27; &#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;hello&quot;</span> <span class="string">&quot;my&quot;</span>    <span class="string">&quot;dear.&quot;</span></span><br><span class="line"></span><br><span class="line">a <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;oh my god!&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hello my dear.&#x27;</span><span class="punctuation">)</span></span><br><span class="line">strsplit<span class="punctuation">(</span>a<span class="punctuation">,</span> <span class="string">&#x27; &#x27;</span><span class="punctuation">)</span> <span class="comment"># 可分隔向量，返回list</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;oh&quot;</span>   <span class="string">&quot;my&quot;</span>   <span class="string">&quot;god!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;hello&quot;</span> <span class="string">&quot;my&quot;</span>    <span class="string">&quot;dear.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成扑克牌</span></span><br><span class="line">a</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span></span><br><span class="line">b</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;heitao&quot;</span>   <span class="string">&quot;fangpian&quot;</span> <span class="string">&quot;hongtao&quot;</span>  <span class="string">&quot;meihua&quot;</span>  </span><br><span class="line">outer<span class="punctuation">(</span>b<span class="punctuation">,</span> a<span class="punctuation">,</span> FUN <span class="operator">=</span> paste<span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;heitao 1&quot;</span>   <span class="string">&quot;heitao 2&quot;</span>   <span class="string">&quot;heitao 3&quot;</span>   <span class="string">&quot;heitao 4&quot;</span>   <span class="string">&quot;heitao 5&quot;</span>   <span class="string">&quot;heitao 6&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;fangpian 1&quot;</span> <span class="string">&quot;fangpian 2&quot;</span> <span class="string">&quot;fangpian 3&quot;</span> <span class="string">&quot;fangpian 4&quot;</span> <span class="string">&quot;fangpian 5&quot;</span> <span class="string">&quot;fangpian 6&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hongtao 1&quot;</span>  <span class="string">&quot;hongtao 2&quot;</span>  <span class="string">&quot;hongtao 3&quot;</span>  <span class="string">&quot;hongtao 4&quot;</span>  <span class="string">&quot;hongtao 5&quot;</span>  <span class="string">&quot;hongtao 6&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;meihua 1&quot;</span>   <span class="string">&quot;meihua 2&quot;</span>   <span class="string">&quot;meihua 3&quot;</span>   <span class="string">&quot;meihua 4&quot;</span>   <span class="string">&quot;meihua 5&quot;</span>   <span class="string">&quot;meihua 6&quot;</span>  </span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">11</span><span class="punctuation">]</span>         <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;heitao 7&quot;</span>   <span class="string">&quot;heitao 8&quot;</span>   <span class="string">&quot;heitao 9&quot;</span>   <span class="string">&quot;heitao 10&quot;</span>   <span class="string">&quot;heitao 11&quot;</span>   <span class="string">&quot;heitao 12&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;fangpian 7&quot;</span> <span class="string">&quot;fangpian 8&quot;</span> <span class="string">&quot;fangpian 9&quot;</span> <span class="string">&quot;fangpian 10&quot;</span> <span class="string">&quot;fangpian 11&quot;</span> <span class="string">&quot;fangpian 12&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hongtao 7&quot;</span>  <span class="string">&quot;hongtao 8&quot;</span>  <span class="string">&quot;hongtao 9&quot;</span>  <span class="string">&quot;hongtao 10&quot;</span>  <span class="string">&quot;hongtao 11&quot;</span>  <span class="string">&quot;hongtao 12&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;meihua 7&quot;</span>   <span class="string">&quot;meihua 8&quot;</span>   <span class="string">&quot;meihua 9&quot;</span>   <span class="string">&quot;meihua 10&quot;</span>   <span class="string">&quot;meihua 11&quot;</span>   <span class="string">&quot;meihua 12&quot;</span>  </span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">13</span><span class="punctuation">]</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;heitao 13&quot;</span>  </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;fangpian 13&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;hongtao 13&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;meihua 13&quot;</span></span><br><span class="line">outer<span class="punctuation">(</span>b<span class="punctuation">,</span> a<span class="punctuation">,</span> FUN <span class="operator">=</span> paste<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="正则表达式-2">正则表达式</h3><p>regular expression regex RE</p><p>特点</p><ol><li>正则表达式能够凝练字符串的特征</li><li>是通用的字符串表达框架</li><li>是简洁表达一组字符串的表达式</li><li>可以判断某个字符串的特征归属，是否具有这个特征</li></ol><p>作用</p><p>表达文本类型的特征</p><p>同时查找或替换一组字符串</p><p>匹配字符串的全部或部分</p><h4 id="语法-2">语法</h4><p>由字符和操作符构成</p><p>基本和常用的正则表达式操作符如下</p><table><thead><tr><th>操作符</th><th>说明</th><th>例子</th></tr></thead><tbody><tr><td><code>.</code></td><td>表示任何单个字符</td><td></td></tr><tr><td><code>[]</code></td><td>给出单个字符的取值范围</td><td><code>[abc]</code>：a或b或c，<code>[a-z]</code>：a-z单个字母</td></tr><tr><td><code>[^]</code></td><td>排除此取值范围</td><td><code>[^abc]</code>：非a或b或c</td></tr><tr><td><code>*</code></td><td>前一个字符出现<code>&gt;=0</code>次</td><td><code>abc*</code>：ab、abc、abcc、abccc等</td></tr><tr><td><code>+</code></td><td>前一个字符出现<code>&gt;=1</code>次</td><td><code>abc+</code>：abc、abcc、abccc等</td></tr><tr><td><code>?</code></td><td>前一个字符出现<code>0</code>或<code>1</code>次</td><td><code>abc?</code>：ab、abc</td></tr><tr><td>`</td><td>`</td><td>左右表达式中的一个</td></tr><tr><td><code>&#123;m&#125;</code></td><td>前一个字符出现<code>m</code>次</td><td><code>ab&#123;2&#125;c</code>：abbc</td></tr><tr><td><code>&#123;n,&#125;</code></td><td>前一个字符出现<code>&gt;=n</code>次</td><td><code>ab&#123;2,&#125;c</code>：abbc、abbbc、abbbbc等</td></tr><tr><td><code>&#123;m,n&#125;</code></td><td>前一个字符出现<code>m-n</code>次（含<code>n</code>）</td><td><code>ab&#123;1,3&#125;c</code>：abc、abbc、abbbc</td></tr><tr><td><code>^</code></td><td>匹配字符串的开头</td><td><code>^123</code>：字符串以abc开头</td></tr><tr><td><code>$</code></td><td>匹配字符串的结尾</td><td><code>123$</code>：字符串以123结尾</td></tr><tr><td><code>()</code></td><td>分组标记，内部只能使用`</td><td>`</td></tr><tr><td><code>\d</code></td><td>数字，等价于<code>[0-9]</code></td><td></td></tr><tr><td><code>\w</code></td><td>单词字符，等价于<code>[A-Za-z0-9_]</code></td><td></td></tr></tbody></table><h4 id="经典实例">经典实例</h4><p><code>^[A-Za-z]+$</code>：由字母组成的字符串</p><p><code>^[A-Za-z]+$</code>：由字母和数字组成的字符串</p><p><code>^-?[1-9]\d*$</code>：整数</p><p><code>^[1-9]\d*$</code>：正整数</p><p><code>[\u4e00-\u9fa5]</code>：匹配中文字符</p><h3 id="日期和时间">日期和时间</h3><p>时间序列数据</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内置时间序列数据</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>sunspots<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;ts&quot;</span></span><br><span class="line">sunspots</span><br><span class="line">       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec</span><br><span class="line"><span class="number">1749</span>  <span class="number">58.0</span>  <span class="number">62.6</span>  <span class="number">70.0</span>  <span class="number">55.7</span>  <span class="number">85.0</span>  <span class="number">83.5</span>  <span class="number">94.8</span>  <span class="number">66.3</span>  <span class="number">75.9</span>  <span class="number">75.5</span> <span class="number">158.6</span>  <span class="number">85.2</span></span><br><span class="line"><span class="number">1750</span>  <span class="number">73.3</span>  <span class="number">75.9</span>  <span class="number">89.2</span>  <span class="number">88.3</span>  <span class="number">90.0</span> <span class="number">100.0</span>  <span class="number">85.4</span> <span class="number">103.0</span>  <span class="number">91.2</span>  <span class="number">65.7</span>  <span class="number">63.3</span>  <span class="number">75.4</span></span><br><span class="line"><span class="number">1751</span>  <span class="number">70.0</span>  <span class="number">43.5</span>  <span class="number">45.3</span>  <span class="number">56.4</span>  <span class="number">60.7</span>  <span class="number">50.7</span>  <span class="number">66.3</span>  <span class="number">59.8</span>  <span class="number">23.5</span>  <span class="number">23.2</span>  <span class="number">28.5</span>  <span class="number">44.0</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">presidents</span><br><span class="line">     Qtr1 Qtr2 Qtr3 Qtr4</span><br><span class="line"><span class="number">1945</span>   <span class="literal">NA</span>   <span class="number">87</span>   <span class="number">82</span>   <span class="number">75</span></span><br><span class="line"><span class="number">1946</span>   <span class="number">63</span>   <span class="number">50</span>   <span class="number">43</span>   <span class="number">32</span></span><br><span class="line"><span class="number">1947</span>   <span class="number">35</span>   <span class="number">60</span>   <span class="number">54</span>   <span class="number">55</span></span><br><span class="line">...</span><br><span class="line">airmiles</span><br><span class="line">Time Series<span class="operator">:</span></span><br><span class="line">Start <span class="operator">=</span> <span class="number">1937</span> </span><br><span class="line">End <span class="operator">=</span> <span class="number">1960</span> </span><br><span class="line">Frequency <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">412</span>   <span class="number">480</span>   <span class="number">683</span>  <span class="number">1052</span>  <span class="number">1385</span>  <span class="number">1418</span>  <span class="number">1634</span>  <span class="number">2178</span>  <span class="number">3362</span>  <span class="number">5948</span>  <span class="number">6109</span>  <span class="number">5981</span>  <span class="number">6753</span>  <span class="number">8003</span> <span class="number">10566</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="number">12528</span> <span class="number">14760</span> <span class="number">16769</span> <span class="number">19819</span> <span class="number">22362</span> <span class="number">25340</span> <span class="number">25343</span> <span class="number">29269</span> <span class="number">30514</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>airmiles<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;ts&quot;</span></span><br><span class="line"></span><br><span class="line">Sys.Date<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment"># 输出系统时间</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2022-01-31&quot;</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>Sys.Date<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Date&quot;</span> <span class="comment"># 单独的数据类型，不是字符串</span></span><br><span class="line"></span><br><span class="line">a <span class="operator">&lt;-</span> as.Date<span class="punctuation">(</span><span class="string">&#x27;2022-02-02&#x27;</span><span class="punctuation">,</span> format <span class="operator">=</span> <span class="string">&#x27;%Y-%m-%d&#x27;</span><span class="punctuation">)</span> <span class="comment"># 字符串转换成时间</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;Date&quot;</span></span><br><span class="line"><span class="operator">?</span>strftime <span class="comment"># 更多格式信息查看</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成时间序列，系统自动按时间处理，不会出现2月30日等情况</span></span><br><span class="line">seq<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="string">&#x27;2022-01-01&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> as.Date<span class="punctuation">(</span><span class="string">&#x27;2022-03-01&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> by<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;2022-01-01&quot;</span> <span class="string">&quot;2022-01-06&quot;</span> <span class="string">&quot;2022-01-11&quot;</span> <span class="string">&quot;2022-01-16&quot;</span> <span class="string">&quot;2022-01-21&quot;</span> <span class="string">&quot;2022-01-26&quot;</span> <span class="string">&quot;2022-01-31&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="string">&quot;2022-02-05&quot;</span> <span class="string">&quot;2022-02-10&quot;</span> <span class="string">&quot;2022-02-15&quot;</span> <span class="string">&quot;2022-02-20&quot;</span> <span class="string">&quot;2022-02-25&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机数</span></span><br><span class="line">runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span> <span class="built_in">min</span> <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span> <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">9.0326531</span> <span class="number">0.5515827</span> <span class="number">6.8552402</span> <span class="number">0.8496375</span> <span class="number">7.1430260</span> <span class="number">5.6753642</span> <span class="number">9.7609197</span> <span class="number">7.2243469</span> <span class="number">5.2854405</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="number">7.4681394</span></span><br><span class="line"></span><br><span class="line">sales <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">48</span><span class="punctuation">,</span> <span class="built_in">min</span> <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> <span class="built_in">max</span> <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">sales</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">98</span> <span class="number">96</span> <span class="number">77</span> <span class="number">51</span> <span class="number">55</span> <span class="number">54</span> <span class="number">80</span> <span class="number">71</span> <span class="number">59</span> <span class="number">65</span> <span class="number">70</span> <span class="number">81</span> <span class="number">54</span> <span class="number">75</span> <span class="number">64</span> <span class="number">99</span> <span class="number">74</span> <span class="number">58</span> <span class="number">89</span> <span class="number">93</span> <span class="number">78</span> <span class="number">80</span> <span class="number">83</span> <span class="number">71</span> <span class="number">53</span> <span class="number">99</span> <span class="number">69</span> <span class="number">64</span> <span class="number">91</span> <span class="number">94</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="number">72</span> <span class="number">54</span> <span class="number">85</span> <span class="number">83</span> <span class="number">58</span> <span class="number">74</span> <span class="number">55</span> <span class="number">76</span> <span class="number">54</span> <span class="number">57</span> <span class="number">87</span> <span class="number">79</span> <span class="number">83</span> <span class="number">72</span> <span class="number">54</span> <span class="number">87</span> <span class="number">96</span> <span class="number">61</span></span><br><span class="line"></span><br><span class="line">ts<span class="punctuation">(</span>sales<span class="punctuation">,</span> start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2022</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2022</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> frequency <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span> <span class="comment"># 生成时间序列</span></span><br><span class="line">     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span><br><span class="line"><span class="number">2022</span>  <span class="number">98</span>  <span class="number">96</span>  <span class="number">77</span>  <span class="number">51</span>  <span class="number">55</span>  <span class="number">54</span>  <span class="number">80</span>  <span class="number">71</span>  <span class="number">59</span>  <span class="number">65</span>  <span class="number">70</span>  <span class="number">81</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># frequency：1表示按年，12表示按月份，4表示按季度</span></span><br><span class="line">ts<span class="punctuation">(</span>sales<span class="punctuation">,</span> start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2022</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2025</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> frequency <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">Time Series<span class="operator">:</span></span><br><span class="line">Start <span class="operator">=</span> <span class="number">2022</span> </span><br><span class="line">End <span class="operator">=</span> <span class="number">2025</span> </span><br><span class="line">Frequency <span class="operator">=</span> <span class="number">1</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">98</span> <span class="number">96</span> <span class="number">77</span> <span class="number">51</span></span><br><span class="line">ts<span class="punctuation">(</span>sales<span class="punctuation">,</span> start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2022</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2023</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> frequency <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line">     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span><br><span class="line"><span class="number">2022</span>  <span class="number">98</span>  <span class="number">96</span>  <span class="number">77</span>  <span class="number">51</span>  <span class="number">55</span>  <span class="number">54</span>  <span class="number">80</span>  <span class="number">71</span>  <span class="number">59</span>  <span class="number">65</span>  <span class="number">70</span>  <span class="number">81</span></span><br><span class="line"><span class="number">2023</span>  <span class="number">54</span>                                            </span><br><span class="line">ts<span class="punctuation">(</span>sales<span class="punctuation">,</span> start <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2022</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> end <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2023</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> frequency <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">     Qtr1 Qtr2 Qtr3 Qtr4</span><br><span class="line"><span class="number">2022</span>   <span class="number">98</span>   <span class="number">96</span>   <span class="number">77</span>   <span class="number">51</span></span><br><span class="line"><span class="number">2023</span>   <span class="number">55</span> </span><br></pre></td></tr></table></figure><h2 id="数据处理">数据处理</h2><h3 id="数据获取">数据获取</h3><p>获取数据的途径：</p><ol><li>键盘直接敲入</li><li>读取存储在外部文件中已预处理好的数据</li><li>访问数据库系统</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过键盘敲入</span></span><br><span class="line">patientID <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">admdate <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;10/15/2009&quot;</span><span class="punctuation">,</span> <span class="string">&quot;11/01/2009&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10/21/2009&quot;</span><span class="punctuation">,</span> <span class="string">&quot;10/28/2009&quot;</span><span class="punctuation">)</span></span><br><span class="line">age <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">25</span><span class="punctuation">,</span> <span class="number">34</span><span class="punctuation">,</span> <span class="number">28</span><span class="punctuation">,</span> <span class="number">52</span><span class="punctuation">)</span></span><br><span class="line">diabetes <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Type1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Type2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Type1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Type1&quot;</span><span class="punctuation">)</span></span><br><span class="line">status <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Poor&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Improved&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Excellent&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Poor&quot;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>patientID<span class="punctuation">,</span> age<span class="punctuation">,</span> diabetes<span class="punctuation">,</span> status<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或通过编辑器输入，需先设置变量，否则数据无法保存</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>patientID<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> admdate<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> age<span class="operator">=</span>numeric<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> diabetes<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> status<span class="operator">=</span>character<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> edit<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 或fix()函数修改，不用再赋值</span></span><br><span class="line">fix<span class="punctuation">(</span>data2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问数据库系统</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&quot;RODBC&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="文件读取">文件读取</h3><p>纯文本文件<code>.csv .txt</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line">    Ozone Solar.R Wind Temp Month Day</span><br><span class="line"><span class="number">1</span>      <span class="number">41</span>     <span class="number">190</span>  <span class="number">7.4</span>   <span class="number">67</span>     <span class="number">5</span>   <span class="number">1</span></span><br><span class="line"><span class="number">2</span>      <span class="number">36</span>     <span class="number">118</span>  <span class="number">8.0</span>   <span class="number">72</span>     <span class="number">5</span>   <span class="number">2</span></span><br><span class="line"><span class="number">3</span>      <span class="number">12</span>     <span class="number">149</span> <span class="number">12.6</span>   <span class="number">74</span>     <span class="number">5</span>   <span class="number">3</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认空格分隔符</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">x</span><br><span class="line">                    V1                                                                  V2</span><br><span class="line"><span class="number">1</span>                      <span class="punctuation">,</span><span class="string">&quot;mpg&quot;</span><span class="punctuation">,</span><span class="string">&quot;cyl&quot;</span><span class="punctuation">,</span><span class="string">&quot;disp&quot;</span><span class="punctuation">,</span><span class="string">&quot;hp&quot;</span><span class="punctuation">,</span><span class="string">&quot;drat&quot;</span><span class="punctuation">,</span><span class="string">&quot;wt&quot;</span><span class="punctuation">,</span><span class="string">&quot;qsec&quot;</span><span class="punctuation">,</span><span class="string">&quot;vs&quot;</span><span class="punctuation">,</span><span class="string">&quot;am&quot;</span><span class="punctuation">,</span><span class="string">&quot;gear&quot;</span><span class="punctuation">,</span><span class="string">&quot;carb&quot;</span></span><br><span class="line"><span class="number">2</span>            Mazda RX4                                <span class="punctuation">,</span><span class="number">21</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">160</span><span class="punctuation">,</span><span class="number">110</span><span class="punctuation">,</span><span class="number">3.9</span><span class="punctuation">,</span><span class="number">2.62</span><span class="punctuation">,</span><span class="number">16.46</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Mazda RX4 Wag                               <span class="punctuation">,</span><span class="number">21</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">160</span><span class="punctuation">,</span><span class="number">110</span><span class="punctuation">,</span><span class="number">3.9</span><span class="punctuation">,</span><span class="number">2.875</span><span class="punctuation">,</span><span class="number">17.02</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">4</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.csv&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;,&#x27;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">                 V1   V2  V3   V4  V5   V6    V7    V8 V9 V10  V11  V12</span><br><span class="line"><span class="number">1</span>                    mpg cyl disp  hp drat    wt  qsec vs  am gear carb</span><br><span class="line"><span class="number">2</span>         Mazda RX4   <span class="number">21</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span>  <span class="number">2.62</span> <span class="number">16.46</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4 Wag   <span class="number">21</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.csv&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;,&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可跳过前多少行</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.csv&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;,&#x27;</span><span class="punctuation">,</span> skip <span class="operator">=</span> <span class="number">30</span><span class="punctuation">)</span></span><br><span class="line">x</span><br><span class="line">             V1   V2 V3  V4  V5   V6   V7   V8 V9 V10 V11 V12</span><br><span class="line"><span class="number">1</span>  Ferrari Dino <span class="number">19.7</span>  <span class="number">6</span> <span class="number">145</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.77</span> <span class="number">15.5</span>  <span class="number">0</span>   <span class="number">1</span>   <span class="number">5</span>   <span class="number">6</span></span><br><span class="line"><span class="number">2</span> Maserati Bora <span class="number">15.0</span>  <span class="number">8</span> <span class="number">301</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.57</span> <span class="number">14.6</span>  <span class="number">0</span>   <span class="number">1</span>   <span class="number">5</span>   <span class="number">8</span></span><br><span class="line"><span class="number">3</span>    Volvo <span class="number">142</span>E <span class="number">21.4</span>  <span class="number">4</span> <span class="number">121</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.78</span> <span class="number">18.6</span>  <span class="number">1</span>   <span class="number">1</span>   <span class="number">4</span>   <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只读取多少行</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/input.csv&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;,&#x27;</span><span class="punctuation">,</span> nrows <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">x</span><br><span class="line">         V1  V2  V3   V4  V5   V6   V7    V8 V9 V10  V11  V12</span><br><span class="line"><span class="number">1</span>           mpg cyl disp  hp drat   wt  qsec vs  am gear carb</span><br><span class="line"><span class="number">2</span> Mazda RX4  <span class="number">21</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span> <span class="number">2.62</span> <span class="number">16.46</span>  <span class="number">0</span>   <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line">read.fwf<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/fwf.txt&#x27;</span><span class="punctuation">,</span>widths <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">11</span><span class="punctuation">,</span><span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># read.table()的简化版本</span></span><br><span class="line">read.csv<span class="punctuation">(</span>file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="string">&quot;\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">         dec <span class="operator">=</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">read.csv2<span class="punctuation">(</span>file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;;&quot;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="string">&quot;\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">          dec <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">read.delim<span class="punctuation">(</span>file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="string">&quot;\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">           dec <span class="operator">=</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">read.delim2<span class="punctuation">(</span>file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="string">&quot;\&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            dec <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>网页表格，剪贴板，压缩文件</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;https://codeload.github.com/mperdeck/LINQtoCSV/zip/master&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>XML<span class="punctuation">)</span></span><br><span class="line">readHTMLTable<span class="punctuation">(</span><span class="string">&quot;https://en.wikipedia.org/wiki/World_population&quot;</span><span class="punctuation">,</span> which<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索相关R包</span></span><br><span class="line">RSiteSearch<span class="punctuation">(</span><span class="string">&#x27;manhattan&#x27;</span><span class="punctuation">)</span></span><br><span class="line">A search query has been submitted to http<span class="operator">:</span><span class="operator">/</span><span class="operator">/</span>search.r<span class="operator">-</span>project.org</span><br><span class="line">计算结果应很快就在瀏覽器里打开</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取剪贴板</span></span><br><span class="line">read.table<span class="punctuation">(</span><span class="string">&#x27;clipboard&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接读取压缩文件，不用解压</span></span><br><span class="line">read.table<span class="punctuation">(</span>gzfile<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/newfile.txt.gz&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><code>scan()</code>和<code>readLines()</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">readLines<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/newfile.txt&#x27;</span><span class="punctuation">,</span> n<span class="operator">=</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;\&quot;Ozone\&quot; \&quot;Solar.R\&quot; \&quot;Wind\&quot; \&quot;Temp\&quot; \&quot;Month\&quot; \&quot;Day\&quot;&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="string">&quot;\&quot;1\&quot; 41 190 7.4 67 5 1&quot;</span>                                  </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span> <span class="string">&quot;\&quot;2\&quot; 36 118 8 72 5 2&quot;</span>                                    </span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;\&quot;3\&quot; 12 149 12.6 74 5 3&quot;</span> </span><br><span class="line"></span><br><span class="line">readLines<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/scan.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="string">&quot;one\t2\t3\tfour\t5\t6&quot;</span> <span class="string">&quot;&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># scan()按特定方式扫描文件</span></span><br><span class="line">read.table<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/scan.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">    V1 V2 V3   V4 V5 V6</span><br><span class="line"><span class="number">1</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">2</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">3</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">4</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">5</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">6</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">7</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">8</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">9</span>  one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="number">10</span> one  <span class="number">2</span>  <span class="number">3</span> four  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line">scan<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/scan.txt&#x27;</span><span class="punctuation">,</span> what <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>character<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">Read <span class="number">60</span> records</span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">27</span><span class="punctuation">]</span> <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>   </span><br><span class="line"><span class="punctuation">[</span><span class="number">40</span><span class="punctuation">]</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">53</span><span class="punctuation">]</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span>    <span class="string">&quot;one&quot;</span>  <span class="string">&quot;2&quot;</span>    <span class="string">&quot;3&quot;</span>    <span class="string">&quot;four&quot;</span> <span class="string">&quot;5&quot;</span>    <span class="string">&quot;6&quot;</span> </span><br><span class="line"></span><br><span class="line">scan<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/scan.txt&#x27;</span><span class="punctuation">,</span> what <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>character<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">Read <span class="number">20</span> records</span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span> <span class="string">&quot;one&quot;</span>  <span class="string">&quot;four&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span> <span class="number">3</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line">scan<span class="punctuation">(</span><span class="string">&#x27;/home/lah/Desktop/R_DATA/scan.txt&#x27;</span><span class="punctuation">,</span> what <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>A<span class="operator">=</span>character<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> B<span class="operator">=</span>numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> C<span class="operator">=</span>numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> D<span class="operator">=</span>character<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> E<span class="operator">=</span>numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">F</span><span class="operator">=</span>numeric<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">Read <span class="number">10</span> records</span><br><span class="line"><span class="operator">$</span>A</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span> <span class="string">&quot;one&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>B</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>C</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>D</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span> <span class="string">&quot;four&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>E</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span><span class="built_in">F</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><h3 id="文件写入">文件写入</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># write()直接写入向量或矩阵</span></span><br><span class="line">write<span class="punctuation">(</span>x<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&#x27;2.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一行写入的个数</span></span><br><span class="line">write<span class="punctuation">(</span>x<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&#x27;2.txt&#x27;</span><span class="punctuation">,</span> ncolumns <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">write<span class="punctuation">(</span>x<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&#x27;2.txt&#x27;</span><span class="punctuation">,</span> ncolumns <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># write.table()写入数据框或矩阵</span></span><br><span class="line">write.table<span class="punctuation">(</span>state.x77<span class="punctuation">,</span> <span class="string">&#x27;2.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置分隔符</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.csv&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;,&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 追加</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.csv&#x27;</span><span class="punctuation">,</span> append <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串不加引号</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除行名或列名</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;2.csv&#x27;</span><span class="punctuation">,</span> col.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接写成压缩文件</span></span><br><span class="line">write.table<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> gzfile<span class="punctuation">(</span><span class="string">&#x27;1.txt.gz&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入或读取其他统计软件格式的文件，用foreign包</span></span><br><span class="line">library<span class="punctuation">(</span>foreign<span class="punctuation">)</span></span><br><span class="line">help<span class="punctuation">(</span>package <span class="operator">=</span> <span class="string">&#x27;foreign&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="Excel文件读写">Excel文件读写</h3><p><code>XLConnect</code>包（需Java：<a href="https://blog.csdn.net/weixin_36350581/article/details/114214756%EF%BC%89%E8%BF%90%E8%A1%8C%E5%A4%B1%E8%B4%A5">https://blog.csdn.net/weixin_36350581/article/details/114214756）运行失败</a></p><p><code>XLSX</code>包 运行失败</p><p><code>openxlsx</code>包</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取，默认读取第一个sheet</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">)</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> sheet <span class="operator">=</span> <span class="string">&#x27;state info&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从某行开始读</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> startRow <span class="operator">=</span> <span class="number">48</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否包括行名和列名</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> colNames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> rowNames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否跳过空行和空列</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> skipEmptyRows <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> skipEmptyCols <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取指定行列数</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> sheet <span class="operator">=</span> <span class="string">&#x27;test&#x27;</span><span class="punctuation">,</span> cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  A</span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span> <span class="number">5</span></span><br><span class="line"><span class="number">6</span> <span class="number">6</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> sheet <span class="operator">=</span> <span class="string">&#x27;test&#x27;</span><span class="punctuation">,</span> cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  A B C</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span></span><br><span class="line"><span class="number">6</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></span><br><span class="line">read.xlsx<span class="punctuation">(</span><span class="string">&#x27;writeXLSX2.xlsx&#x27;</span><span class="punctuation">,</span> sheet <span class="operator">=</span> <span class="string">&#x27;test&#x27;</span><span class="punctuation">,</span> cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> rows <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  A B C</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line">write.xlsx<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;test.xlsx&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 作为表格写入</span></span><br><span class="line">write.xlsx<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;test.xlsx&#x27;</span><span class="punctuation">,</span> asTable <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认覆盖写入</span></span><br><span class="line">write.xlsx<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="string">&#x27;test.xlsx&#x27;</span><span class="punctuation">,</span> overwrite <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">Error <span class="keyword">in</span> saveWorkbook<span class="punctuation">(</span>wb<span class="punctuation">,</span> file <span class="operator">=</span> file<span class="punctuation">,</span> overwrite <span class="operator">=</span> overwrite<span class="punctuation">)</span> <span class="operator">:</span> </span><br><span class="line">  File already exists<span class="operator">!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入行名或列名</span></span><br><span class="line">write.xlsx<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&#x27;car.xlsx&#x27;</span><span class="punctuation">,</span> rowNames<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> colNames<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可写入多个data frame到不同的sheet</span></span><br><span class="line">l <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&#x27;Cars Info&#x27;</span> <span class="operator">=</span> mtcars<span class="punctuation">,</span> <span class="string">&#x27;Iris Info&#x27;</span> <span class="operator">=</span> iris<span class="punctuation">,</span> <span class="string">&#x27;State info&#x27;</span> <span class="operator">=</span> data.frame<span class="punctuation">(</span>state.name<span class="punctuation">,</span> state.abb<span class="punctuation">,</span> state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">write.xlsx<span class="punctuation">(</span>l<span class="punctuation">,</span> <span class="string">&#x27;test.xlsx&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="R-格式文件读写">R 格式文件读写</h3><p><code>.rds</code>文件可以保存单个R对象</p><p><code>.rdata</code>文件可以保存对个R对象</p><p>存储为R文件有很多优势，特别是对于大数据文件，R会自动压缩处理并包含更多信息。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>iris<span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存为rds文件</span></span><br><span class="line">saveRDS<span class="punctuation">(</span>iris<span class="punctuation">,</span> file<span class="operator">=</span><span class="string">&#x27;iris.rds&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取rds文件为一个R对象，交互界面下双击文件即可</span></span><br><span class="line">iris_test <span class="operator">&lt;-</span> readRDS<span class="punctuation">(</span><span class="string">&quot;~/R_learn/R_Data_Structure/iris.rds&quot;</span><span class="punctuation">)</span></span><br><span class="line">iris_test</span><br><span class="line">    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span><br><span class="line"><span class="number">1</span>            <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">2</span>            <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</span><br><span class="line"><span class="number">3</span>            <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将R对象保存至Rdata文件</span></span><br><span class="line">save<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> iris<span class="punctuation">,</span> iris3<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&#x27;test_data.Rdata&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 载入Rdata文件</span></span><br><span class="line"><span class="comment"># 注意如果要载入的R对象名称与现有工作空间内R对象重名，将覆盖</span></span><br><span class="line">load<span class="punctuation">(</span><span class="string">&quot;~/R_learn/R_Data_Structure/test_data.Rdata&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存所有R对象</span></span><br><span class="line">save.image<span class="punctuation">(</span>file <span class="operator">=</span> <span class="string">&#x27;test.Rdata&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="数据转换">数据转换</h3><h4 id="数据类型转换">数据类型转换</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>car， n <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">                     mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line"><span class="number">1</span>         Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">2</span>     Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">3</span>        Datsun <span class="number">710</span> <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># is多在函数编程时作为条件判断</span></span><br><span class="line">is.data.frame<span class="punctuation">(</span>car<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"><span class="built_in">is.matrix</span><span class="punctuation">(</span>car<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="built_in">is.na</span><span class="punctuation">(</span>car<span class="punctuation">)</span></span><br><span class="line">                      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span><br><span class="line">Mazda RX4           <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line">Mazda RX4 Wag       <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有is</span></span><br><span class="line">methods<span class="punctuation">(</span>is<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="built_in">is.array</span>                <span class="built_in">is.atomic</span>               <span class="built_in">is.call</span>                </span><br><span class="line"> <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="built_in">is.character</span>            <span class="built_in">is.complex</span>              is.data.frame          </span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="built_in">is.double</span>               is.element              is.empty.model  </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># as转换数类型</span></span><br><span class="line"><span class="comment"># as并不总是奏效，如数据框无法转换成向量</span></span><br><span class="line">dstate.x77 <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">)</span></span><br><span class="line">View<span class="punctuation">(</span>dstate.x77<span class="punctuation">)</span></span><br><span class="line">is.data.frame<span class="punctuation">(</span>dstate.x77<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有as</span></span><br><span class="line">methods<span class="punctuation">(</span>as<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> as.array                      as.array.default              <span class="built_in">as.call</span>                      </span><br><span class="line">  <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="built_in">as.character</span>                  as.character.condition        as.character.Date            </span><br><span class="line">  <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> as.character.default          as.character.error            as.character.factor </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 向量可以很方便地做各种转换</span></span><br><span class="line">a <span class="operator">&lt;-</span> state.abb</span><br><span class="line">head<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;CO&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加上维度转换成矩阵</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>a<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>a<span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;VA&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;WA&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;PA&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;WV&quot;</span> </span><br><span class="line">a <span class="operator">&lt;-</span> state.abb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为因子</span></span><br><span class="line">as.factor<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ</span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY</span><br><span class="line"><span class="number">50</span> Levels<span class="operator">:</span> AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI MN MO MS MT ... WY</span><br><span class="line">as.list<span class="punctuation">(</span>a<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AK&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AZ&quot;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 组成数据框</span></span><br><span class="line">state <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>a<span class="punctuation">,</span>state.x77<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>state<span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">            a Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">Alabama    AL       <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span>    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska     AK        <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span>    <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona    AZ       <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span>    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line">state<span class="operator">$</span>Population</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">3615</span>   <span class="number">365</span>  <span class="number">2212</span>  <span class="number">2110</span> <span class="number">21198</span>  <span class="number">2541</span>  <span class="number">3100</span>   <span class="number">579</span>  <span class="number">8277</span>  <span class="number">4931</span>   <span class="number">868</span>   <span class="number">813</span> <span class="number">11197</span>  <span class="number">5313</span>  <span class="number">2861</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span>  <span class="number">2280</span>  <span class="number">3387</span>  <span class="number">3806</span>  <span class="number">1058</span>  <span class="number">4122</span>  <span class="number">5814</span>  <span class="number">9111</span>  <span class="number">3921</span>  <span class="number">2341</span>  <span class="number">4767</span>   <span class="number">746</span>  <span class="number">1544</span>   <span class="number">590</span>   <span class="number">812</span>  <span class="number">7333</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span>  <span class="number">1144</span> <span class="number">18076</span>  <span class="number">5441</span>   <span class="number">637</span> <span class="number">10735</span>  <span class="number">2715</span>  <span class="number">2284</span> <span class="number">11860</span>   <span class="number">931</span>  <span class="number">2816</span>   <span class="number">681</span>  <span class="number">4173</span> <span class="number">12237</span>  <span class="number">1203</span>   <span class="number">472</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">46</span><span class="punctuation">]</span>  <span class="number">4981</span>  <span class="number">3559</span>  <span class="number">1799</span>  <span class="number">4589</span>   <span class="number">376</span></span><br><span class="line"></span><br><span class="line">b <span class="operator">&lt;-</span> state<span class="punctuation">[</span><span class="string">&#x27;California&#x27;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">is.data.frame<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不显示名字</span></span><br><span class="line">unname<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line">                                                      </span><br><span class="line">California CA <span class="number">21198</span> <span class="number">5114</span> <span class="number">1.1</span> <span class="number">71.71</span> <span class="number">10.3</span> <span class="number">62.6</span> <span class="number">20</span> <span class="number">156361</span></span><br><span class="line">head<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line">            a Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">California CA      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据框转换为向量</span></span><br><span class="line">unlist<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line">         a Population     Income Illiteracy   Life.Exp     Murder    HS.Grad      Frost </span><br><span class="line">      <span class="string">&quot;CA&quot;</span>    <span class="string">&quot;21198&quot;</span>     <span class="string">&quot;5114&quot;</span>      <span class="string">&quot;1.1&quot;</span>    <span class="string">&quot;71.71&quot;</span>     <span class="string">&quot;10.3&quot;</span>     <span class="string">&quot;62.6&quot;</span>       <span class="string">&quot;20&quot;</span> </span><br><span class="line">      Area </span><br><span class="line">  <span class="string">&quot;156361&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样不能转换</span></span><br><span class="line">as.vector<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line">            a Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span><br><span class="line">California CA      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span>    <span class="number">62.6</span>    <span class="number">20</span> <span class="number">156361</span></span><br><span class="line"><span class="built_in">c</span> <span class="operator">&lt;-</span> as.vector<span class="punctuation">(</span>b<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br></pre></td></tr></table></figure><h4 id="数据取子集、合并、添加">数据取子集、合并、添加</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 索引</span></span><br><span class="line">state.x77<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line">           Population Income Illiteracy Life Exp Murder</span><br><span class="line">Alabama          <span class="number">3615</span>   <span class="number">3624</span>        <span class="number">2.1</span>    <span class="number">69.05</span>   <span class="number">15.1</span></span><br><span class="line">Alaska            <span class="number">365</span>   <span class="number">6315</span>        <span class="number">1.5</span>    <span class="number">69.31</span>   <span class="number">11.3</span></span><br><span class="line">Arizona          <span class="number">2212</span>   <span class="number">4530</span>        <span class="number">1.8</span>    <span class="number">70.55</span>    <span class="number">7.8</span></span><br><span class="line">Arkansas         <span class="number">2110</span>   <span class="number">3378</span>        <span class="number">1.9</span>    <span class="number">70.66</span>   <span class="number">10.1</span></span><br><span class="line">California      <span class="number">21198</span>   <span class="number">5114</span>        <span class="number">1.1</span>    <span class="number">71.71</span>   <span class="number">10.3</span></span><br><span class="line"></span><br><span class="line">state.x77<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">        Population Income</span><br><span class="line">Alabama       <span class="number">3615</span>   <span class="number">3624</span></span><br><span class="line">Alaska         <span class="number">365</span>   <span class="number">6315</span></span><br><span class="line">Arizona       <span class="number">2212</span>   <span class="number">4530</span></span><br><span class="line"></span><br><span class="line">state.x77<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">            Population Income</span><br><span class="line">Alabama           <span class="number">3615</span>   <span class="number">3624</span></span><br><span class="line">Alaska             <span class="number">365</span>   <span class="number">6315</span></span><br><span class="line">Connecticut       <span class="number">3100</span>   <span class="number">5348</span></span><br><span class="line"></span><br><span class="line">state.x77<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line">        HS Grad Frost   Area</span><br><span class="line">Alabama    <span class="number">41.3</span>    <span class="number">20</span>  <span class="number">50708</span></span><br><span class="line">Alaska     <span class="number">66.7</span>   <span class="number">152</span> <span class="number">566432</span></span><br><span class="line">Arizona    <span class="number">58.1</span>    <span class="number">15</span> <span class="number">113417</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件索引</span></span><br><span class="line">mtcars<span class="punctuation">[</span>mtcars<span class="operator">$</span>cyl<span class="operator">==</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Datsun <span class="number">710</span>     <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Merc <span class="number">240</span>D      <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>       <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">mtcars<span class="punctuation">[</span>mtcars<span class="operator">$</span>mpg<span class="operator">&gt;</span><span class="number">30</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Fiat <span class="number">128</span>       <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Honda Civic    <span class="number">30.4</span>   <span class="number">4</span> <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Toyota Corolla <span class="number">33.9</span>   <span class="number">4</span> <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Lotus Europa   <span class="number">30.4</span>   <span class="number">4</span> <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line">subset<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mtcars<span class="operator">$</span>mpg<span class="operator">&gt;</span><span class="number">32</span><span class="punctuation">)</span></span><br><span class="line">                mpg cyl disp hp drat    wt  qsec vs am gear carb</span><br><span class="line">Fiat <span class="number">128</span>       <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span> <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Toyota Corolla <span class="number">33.9</span>   <span class="number">4</span> <span class="number">71.1</span> <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line">mtcars<span class="punctuation">[</span>mtcars<span class="operator">$</span>mpg<span class="operator">&gt;</span><span class="number">30</span> <span class="operator">&amp;</span> mtcars<span class="operator">$</span>wt<span class="operator">&gt;</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">          mpg cyl disp hp drat  wt  qsec vs am gear carb</span><br><span class="line">Fiat <span class="number">128</span> <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span> <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.2</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用subset函数</span></span><br><span class="line">subset<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mtcars<span class="operator">$</span>mpg<span class="operator">&gt;</span><span class="number">32</span> <span class="operator">&amp;</span> mtcars<span class="operator">$</span>wt<span class="operator">&gt;</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">          mpg cyl disp hp drat  wt  qsec vs am gear carb</span><br><span class="line">Fiat <span class="number">128</span> <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span> <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.2</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sample函数抽样</span></span><br><span class="line">x <span class="operator">&lt;-</span> 1<span class="operator">:</span><span class="number">100</span></span><br><span class="line">sample<span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">46</span> <span class="number">29</span> <span class="number">39</span> <span class="number">20</span> <span class="number">12</span> <span class="number">70</span> <span class="number">66</span> <span class="number">74</span> <span class="number">33</span> <span class="number">94</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 有放回抽样，可以重复</span></span><br><span class="line">sample<span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> replace <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">23</span> <span class="number">23</span> <span class="number">22</span> <span class="number">52</span> <span class="number">37</span> <span class="number">20</span> <span class="number">78</span> <span class="number">96</span> <span class="number">34</span> <span class="number">92</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据框进行抽样</span></span><br><span class="line">sample<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">22.8</span> <span class="number">15.2</span> <span class="number">10.4</span> <span class="number">21.0</span> <span class="number">21.0</span></span><br><span class="line">mtcars<span class="punctuation">[</span>sample<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">                    mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Honda Civic        <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Chrysler Imperial  <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Toyota Corona      <span class="number">21.5</span>   <span class="number">4</span> <span class="number">120.1</span>  <span class="number">97</span> <span class="number">3.70</span> <span class="number">2.465</span> <span class="number">20.01</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Cadillac Fleetwood <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Fiat X1<span class="operator">-</span><span class="number">9</span>          <span class="number">27.3</span>   <span class="number">4</span>  <span class="number">79.0</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">1.935</span> <span class="number">18.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除数据框的某些行和列</span></span><br><span class="line">mtcars<span class="operator">$</span>mpg <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">head<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">                  cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"></span><br><span class="line">mtcars<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="operator">-</span><span class="number">30</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">              cyl disp  hp drat   wt qsec vs am gear carb</span><br><span class="line">Maserati Bora   <span class="number">8</span>  <span class="number">301</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.57</span> <span class="number">14.6</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E      <span class="number">4</span>  <span class="number">121</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.78</span> <span class="number">18.6</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line">mtcars<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="operator">-</span><span class="number">8</span><span class="punctuation">]</span></span><br><span class="line">                    gear carb</span><br><span class="line">Mazda RX4              <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag          <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>             <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据框的添加与合并</span></span><br><span class="line">state.abb</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;AL&quot;</span> <span class="string">&quot;AK&quot;</span> <span class="string">&quot;AZ&quot;</span> <span class="string">&quot;AR&quot;</span> <span class="string">&quot;CA&quot;</span> <span class="string">&quot;CO&quot;</span> <span class="string">&quot;CT&quot;</span> <span class="string">&quot;DE&quot;</span> <span class="string">&quot;FL&quot;</span> <span class="string">&quot;GA&quot;</span> <span class="string">&quot;HI&quot;</span> <span class="string">&quot;ID&quot;</span> <span class="string">&quot;IL&quot;</span> <span class="string">&quot;IN&quot;</span> <span class="string">&quot;IA&quot;</span> <span class="string">&quot;KS&quot;</span> <span class="string">&quot;KY&quot;</span> <span class="string">&quot;LA&quot;</span> <span class="string">&quot;ME&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="string">&quot;MD&quot;</span> <span class="string">&quot;MA&quot;</span> <span class="string">&quot;MI&quot;</span> <span class="string">&quot;MN&quot;</span> <span class="string">&quot;MS&quot;</span> <span class="string">&quot;MO&quot;</span> <span class="string">&quot;MT&quot;</span> <span class="string">&quot;NE&quot;</span> <span class="string">&quot;NV&quot;</span> <span class="string">&quot;NH&quot;</span> <span class="string">&quot;NJ&quot;</span> <span class="string">&quot;NM&quot;</span> <span class="string">&quot;NY&quot;</span> <span class="string">&quot;NC&quot;</span> <span class="string">&quot;ND&quot;</span> <span class="string">&quot;OH&quot;</span> <span class="string">&quot;OK&quot;</span> <span class="string">&quot;OR&quot;</span> <span class="string">&quot;PA&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span> <span class="string">&quot;RI&quot;</span> <span class="string">&quot;SC&quot;</span> <span class="string">&quot;SD&quot;</span> <span class="string">&quot;TN&quot;</span> <span class="string">&quot;TX&quot;</span> <span class="string">&quot;UT&quot;</span> <span class="string">&quot;VT&quot;</span> <span class="string">&quot;VA&quot;</span> <span class="string">&quot;WA&quot;</span> <span class="string">&quot;WV&quot;</span> <span class="string">&quot;WI&quot;</span> <span class="string">&quot;WY&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并列</span></span><br><span class="line">data.frame<span class="punctuation">(</span>USArrests<span class="punctuation">,</span> state.abb<span class="punctuation">)</span></span><br><span class="line">               Murder Assault UrbanPop Rape state.abb</span><br><span class="line">Alabama          <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span>        AL</span><br><span class="line">Alaska           <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span>        AK</span><br><span class="line">Arizona           <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span>        AZ</span><br><span class="line">...</span><br><span class="line">   </span><br><span class="line">cbind<span class="punctuation">(</span>USArrests<span class="punctuation">,</span> state.abb<span class="punctuation">)</span></span><br><span class="line">               Murder Assault UrbanPop Rape state.abb</span><br><span class="line">Alabama          <span class="number">13.2</span>     <span class="number">236</span>       <span class="number">58</span> <span class="number">21.2</span>        AL</span><br><span class="line">Alaska           <span class="number">10.0</span>     <span class="number">263</span>       <span class="number">48</span> <span class="number">44.5</span>        AK</span><br><span class="line">Arizona           <span class="number">8.1</span>     <span class="number">294</span>       <span class="number">80</span> <span class="number">31.0</span>        AZ</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并行</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> tail<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">rbind<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">)</span></span><br><span class="line">                  cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Lotus Europa        <span class="number">4</span>  <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span></span><br><span class="line">Ford Pantera L      <span class="number">8</span> <span class="number">351.0</span> <span class="number">264</span> <span class="number">4.22</span> <span class="number">3.170</span> <span class="number">14.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">4</span></span><br><span class="line">Ferrari Dino        <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.50</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span></span><br><span class="line">Maserati Bora       <span class="number">8</span> <span class="number">301.0</span> <span class="number">335</span> <span class="number">3.54</span> <span class="number">3.570</span> <span class="number">14.60</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">8</span></span><br><span class="line">Volvo <span class="number">142</span>E          <span class="number">4</span> <span class="number">121.0</span> <span class="number">109</span> <span class="number">4.11</span> <span class="number">2.780</span> <span class="number">18.60</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复数据不会自动去除</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">rbind<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">)</span></span><br><span class="line">                   cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4            <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag        <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>           <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive       <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout    <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Mazda RX41           <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag1       <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">7101</span>          <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive1      <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout1   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant              <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>           <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D            <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>             <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">280</span>             <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.30</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line">data3 <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>data1<span class="punctuation">,</span> data2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># duplicated函数判断是否存在重复数据</span></span><br><span class="line">duplicated<span class="punctuation">(</span>data3<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出重复数据</span></span><br><span class="line">data3<span class="punctuation">[</span>duplicated<span class="punctuation">(</span>data3<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">                   cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX41           <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag1       <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">7101</span>          <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive1      <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout1   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!对TRUE和FALSE取反</span></span><br><span class="line">data3<span class="punctuation">[</span><span class="operator">!</span>duplicated<span class="punctuation">(</span>data3<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">                  cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>            <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">280</span>            <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.30</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># unique函数一步搞定</span></span><br><span class="line">unique<span class="punctuation">(</span>data3<span class="punctuation">)</span></span><br><span class="line">                  cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4           <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag       <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>          <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive      <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant             <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D           <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>            <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.150</span> <span class="number">22.90</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">280</span>            <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.440</span> <span class="number">18.30</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br></pre></td></tr></table></figure><h4 id="数据翻转、更改、排序">数据翻转、更改、排序</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据框转置</span></span><br><span class="line">t<span class="punctuation">(</span>mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">     Mazda RX4 Mazda RX4 Wag Datsun <span class="number">710</span></span><br><span class="line">mpg         <span class="number">21</span>            <span class="number">21</span>       <span class="number">22.8</span></span><br><span class="line">cyl          <span class="number">6</span>             <span class="number">6</span>        <span class="number">4.0</span></span><br><span class="line">disp       <span class="number">160</span>           <span class="number">160</span>      <span class="number">108.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 翻转向量</span></span><br><span class="line"><span class="built_in">letters</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;a&quot;</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;c&quot;</span> <span class="string">&quot;d&quot;</span> <span class="string">&quot;e&quot;</span> <span class="string">&quot;f&quot;</span> <span class="string">&quot;g&quot;</span> <span class="string">&quot;h&quot;</span> <span class="string">&quot;i&quot;</span> <span class="string">&quot;j&quot;</span> <span class="string">&quot;k&quot;</span> <span class="string">&quot;l&quot;</span> <span class="string">&quot;m&quot;</span> <span class="string">&quot;n&quot;</span> <span class="string">&quot;o&quot;</span> <span class="string">&quot;p&quot;</span> <span class="string">&quot;q&quot;</span> <span class="string">&quot;r&quot;</span> <span class="string">&quot;s&quot;</span> <span class="string">&quot;t&quot;</span> <span class="string">&quot;u&quot;</span> <span class="string">&quot;v&quot;</span> <span class="string">&quot;w&quot;</span> <span class="string">&quot;x&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="string">&quot;y&quot;</span> <span class="string">&quot;z&quot;</span></span><br><span class="line">rev<span class="punctuation">(</span><span class="built_in">letters</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;z&quot;</span> <span class="string">&quot;y&quot;</span> <span class="string">&quot;x&quot;</span> <span class="string">&quot;w&quot;</span> <span class="string">&quot;v&quot;</span> <span class="string">&quot;u&quot;</span> <span class="string">&quot;t&quot;</span> <span class="string">&quot;s&quot;</span> <span class="string">&quot;r&quot;</span> <span class="string">&quot;q&quot;</span> <span class="string">&quot;p&quot;</span> <span class="string">&quot;o&quot;</span> <span class="string">&quot;n&quot;</span> <span class="string">&quot;m&quot;</span> <span class="string">&quot;l&quot;</span> <span class="string">&quot;k&quot;</span> <span class="string">&quot;j&quot;</span> <span class="string">&quot;i&quot;</span> <span class="string">&quot;h&quot;</span> <span class="string">&quot;g&quot;</span> <span class="string">&quot;f&quot;</span> <span class="string">&quot;e&quot;</span> <span class="string">&quot;d&quot;</span> <span class="string">&quot;c&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span> <span class="string">&quot;b&quot;</span> <span class="string">&quot;a&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 翻转数据框</span></span><br><span class="line">women</span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line">rev<span class="punctuation">(</span>row.names<span class="punctuation">(</span>women<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 翻转行名后索引即可</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;15&quot;</span> <span class="string">&quot;14&quot;</span> <span class="string">&quot;13&quot;</span> <span class="string">&quot;12&quot;</span> <span class="string">&quot;11&quot;</span> <span class="string">&quot;10&quot;</span> <span class="string">&quot;9&quot;</span>  <span class="string">&quot;8&quot;</span>  <span class="string">&quot;7&quot;</span>  <span class="string">&quot;6&quot;</span>  <span class="string">&quot;5&quot;</span>  <span class="string">&quot;4&quot;</span>  <span class="string">&quot;3&quot;</span>  <span class="string">&quot;2&quot;</span>  <span class="string">&quot;1&quot;</span> </span><br><span class="line">women<span class="punctuation">[</span>rev<span class="punctuation">(</span>row.names<span class="punctuation">(</span>women<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">   height weight</span><br><span class="line"><span class="number">15</span>     <span class="number">72</span>    <span class="number">164</span></span><br><span class="line"><span class="number">14</span>     <span class="number">71</span>    <span class="number">159</span></span><br><span class="line"><span class="number">13</span>     <span class="number">70</span>    <span class="number">154</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改数据框某列的值</span></span><br><span class="line">women<span class="operator">$</span>height<span class="operator">*</span><span class="number">2.54</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">147.32</span> <span class="number">149.86</span> <span class="number">152.40</span> <span class="number">154.94</span> <span class="number">157.48</span> <span class="number">160.02</span> <span class="number">162.56</span> <span class="number">165.10</span> <span class="number">167.64</span> <span class="number">170.18</span> <span class="number">172.72</span> <span class="number">175.26</span> <span class="number">177.80</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">14</span><span class="punctuation">]</span> <span class="number">180.34</span> <span class="number">182.88</span></span><br><span class="line">data.frame<span class="punctuation">(</span>weight<span class="operator">=</span>women<span class="operator">$</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">,</span> women<span class="operator">$</span>weight<span class="punctuation">)</span></span><br><span class="line">   weight women.weight</span><br><span class="line"><span class="number">1</span>  <span class="number">147.32</span>          <span class="number">115</span></span><br><span class="line"><span class="number">2</span>  <span class="number">149.86</span>          <span class="number">117</span></span><br><span class="line"><span class="number">3</span>  <span class="number">152.40</span>          <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># transform函数更高效，也可新增一列</span></span><br><span class="line">transform<span class="punctuation">(</span>women<span class="punctuation">,</span> height<span class="operator">=</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">)</span></span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>  <span class="number">147.32</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>  <span class="number">149.86</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>  <span class="number">152.40</span>    <span class="number">120</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">transform<span class="punctuation">(</span>women<span class="punctuation">,</span> cm<span class="operator">=</span>height<span class="operator">*</span><span class="number">2.54</span><span class="punctuation">)</span></span><br><span class="line">   height weight     cm</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span> <span class="number">147.32</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span> <span class="number">149.86</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span> <span class="number">152.40</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据排序</span></span><br><span class="line">rivers</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">735</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">392</span>  <span class="number">524</span>  <span class="number">450</span> <span class="number">1459</span>  <span class="number">135</span>  <span class="number">465</span>  <span class="number">600</span>  <span class="number">330</span>  <span class="number">336</span>  <span class="number">280</span>  <span class="number">315</span>  <span class="number">870</span>  <span class="number">906</span>  <span class="number">202</span>  <span class="number">329</span>  <span class="number">290</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="number">1000</span>  <span class="number">600</span>  <span class="number">505</span> <span class="number">1450</span>  <span class="number">840</span> <span class="number">1243</span>  <span class="number">890</span>  <span class="number">350</span>  <span class="number">407</span>  <span class="number">286</span>  <span class="number">280</span>  <span class="number">525</span>  <span class="number">720</span>  <span class="number">390</span>  <span class="number">250</span>  <span class="number">327</span>  <span class="number">230</span>  <span class="number">265</span>  <span class="number">850</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">210</span>  <span class="number">630</span>  <span class="number">260</span>  <span class="number">230</span>  <span class="number">360</span>  <span class="number">730</span>  <span class="number">600</span>  <span class="number">306</span>  <span class="number">390</span>  <span class="number">420</span>  <span class="number">291</span>  <span class="number">710</span>  <span class="number">340</span>  <span class="number">217</span>  <span class="number">281</span>  <span class="number">352</span>  <span class="number">259</span>  <span class="number">250</span>  <span class="number">470</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">58</span><span class="punctuation">]</span>  <span class="number">680</span>  <span class="number">570</span>  <span class="number">350</span>  <span class="number">300</span>  <span class="number">560</span>  <span class="number">900</span>  <span class="number">625</span>  <span class="number">332</span> <span class="number">2348</span> <span class="number">1171</span> <span class="number">3710</span> <span class="number">2315</span> <span class="number">2533</span>  <span class="number">780</span>  <span class="number">280</span>  <span class="number">410</span>  <span class="number">460</span>  <span class="number">260</span>  <span class="number">255</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">77</span><span class="punctuation">]</span>  <span class="number">431</span>  <span class="number">350</span>  <span class="number">760</span>  <span class="number">618</span>  <span class="number">338</span>  <span class="number">981</span> <span class="number">1306</span>  <span class="number">500</span>  <span class="number">696</span>  <span class="number">605</span>  <span class="number">250</span>  <span class="number">411</span> <span class="number">1054</span>  <span class="number">735</span>  <span class="number">233</span>  <span class="number">435</span>  <span class="number">490</span>  <span class="number">310</span>  <span class="number">460</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">96</span><span class="punctuation">]</span>  <span class="number">383</span>  <span class="number">375</span> <span class="number">1270</span>  <span class="number">545</span>  <span class="number">445</span> <span class="number">1885</span>  <span class="number">380</span>  <span class="number">300</span>  <span class="number">380</span>  <span class="number">377</span>  <span class="number">425</span>  <span class="number">276</span>  <span class="number">210</span>  <span class="number">800</span>  <span class="number">420</span>  <span class="number">350</span>  <span class="number">360</span>  <span class="number">538</span> <span class="number">1100</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">115</span><span class="punctuation">]</span> <span class="number">1205</span>  <span class="number">314</span>  <span class="number">237</span>  <span class="number">610</span>  <span class="number">360</span>  <span class="number">540</span> <span class="number">1038</span>  <span class="number">424</span>  <span class="number">310</span>  <span class="number">300</span>  <span class="number">444</span>  <span class="number">301</span>  <span class="number">268</span>  <span class="number">620</span>  <span class="number">215</span>  <span class="number">652</span>  <span class="number">900</span>  <span class="number">525</span>  <span class="number">246</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">134</span><span class="punctuation">]</span>  <span class="number">360</span>  <span class="number">529</span>  <span class="number">500</span>  <span class="number">720</span>  <span class="number">270</span>  <span class="number">430</span>  <span class="number">671</span> <span class="number">1770</span></span><br><span class="line">rev<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1770</span>  <span class="number">671</span>  <span class="number">430</span>  <span class="number">270</span>  <span class="number">720</span>  <span class="number">500</span>  <span class="number">529</span>  <span class="number">360</span>  <span class="number">246</span>  <span class="number">525</span>  <span class="number">900</span>  <span class="number">652</span>  <span class="number">215</span>  <span class="number">620</span>  <span class="number">268</span>  <span class="number">301</span>  <span class="number">444</span>  <span class="number">300</span>  <span class="number">310</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>  <span class="number">424</span> <span class="number">1038</span>  <span class="number">540</span>  <span class="number">360</span>  <span class="number">610</span>  <span class="number">237</span>  <span class="number">314</span> <span class="number">1205</span> <span class="number">1100</span>  <span class="number">538</span>  <span class="number">360</span>  <span class="number">350</span>  <span class="number">420</span>  <span class="number">800</span>  <span class="number">210</span>  <span class="number">276</span>  <span class="number">425</span>  <span class="number">377</span>  <span class="number">380</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">300</span>  <span class="number">380</span> <span class="number">1885</span>  <span class="number">445</span>  <span class="number">545</span> <span class="number">1270</span>  <span class="number">375</span>  <span class="number">383</span>  <span class="number">460</span>  <span class="number">310</span>  <span class="number">490</span>  <span class="number">435</span>  <span class="number">233</span>  <span class="number">735</span> <span class="number">1054</span>  <span class="number">411</span>  <span class="number">250</span>  <span class="number">605</span>  <span class="number">696</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">58</span><span class="punctuation">]</span>  <span class="number">500</span> <span class="number">1306</span>  <span class="number">981</span>  <span class="number">338</span>  <span class="number">618</span>  <span class="number">760</span>  <span class="number">350</span>  <span class="number">431</span>  <span class="number">255</span>  <span class="number">260</span>  <span class="number">460</span>  <span class="number">410</span>  <span class="number">280</span>  <span class="number">780</span> <span class="number">2533</span> <span class="number">2315</span> <span class="number">3710</span> <span class="number">1171</span> <span class="number">2348</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">77</span><span class="punctuation">]</span>  <span class="number">332</span>  <span class="number">625</span>  <span class="number">900</span>  <span class="number">560</span>  <span class="number">300</span>  <span class="number">350</span>  <span class="number">570</span>  <span class="number">680</span>  <span class="number">470</span>  <span class="number">250</span>  <span class="number">259</span>  <span class="number">352</span>  <span class="number">281</span>  <span class="number">217</span>  <span class="number">340</span>  <span class="number">710</span>  <span class="number">291</span>  <span class="number">420</span>  <span class="number">390</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">96</span><span class="punctuation">]</span>  <span class="number">306</span>  <span class="number">600</span>  <span class="number">730</span>  <span class="number">360</span>  <span class="number">230</span>  <span class="number">260</span>  <span class="number">630</span>  <span class="number">210</span>  <span class="number">850</span>  <span class="number">265</span>  <span class="number">230</span>  <span class="number">327</span>  <span class="number">250</span>  <span class="number">390</span>  <span class="number">720</span>  <span class="number">525</span>  <span class="number">280</span>  <span class="number">286</span>  <span class="number">407</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">115</span><span class="punctuation">]</span>  <span class="number">350</span>  <span class="number">890</span> <span class="number">1243</span>  <span class="number">840</span> <span class="number">1450</span>  <span class="number">505</span>  <span class="number">600</span> <span class="number">1000</span>  <span class="number">290</span>  <span class="number">329</span>  <span class="number">202</span>  <span class="number">906</span>  <span class="number">870</span>  <span class="number">315</span>  <span class="number">280</span>  <span class="number">336</span>  <span class="number">330</span>  <span class="number">600</span>  <span class="number">465</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">134</span><span class="punctuation">]</span>  <span class="number">135</span> <span class="number">1459</span>  <span class="number">450</span>  <span class="number">524</span>  <span class="number">392</span>  <span class="number">325</span>  <span class="number">320</span>  <span class="number">735</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从小到大排序</span></span><br><span class="line">sort<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">135</span>  <span class="number">202</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">215</span>  <span class="number">217</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">233</span>  <span class="number">237</span>  <span class="number">246</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">255</span>  <span class="number">259</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">265</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>  <span class="number">268</span>  <span class="number">270</span>  <span class="number">276</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">281</span>  <span class="number">286</span>  <span class="number">290</span>  <span class="number">291</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">301</span>  <span class="number">306</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">314</span>  <span class="number">315</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">327</span>  <span class="number">329</span>  <span class="number">330</span>  <span class="number">332</span>  <span class="number">336</span>  <span class="number">338</span>  <span class="number">340</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">352</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">375</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">58</span><span class="punctuation">]</span>  <span class="number">377</span>  <span class="number">380</span>  <span class="number">380</span>  <span class="number">383</span>  <span class="number">390</span>  <span class="number">390</span>  <span class="number">392</span>  <span class="number">407</span>  <span class="number">410</span>  <span class="number">411</span>  <span class="number">420</span>  <span class="number">420</span>  <span class="number">424</span>  <span class="number">425</span>  <span class="number">430</span>  <span class="number">431</span>  <span class="number">435</span>  <span class="number">444</span>  <span class="number">445</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">77</span><span class="punctuation">]</span>  <span class="number">450</span>  <span class="number">460</span>  <span class="number">460</span>  <span class="number">465</span>  <span class="number">470</span>  <span class="number">490</span>  <span class="number">500</span>  <span class="number">500</span>  <span class="number">505</span>  <span class="number">524</span>  <span class="number">525</span>  <span class="number">525</span>  <span class="number">529</span>  <span class="number">538</span>  <span class="number">540</span>  <span class="number">545</span>  <span class="number">560</span>  <span class="number">570</span>  <span class="number">600</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">96</span><span class="punctuation">]</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">605</span>  <span class="number">610</span>  <span class="number">618</span>  <span class="number">620</span>  <span class="number">625</span>  <span class="number">630</span>  <span class="number">652</span>  <span class="number">671</span>  <span class="number">680</span>  <span class="number">696</span>  <span class="number">710</span>  <span class="number">720</span>  <span class="number">720</span>  <span class="number">730</span>  <span class="number">735</span>  <span class="number">735</span>  <span class="number">760</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">115</span><span class="punctuation">]</span>  <span class="number">780</span>  <span class="number">800</span>  <span class="number">840</span>  <span class="number">850</span>  <span class="number">870</span>  <span class="number">890</span>  <span class="number">900</span>  <span class="number">900</span>  <span class="number">906</span>  <span class="number">981</span> <span class="number">1000</span> <span class="number">1038</span> <span class="number">1054</span> <span class="number">1100</span> <span class="number">1171</span> <span class="number">1205</span> <span class="number">1243</span> <span class="number">1270</span> <span class="number">1306</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">134</span><span class="punctuation">]</span> <span class="number">1450</span> <span class="number">1459</span> <span class="number">1770</span> <span class="number">1885</span> <span class="number">2315</span> <span class="number">2348</span> <span class="number">2533</span> <span class="number">3710</span></span><br><span class="line">sort<span class="punctuation">(</span>rivers<span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3710</span> <span class="number">2533</span> <span class="number">2348</span> <span class="number">2315</span> <span class="number">1885</span> <span class="number">1770</span> <span class="number">1459</span> <span class="number">1450</span> <span class="number">1306</span> <span class="number">1270</span> <span class="number">1243</span> <span class="number">1205</span> <span class="number">1171</span> <span class="number">1100</span> <span class="number">1054</span> <span class="number">1038</span> <span class="number">1000</span>  <span class="number">981</span>  <span class="number">906</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>  <span class="number">900</span>  <span class="number">900</span>  <span class="number">890</span>  <span class="number">870</span>  <span class="number">850</span>  <span class="number">840</span>  <span class="number">800</span>  <span class="number">780</span>  <span class="number">760</span>  <span class="number">735</span>  <span class="number">735</span>  <span class="number">730</span>  <span class="number">720</span>  <span class="number">720</span>  <span class="number">710</span>  <span class="number">696</span>  <span class="number">680</span>  <span class="number">671</span>  <span class="number">652</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">630</span>  <span class="number">625</span>  <span class="number">620</span>  <span class="number">618</span>  <span class="number">610</span>  <span class="number">605</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">600</span>  <span class="number">570</span>  <span class="number">560</span>  <span class="number">545</span>  <span class="number">540</span>  <span class="number">538</span>  <span class="number">529</span>  <span class="number">525</span>  <span class="number">525</span>  <span class="number">524</span>  <span class="number">505</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">58</span><span class="punctuation">]</span>  <span class="number">500</span>  <span class="number">500</span>  <span class="number">490</span>  <span class="number">470</span>  <span class="number">465</span>  <span class="number">460</span>  <span class="number">460</span>  <span class="number">450</span>  <span class="number">445</span>  <span class="number">444</span>  <span class="number">435</span>  <span class="number">431</span>  <span class="number">430</span>  <span class="number">425</span>  <span class="number">424</span>  <span class="number">420</span>  <span class="number">420</span>  <span class="number">411</span>  <span class="number">410</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">77</span><span class="punctuation">]</span>  <span class="number">407</span>  <span class="number">392</span>  <span class="number">390</span>  <span class="number">390</span>  <span class="number">383</span>  <span class="number">380</span>  <span class="number">380</span>  <span class="number">377</span>  <span class="number">375</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">352</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">340</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">96</span><span class="punctuation">]</span>  <span class="number">338</span>  <span class="number">336</span>  <span class="number">332</span>  <span class="number">330</span>  <span class="number">329</span>  <span class="number">327</span>  <span class="number">325</span>  <span class="number">320</span>  <span class="number">315</span>  <span class="number">314</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">306</span>  <span class="number">301</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">291</span>  <span class="number">290</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">115</span><span class="punctuation">]</span>  <span class="number">286</span>  <span class="number">281</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">276</span>  <span class="number">270</span>  <span class="number">268</span>  <span class="number">265</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">259</span>  <span class="number">255</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">246</span>  <span class="number">237</span>  <span class="number">233</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">134</span><span class="punctuation">]</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">217</span>  <span class="number">215</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">202</span>  <span class="number">135</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 无法直接排序数据框，先对某一列排序后索引即可</span></span><br><span class="line">sort<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">Error <span class="keyword">in</span> `[.data.frame`<span class="punctuation">(</span>x<span class="punctuation">,</span> order<span class="punctuation">(</span>x<span class="punctuation">,</span> na.last <span class="operator">=</span> na.last<span class="punctuation">,</span> decreasing <span class="operator">=</span> decreasing<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">:</span> </span><br><span class="line">  选择了未定义的列</span><br><span class="line">In addition<span class="operator">:</span> Warning message<span class="operator">:</span></span><br><span class="line">In xtfrm.data.frame<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">:</span> cannot <span class="built_in">xtfrm</span> data frames</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据行名排序</span></span><br><span class="line">mtcars<span class="punctuation">[</span>sort<span class="punctuation">(</span>row.names<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">AMC Javelin         <span class="number">15.2</span>   <span class="number">8</span> <span class="number">304.0</span> <span class="number">150</span> <span class="number">3.15</span> <span class="number">3.435</span> <span class="number">17.30</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Chrysler Imperial   <span class="number">14.7</span>   <span class="number">8</span> <span class="number">440.0</span> <span class="number">230</span> <span class="number">3.23</span> <span class="number">5.345</span> <span class="number">17.42</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">rivers</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">735</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">392</span>  <span class="number">524</span>  <span class="number">450</span> <span class="number">1459</span>  <span class="number">135</span>  <span class="number">465</span>  <span class="number">600</span>  <span class="number">330</span>  <span class="number">336</span>  <span class="number">280</span>  <span class="number">315</span>  <span class="number">870</span>  <span class="number">906</span>  <span class="number">202</span>  <span class="number">329</span>  <span class="number">290</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="number">1000</span>  <span class="number">600</span>  <span class="number">505</span> <span class="number">1450</span>  <span class="number">840</span> <span class="number">1243</span>  <span class="number">890</span>  <span class="number">350</span>  <span class="number">407</span>  <span class="number">286</span>  <span class="number">280</span>  <span class="number">525</span>  <span class="number">720</span>  <span class="number">390</span>  <span class="number">250</span>  <span class="number">327</span>  <span class="number">230</span>  <span class="number">265</span>  <span class="number">850</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">210</span>  <span class="number">630</span>  <span class="number">260</span>  <span class="number">230</span>  <span class="number">360</span>  <span class="number">730</span>  <span class="number">600</span>  <span class="number">306</span>  <span class="number">390</span>  <span class="number">420</span>  <span class="number">291</span>  <span class="number">710</span>  <span class="number">340</span>  <span class="number">217</span>  <span class="number">281</span>  <span class="number">352</span>  <span class="number">259</span>  <span class="number">250</span>  <span class="number">470</span></span><br><span class="line">...</span><br><span class="line">sort<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">135</span>  <span class="number">202</span>  <span class="number">210</span>  <span class="number">210</span>  <span class="number">215</span>  <span class="number">217</span>  <span class="number">230</span>  <span class="number">230</span>  <span class="number">233</span>  <span class="number">237</span>  <span class="number">246</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">250</span>  <span class="number">255</span>  <span class="number">259</span>  <span class="number">260</span>  <span class="number">260</span>  <span class="number">265</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span>  <span class="number">268</span>  <span class="number">270</span>  <span class="number">276</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">280</span>  <span class="number">281</span>  <span class="number">286</span>  <span class="number">290</span>  <span class="number">291</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">300</span>  <span class="number">301</span>  <span class="number">306</span>  <span class="number">310</span>  <span class="number">310</span>  <span class="number">314</span>  <span class="number">315</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">39</span><span class="punctuation">]</span>  <span class="number">320</span>  <span class="number">325</span>  <span class="number">327</span>  <span class="number">329</span>  <span class="number">330</span>  <span class="number">332</span>  <span class="number">336</span>  <span class="number">338</span>  <span class="number">340</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">350</span>  <span class="number">352</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">360</span>  <span class="number">375</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># order，从小到大排序之后，数据在未排序状态下的序号，可用于索引</span></span><br><span class="line">order<span class="punctuation">(</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>   <span class="number">8</span>  <span class="number">17</span>  <span class="number">39</span> <span class="number">108</span> <span class="number">129</span>  <span class="number">52</span>  <span class="number">36</span>  <span class="number">42</span>  <span class="number">91</span> <span class="number">117</span> <span class="number">133</span>  <span class="number">34</span>  <span class="number">56</span>  <span class="number">87</span>  <span class="number">76</span>  <span class="number">55</span>  <span class="number">41</span>  <span class="number">75</span>  <span class="number">37</span> <span class="number">127</span> <span class="number">138</span> <span class="number">107</span>  <span class="number">13</span>  <span class="number">30</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">72</span>  <span class="number">53</span>  <span class="number">29</span>  <span class="number">19</span>  <span class="number">49</span>  <span class="number">61</span> <span class="number">103</span> <span class="number">124</span> <span class="number">126</span>  <span class="number">46</span>  <span class="number">94</span> <span class="number">123</span> <span class="number">116</span>  <span class="number">14</span>   <span class="number">2</span>   <span class="number">3</span>  <span class="number">35</span>  <span class="number">18</span>  <span class="number">11</span>  <span class="number">65</span>  <span class="number">12</span>  <span class="number">81</span>  <span class="number">51</span>  <span class="number">27</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">60</span>  <span class="number">78</span> <span class="number">111</span>  <span class="number">54</span>  <span class="number">43</span> <span class="number">112</span> <span class="number">119</span> <span class="number">134</span>  <span class="number">97</span> <span class="number">105</span> <span class="number">102</span> <span class="number">104</span>  <span class="number">96</span>  <span class="number">33</span>  <span class="number">47</span>   <span class="number">4</span>  <span class="number">28</span>  <span class="number">73</span>  <span class="number">88</span>  <span class="number">48</span> <span class="number">110</span> <span class="number">122</span> <span class="number">106</span> <span class="number">139</span></span><br><span class="line">...</span><br><span class="line">rivers<span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">135</span></span><br><span class="line">rivers<span class="punctuation">[</span><span class="number">17</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">202</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从大到小</span></span><br><span class="line">order<span class="punctuation">(</span><span class="operator">-</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">68</span>  <span class="number">70</span>  <span class="number">66</span>  <span class="number">69</span> <span class="number">101</span> <span class="number">141</span>   <span class="number">7</span>  <span class="number">23</span>  <span class="number">83</span>  <span class="number">98</span>  <span class="number">25</span> <span class="number">115</span>  <span class="number">67</span> <span class="number">114</span>  <span class="number">89</span> <span class="number">121</span>  <span class="number">20</span>  <span class="number">82</span>  <span class="number">16</span>  <span class="number">63</span> <span class="number">131</span>  <span class="number">26</span>  <span class="number">15</span>  <span class="number">38</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">24</span> <span class="number">109</span>  <span class="number">71</span>  <span class="number">79</span>   <span class="number">1</span>  <span class="number">90</span>  <span class="number">44</span>  <span class="number">32</span> <span class="number">137</span>  <span class="number">50</span>  <span class="number">85</span>  <span class="number">58</span> <span class="number">140</span> <span class="number">130</span>  <span class="number">40</span>  <span class="number">64</span> <span class="number">128</span>  <span class="number">80</span> <span class="number">118</span>  <span class="number">86</span>  <span class="number">10</span>  <span class="number">21</span>  <span class="number">45</span>  <span class="number">59</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">62</span>  <span class="number">99</span> <span class="number">120</span> <span class="number">113</span> <span class="number">135</span>  <span class="number">31</span> <span class="number">132</span>   <span class="number">5</span>  <span class="number">22</span>  <span class="number">84</span> <span class="number">136</span>  <span class="number">93</span>  <span class="number">57</span>   <span class="number">9</span>  <span class="number">74</span>  <span class="number">95</span>   <span class="number">6</span> <span class="number">100</span> <span class="number">125</span>  <span class="number">92</span>  <span class="number">77</span> <span class="number">139</span> <span class="number">106</span> <span class="number">122</span></span><br><span class="line">rivers<span class="punctuation">[</span><span class="number">68</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3710</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序后索引即可对数据框排序</span></span><br><span class="line">sort<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">10.4</span> <span class="number">10.4</span> <span class="number">13.3</span> <span class="number">14.3</span> <span class="number">14.7</span> <span class="number">15.0</span> <span class="number">15.2</span> <span class="number">15.2</span> <span class="number">15.5</span> <span class="number">15.8</span> <span class="number">16.4</span> <span class="number">17.3</span> <span class="number">17.8</span> <span class="number">18.1</span> <span class="number">18.7</span> <span class="number">19.2</span> <span class="number">19.2</span> <span class="number">19.7</span> <span class="number">21.0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">20</span><span class="punctuation">]</span> <span class="number">21.0</span> <span class="number">21.4</span> <span class="number">21.4</span> <span class="number">21.5</span> <span class="number">22.8</span> <span class="number">22.8</span> <span class="number">24.4</span> <span class="number">26.0</span> <span class="number">27.3</span> <span class="number">30.4</span> <span class="number">30.4</span> <span class="number">32.4</span> <span class="number">33.9</span></span><br><span class="line">order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">15</span> <span class="number">16</span> <span class="number">24</span>  <span class="number">7</span> <span class="number">17</span> <span class="number">31</span> <span class="number">14</span> <span class="number">23</span> <span class="number">22</span> <span class="number">29</span> <span class="number">12</span> <span class="number">13</span> <span class="number">11</span>  <span class="number">6</span>  <span class="number">5</span> <span class="number">10</span> <span class="number">25</span> <span class="number">30</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">4</span> <span class="number">32</span> <span class="number">21</span>  <span class="number">3</span>  <span class="number">9</span>  <span class="number">8</span> <span class="number">27</span> <span class="number">26</span> <span class="number">19</span> <span class="number">28</span> <span class="number">18</span> <span class="number">20</span></span><br><span class="line">mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">#  可以多个排序条件</span></span><br><span class="line">mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span> mtcars<span class="operator">$</span>disp<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Duster <span class="number">360</span>          <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">...</span><br><span class="line">order<span class="punctuation">(</span><span class="operator">-</span>rivers<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">68</span>  <span class="number">70</span>  <span class="number">66</span>  <span class="number">69</span> <span class="number">101</span> <span class="number">141</span>   <span class="number">7</span>  <span class="number">23</span>  <span class="number">83</span>  <span class="number">98</span>  <span class="number">25</span> <span class="number">115</span>  <span class="number">67</span> <span class="number">114</span>  <span class="number">89</span> <span class="number">121</span>  <span class="number">20</span>  <span class="number">82</span>  <span class="number">16</span>  <span class="number">63</span> <span class="number">131</span>  <span class="number">26</span>  <span class="number">15</span>  <span class="number">38</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>  <span class="number">24</span> <span class="number">109</span>  <span class="number">71</span>  <span class="number">79</span>   <span class="number">1</span>  <span class="number">90</span>  <span class="number">44</span>  <span class="number">32</span> <span class="number">137</span>  <span class="number">50</span>  <span class="number">85</span>  <span class="number">58</span> <span class="number">140</span> <span class="number">130</span>  <span class="number">40</span>  <span class="number">64</span> <span class="number">128</span>  <span class="number">80</span> <span class="number">118</span>  <span class="number">86</span>  <span class="number">10</span>  <span class="number">21</span>  <span class="number">45</span>  <span class="number">59</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">62</span>  <span class="number">99</span> <span class="number">120</span> <span class="number">113</span> <span class="number">135</span>  <span class="number">31</span> <span class="number">132</span>   <span class="number">5</span>  <span class="number">22</span>  <span class="number">84</span> <span class="number">136</span>  <span class="number">93</span>  <span class="number">57</span>   <span class="number">9</span>  <span class="number">74</span>  <span class="number">95</span>   <span class="number">6</span> <span class="number">100</span> <span class="number">125</span>  <span class="number">92</span>  <span class="number">77</span> <span class="number">139</span> <span class="number">106</span> <span class="number">122</span></span><br></pre></td></tr></table></figure><h4 id="数据框内数据计算">数据框内数据计算</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">wp <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>WorldPhones<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>wp<span class="punctuation">)</span></span><br><span class="line">     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer</span><br><span class="line"><span class="number">1951</span>  <span class="number">45939</span>  <span class="number">21574</span> <span class="number">2876</span>   <span class="number">1815</span>    <span class="number">1646</span>     <span class="number">89</span>      <span class="number">555</span></span><br><span class="line"><span class="number">1956</span>  <span class="number">60423</span>  <span class="number">29990</span> <span class="number">4708</span>   <span class="number">2568</span>    <span class="number">2366</span>   <span class="number">1411</span>      <span class="number">733</span></span><br><span class="line"><span class="number">1957</span>  <span class="number">64721</span>  <span class="number">32510</span> <span class="number">5230</span>   <span class="number">2695</span>    <span class="number">2526</span>   <span class="number">1546</span>      <span class="number">773</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每行列的和及平均值</span></span><br><span class="line">rowSums<span class="punctuation">(</span>wp<span class="punctuation">)</span></span><br><span class="line">  <span class="number">1951</span>   <span class="number">1956</span>   <span class="number">1957</span>   <span class="number">1958</span>   <span class="number">1959</span>   <span class="number">1960</span>   <span class="number">1961</span> </span><br><span class="line"> <span class="number">74494</span> <span class="number">102199</span> <span class="number">110001</span> <span class="number">118399</span> <span class="number">124801</span> <span class="number">133709</span> <span class="number">141700</span> </span><br><span class="line">colMeans<span class="punctuation">(</span>wp<span class="punctuation">)</span></span><br><span class="line">    N.Amer     Europe       Asia     S.Amer    Oceania     Africa   Mid.Amer </span><br><span class="line"><span class="number">66747.5714</span> <span class="number">34343.4286</span>  <span class="number">6229.2857</span>  <span class="number">2772.2857</span>  <span class="number">2625.0000</span>  <span class="number">1484.0000</span>   <span class="number">841.7143</span> </span><br><span class="line">cbind<span class="punctuation">(</span>wp<span class="punctuation">,</span> Total<span class="operator">=</span>rowSums<span class="punctuation">(</span>wp<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer  Total</span><br><span class="line"><span class="number">1951</span>  <span class="number">45939</span>  <span class="number">21574</span> <span class="number">2876</span>   <span class="number">1815</span>    <span class="number">1646</span>     <span class="number">89</span>      <span class="number">555</span>  <span class="number">74494</span></span><br><span class="line"><span class="number">1956</span>  <span class="number">60423</span>  <span class="number">29990</span> <span class="number">4708</span>   <span class="number">2568</span>    <span class="number">2366</span>   <span class="number">1411</span>      <span class="number">733</span> <span class="number">102199</span></span><br><span class="line"><span class="number">1957</span>  <span class="number">64721</span>  <span class="number">32510</span> <span class="number">5230</span>   <span class="number">2695</span>    <span class="number">2526</span>   <span class="number">1546</span>      <span class="number">773</span> <span class="number">110001</span></span><br><span class="line">...</span><br><span class="line">new <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>wp<span class="punctuation">,</span> Total<span class="operator">=</span>rowSums<span class="punctuation">(</span>wp<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">rbind<span class="punctuation">(</span>new<span class="punctuation">,</span> Mean<span class="operator">=</span>colMeans<span class="punctuation">(</span>new<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">       N.Amer   Europe     Asia   S.Amer Oceania Africa  Mid.Amer    Total</span><br><span class="line"><span class="number">1951</span> <span class="number">45939.00</span> <span class="number">21574.00</span> <span class="number">2876.000</span> <span class="number">1815.000</span>    <span class="number">1646</span>     <span class="number">89</span>  <span class="number">555.0000</span>  <span class="number">74494.0</span></span><br><span class="line"><span class="number">1956</span> <span class="number">60423.00</span> <span class="number">29990.00</span> <span class="number">4708.000</span> <span class="number">2568.000</span>    <span class="number">2366</span>   <span class="number">1411</span>  <span class="number">733.0000</span> <span class="number">102199.0</span></span><br><span class="line"><span class="number">1957</span> <span class="number">64721.00</span> <span class="number">32510.00</span> <span class="number">5230.000</span> <span class="number">2695.000</span>    <span class="number">2526</span>   <span class="number">1546</span>  <span class="number">773.0000</span> <span class="number">110001.0</span></span><br><span class="line"><span class="number">1958</span> <span class="number">68484.00</span> <span class="number">35218.00</span> <span class="number">6662.000</span> <span class="number">2845.000</span>    <span class="number">2691</span>   <span class="number">1663</span>  <span class="number">836.0000</span> <span class="number">118399.0</span></span><br><span class="line"><span class="number">1959</span> <span class="number">71799.00</span> <span class="number">37598.00</span> <span class="number">6856.000</span> <span class="number">3000.000</span>    <span class="number">2868</span>   <span class="number">1769</span>  <span class="number">911.0000</span> <span class="number">124801.0</span></span><br><span class="line"><span class="number">1960</span> <span class="number">76036.00</span> <span class="number">40341.00</span> <span class="number">8220.000</span> <span class="number">3145.000</span>    <span class="number">3054</span>   <span class="number">1905</span> <span class="number">1008.0000</span> <span class="number">133709.0</span></span><br><span class="line"><span class="number">1961</span> <span class="number">79831.00</span> <span class="number">43173.00</span> <span class="number">9053.000</span> <span class="number">3338.000</span>    <span class="number">3224</span>   <span class="number">2005</span> <span class="number">1076.0000</span> <span class="number">141700.0</span></span><br><span class="line">Mean <span class="number">66747.57</span> <span class="number">34343.43</span> <span class="number">6229.286</span> <span class="number">2772.286</span>    <span class="number">2625</span>   <span class="number">1484</span>  <span class="number">841.7143</span> <span class="number">115043.3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将一个FUN应用给数据框，包括自己编写的函数</span></span><br><span class="line">apply<span class="punctuation">(</span>wp<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line">  <span class="number">1951</span>   <span class="number">1956</span>   <span class="number">1957</span>   <span class="number">1958</span>   <span class="number">1959</span>   <span class="number">1960</span>   <span class="number">1961</span> </span><br><span class="line"> <span class="number">74494</span> <span class="number">102199</span> <span class="number">110001</span> <span class="number">118399</span> <span class="number">124801</span> <span class="number">133709</span> <span class="number">141700</span> </span><br><span class="line">apply<span class="punctuation">(</span>wp<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line">  N.Amer   Europe     Asia   S.Amer  Oceania   Africa Mid.Amer </span><br><span class="line">  <span class="number">467233</span>   <span class="number">240404</span>    <span class="number">43605</span>    <span class="number">19406</span>    <span class="number">18375</span>    <span class="number">10388</span>     <span class="number">5892</span> </span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>apply<span class="punctuation">(</span>wp<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="built_in">sum</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;numeric&quot;</span></span><br><span class="line">apply<span class="punctuation">(</span>wp<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> sd<span class="punctuation">)</span></span><br><span class="line">    <span class="number">1951</span>     <span class="number">1956</span>     <span class="number">1957</span>     <span class="number">1958</span>     <span class="number">1959</span>     <span class="number">1960</span>     <span class="number">1961</span> </span><br><span class="line"><span class="number">17309.22</span> <span class="number">22712.46</span> <span class="number">24362.16</span> <span class="number">25790.60</span> <span class="number">27116.58</span> <span class="number">28712.04</span> <span class="number">30213.56</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 对列表操作，返回列表</span></span><br><span class="line">lapply<span class="punctuation">(</span>state.center<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>y</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line"><span class="comment"># 对列表操作，返回向量</span></span><br><span class="line">sapply<span class="punctuation">(</span>state.center<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">)</span></span><br><span class="line"> x  y </span><br><span class="line"><span class="number">50</span> <span class="number">50</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二个参数为因子</span></span><br><span class="line">tapply<span class="punctuation">(</span>state.name<span class="punctuation">,</span> state.division<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">)</span></span><br><span class="line">       New England    Middle Atlantic     South Atlantic East South Central West South Central </span><br><span class="line">                 <span class="number">6</span>                  <span class="number">3</span>                  <span class="number">8</span>                  <span class="number">4</span>                  <span class="number">4</span> </span><br><span class="line">East North Central West North Central           Mountain            Pacific </span><br><span class="line">                 <span class="number">5</span>                  <span class="number">7</span>                  <span class="number">8</span>                  <span class="number">5</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据中心化，各数据减去均值</span></span><br><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">x<span class="operator">-</span>mean<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">2</span> <span class="operator">-</span><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据标准化，减去均值后再除以标准差</span></span><br><span class="line">sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.581139</span></span><br><span class="line"><span class="punctuation">(</span>x<span class="operator">-</span>mean<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span>sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">1.2649111</span> <span class="operator">-</span><span class="number">0.6324555</span>  <span class="number">0.0000000</span>  <span class="number">0.6324555</span>  <span class="number">1.2649111</span></span><br><span class="line"></span><br><span class="line">scale<span class="punctuation">(</span>x<span class="punctuation">,</span> center <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">     <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="operator">-</span><span class="number">2</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span>   <span class="operator">-</span><span class="number">1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">0</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>    <span class="number">2</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;scaled:center&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span></span><br><span class="line">scale<span class="punctuation">(</span>x<span class="punctuation">,</span> center <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">           <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">1.2649111</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="operator">-</span><span class="number">0.6324555</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">0.0000000</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">0.6324555</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="number">1.2649111</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;scaled:center&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3</span></span><br><span class="line"><span class="built_in">attr</span><span class="punctuation">(</span><span class="punctuation">,</span><span class="string">&quot;scaled:scale&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.581139</span></span><br><span class="line"></span><br><span class="line">heatmap<span class="punctuation">(</span>scale<span class="punctuation">(</span>state.x77<span class="punctuation">,</span> <span class="built_in">T</span><span class="punctuation">,</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="reshape2包应用"><code>reshape2</code>包应用</h4><h4 id="tidyr包应用"><code>tidyr</code>包应用</h4><p>作用：整理数据，合并数据，长宽数据互转</p><p><code>gather()</code>：宽数据→长数据（建议使用更新的<code>pivot_longer()</code>和<code>pivot_wider()</code>）</p><p><code>spread()</code>：长数据→宽数据</p><p><code>unite()</code>：多列合并为一列</p><p><code>seperate()</code>：一列拆分为多列</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># gather()</span></span><br><span class="line">td <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line">td</span><br><span class="line">                   mpg cyl  disp</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">td <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>car<span class="operator">=</span>rownames<span class="punctuation">(</span>td<span class="punctuation">)</span><span class="punctuation">,</span>td<span class="punctuation">)</span></span><br><span class="line">td</span><br><span class="line">                                car  mpg cyl  disp</span><br><span class="line">Mazda RX4                 Mazda RX4 <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line">Mazda RX4 Wag         Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span></span><br><span class="line"></span><br><span class="line">gather<span class="punctuation">(</span>td<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">,</span> mpg<span class="punctuation">,</span> cyl<span class="punctuation">,</span> disp<span class="punctuation">)</span></span><br><span class="line">            car Type Value</span><br><span class="line"><span class="number">1</span>     Mazda RX4  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">4</span> Mazda RX4 Wag  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">5</span>     Mazda RX4 disp   <span class="number">160</span></span><br><span class="line"><span class="number">6</span> Mazda RX4 Wag disp   <span class="number">160</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择转换的不同方法</span></span><br><span class="line">gather<span class="punctuation">(</span>td<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">,</span> mpg<span class="operator">:</span>disp<span class="punctuation">)</span></span><br><span class="line">            car Type Value</span><br><span class="line"><span class="number">1</span>     Mazda RX4  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">4</span> Mazda RX4 Wag  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">5</span>     Mazda RX4 disp   <span class="number">160</span></span><br><span class="line"><span class="number">6</span> Mazda RX4 Wag disp   <span class="number">160</span></span><br><span class="line"></span><br><span class="line">gather<span class="punctuation">(</span>td<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">,</span> mpg<span class="operator">:</span>disp<span class="punctuation">,</span> <span class="operator">-</span>cyl<span class="punctuation">)</span></span><br><span class="line">            car cyl Type Value</span><br><span class="line"><span class="number">1</span>     Mazda RX4   <span class="number">6</span>  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag   <span class="number">6</span>  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4   <span class="number">6</span> disp   <span class="number">160</span></span><br><span class="line"><span class="number">4</span> Mazda RX4 Wag   <span class="number">6</span> disp   <span class="number">160</span></span><br><span class="line"></span><br><span class="line">gather<span class="punctuation">(</span>td<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">,</span> <span class="number">3</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">            car mpg Type Value</span><br><span class="line"><span class="number">1</span>     Mazda RX4  <span class="number">21</span>  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag  <span class="number">21</span>  cyl     <span class="number">6</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4  <span class="number">21</span> disp   <span class="number">160</span></span><br><span class="line"><span class="number">4</span> Mazda RX4 Wag  <span class="number">21</span> disp   <span class="number">160</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># spread()</span></span><br><span class="line">gtd <span class="operator">&lt;-</span> gather<span class="punctuation">(</span>td<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">,</span> mpg<span class="operator">:</span>disp<span class="punctuation">,</span> <span class="operator">-</span>cyl<span class="punctuation">)</span></span><br><span class="line">gtd</span><br><span class="line">            car cyl Type Value</span><br><span class="line"><span class="number">1</span>     Mazda RX4   <span class="number">6</span>  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag   <span class="number">6</span>  mpg    <span class="number">21</span></span><br><span class="line"><span class="number">3</span>     Mazda RX4   <span class="number">6</span> disp   <span class="number">160</span></span><br><span class="line"><span class="number">4</span> Mazda RX4 Wag   <span class="number">6</span> disp   <span class="number">160</span></span><br><span class="line">spread<span class="punctuation">(</span>gtd<span class="punctuation">,</span> key <span class="operator">=</span> <span class="string">&#x27;Type&#x27;</span><span class="punctuation">,</span> value <span class="operator">=</span> <span class="string">&#x27;Value&#x27;</span><span class="punctuation">)</span></span><br><span class="line">            car cyl disp mpg</span><br><span class="line"><span class="number">1</span>     Mazda RX4   <span class="number">6</span>  <span class="number">160</span>  <span class="number">21</span></span><br><span class="line"><span class="number">2</span> Mazda RX4 Wag   <span class="number">6</span>  <span class="number">160</span>  <span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># separate()</span></span><br><span class="line">x</span><br><span class="line">     X</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1</span><span class="operator">-</span><span class="number">2</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2</span><span class="operator">-</span><span class="number">3</span></span><br><span class="line"><span class="number">4</span>  <span class="number">3</span><span class="operator">-</span><span class="number">4</span></span><br><span class="line"></span><br><span class="line">separate<span class="punctuation">(</span>x<span class="punctuation">,</span> col <span class="operator">=</span> X<span class="punctuation">,</span> into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;B&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">separate<span class="punctuation">(</span>x<span class="punctuation">,</span> col <span class="operator">=</span> X<span class="punctuation">,</span> into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;B&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span></span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># unite()</span></span><br><span class="line">x</span><br><span class="line">     A    B</span><br><span class="line"><span class="number">1</span> <span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&lt;</span><span class="literal">NA</span><span class="operator">&gt;</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">4</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line">unite<span class="punctuation">(</span>x<span class="punctuation">,</span> col<span class="operator">=</span>X<span class="punctuation">)</span></span><br><span class="line">      X</span><br><span class="line"><span class="number">1</span> NA_NA</span><br><span class="line"><span class="number">2</span>   <span class="number">1</span>_2</span><br><span class="line"><span class="number">3</span>   <span class="number">2</span>_3</span><br><span class="line"><span class="number">4</span>   <span class="number">3</span>_4</span><br><span class="line">unite<span class="punctuation">(</span>x<span class="punctuation">,</span> col<span class="operator">=</span>X<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span></span><br><span class="line">      X</span><br><span class="line"><span class="number">1</span> <span class="literal">NA</span><span class="operator">-</span><span class="literal">NA</span></span><br><span class="line"><span class="number">2</span>   <span class="number">1</span><span class="operator">-</span><span class="number">2</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2</span><span class="operator">-</span><span class="number">3</span></span><br><span class="line"><span class="number">4</span>   <span class="number">3</span><span class="operator">-</span><span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pivot_longer() 宽数据转换为长数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="dplyr包应用"><code>dplyr</code>包应用</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># filter()过滤</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mpg<span class="operator">&gt;</span><span class="number">30</span><span class="punctuation">)</span></span><br><span class="line">                mpg cyl disp  hp drat    wt  qsec vs am gear carb          model</span><br><span class="line">Fiat <span class="number">128</span>       <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>       Fiat <span class="number">128</span></span><br><span class="line">Honda Civic    <span class="number">30.4</span>   <span class="number">4</span> <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span>    Honda Civic</span><br><span class="line">Toyota Corolla <span class="number">33.9</span>   <span class="number">4</span> <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span> Toyota Corolla</span><br><span class="line">Lotus Europa   <span class="number">30.4</span>   <span class="number">4</span> <span class="number">95.1</span> <span class="number">113</span> <span class="number">3.77</span> <span class="number">1.513</span> <span class="number">16.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span>   Lotus Europa</span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mpg<span class="operator">&gt;</span><span class="number">30</span> <span class="operator">&amp;</span> wt<span class="operator">&gt;</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">          mpg cyl disp hp drat  wt  qsec vs am gear carb    model</span><br><span class="line">Fiat <span class="number">128</span> <span class="number">32.4</span>   <span class="number">4</span> <span class="number">78.7</span> <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.2</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span> Fiat <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># distinct()去除重复</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>distinct<span class="punctuation">(</span>rbind<span class="punctuation">(</span>mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span> mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">               mpg cyl disp  hp drat    wt  qsec vs am gear carb         model</span><br><span class="line">Mazda RX4     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4</span><br><span class="line">Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>    <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>    Datsun <span class="number">710</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># slice()切片</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>slice<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">               mpg cyl disp  hp drat    wt  qsec vs am gear carb         model</span><br><span class="line">Mazda RX4     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span>     Mazda RX4</span><br><span class="line">Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> Mazda RX4 Wag</span><br><span class="line">Datsun <span class="number">710</span>    <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>    Datsun <span class="number">710</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sample_n()抽样，sample_frac()按比例抽样</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>sample_n<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">               mpg cyl  disp  hp drat    wt  qsec vs am gear carb         model</span><br><span class="line">Porsche <span class="number">914</span><span class="operator">-</span><span class="number">2</span> <span class="number">26.0</span>   <span class="number">4</span> <span class="number">120.3</span>  <span class="number">91</span> <span class="number">4.43</span> <span class="number">2.140</span> <span class="number">16.70</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">2</span> Porsche <span class="number">914</span><span class="operator">-</span><span class="number">2</span></span><br><span class="line">Fiat <span class="number">128</span>      <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>      Fiat <span class="number">128</span></span><br><span class="line">Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> Mazda RX4 Wag</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">length</span><span class="punctuation">(</span>row.names<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">32</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>sample_frac<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span></span><br><span class="line">              mpg cyl  disp  hp drat    wt qsec vs am gear carb        model</span><br><span class="line">Ferrari Dino <span class="number">19.7</span>   <span class="number">6</span> <span class="number">145.0</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.770</span> <span class="number">15.5</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">5</span>    <span class="number">6</span> Ferrari Dino</span><br><span class="line">AMC Javelin  <span class="number">15.2</span>   <span class="number">8</span> <span class="number">304.0</span> <span class="number">150</span> <span class="number">3.15</span> <span class="number">3.435</span> <span class="number">17.3</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span>  AMC Javelin</span><br><span class="line">Merc <span class="number">450</span>SE   <span class="number">16.4</span>   <span class="number">8</span> <span class="number">275.8</span> <span class="number">180</span> <span class="number">3.07</span> <span class="number">4.070</span> <span class="number">17.4</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">3</span>   Merc <span class="number">450</span>SE</span><br><span class="line"></span><br><span class="line"><span class="comment"># arrange()排序</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>arrange<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mpg<span class="punctuation">)</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb               model</span><br><span class="line">Cadillac Fleetwood  <span class="number">10.4</span>   <span class="number">8</span> <span class="number">472.0</span> <span class="number">205</span> <span class="number">2.93</span> <span class="number">5.250</span> <span class="number">17.98</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span>  Cadillac Fleetwood</span><br><span class="line">Lincoln Continental <span class="number">10.4</span>   <span class="number">8</span> <span class="number">460.0</span> <span class="number">215</span> <span class="number">3.00</span> <span class="number">5.424</span> <span class="number">17.82</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span> Lincoln Continental</span><br><span class="line">Camaro Z28          <span class="number">13.3</span>   <span class="number">8</span> <span class="number">350.0</span> <span class="number">245</span> <span class="number">3.73</span> <span class="number">3.840</span> <span class="number">15.41</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span>          Camaro Z28</span><br><span class="line">...</span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>arrange<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="operator">-</span>mpg<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>arrange<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> desc<span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb               model</span><br><span class="line">Toyota Corolla      <span class="number">33.9</span>   <span class="number">4</span>  <span class="number">71.1</span>  <span class="number">65</span> <span class="number">4.22</span> <span class="number">1.835</span> <span class="number">19.90</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>      Toyota Corolla</span><br><span class="line">Fiat <span class="number">128</span>            <span class="number">32.4</span>   <span class="number">4</span>  <span class="number">78.7</span>  <span class="number">66</span> <span class="number">4.08</span> <span class="number">2.200</span> <span class="number">19.47</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span>            Fiat <span class="number">128</span></span><br><span class="line">Honda Civic         <span class="number">30.4</span>   <span class="number">4</span>  <span class="number">75.7</span>  <span class="number">52</span> <span class="number">4.93</span> <span class="number">1.615</span> <span class="number">18.52</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">2</span>         Honda Civic</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># select()数据框取子集</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># summarise()描述性统计，还有summarise_all(), summarise_at(), summarise_each()等</span></span><br><span class="line"><span class="operator">&gt;</span> summarise<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> avg<span class="operator">=</span>mean<span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">       avg</span><br><span class="line"><span class="number">1</span> <span class="number">20.09062</span></span><br><span class="line"><span class="operator">&gt;</span> summarise<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> avg<span class="operator">=</span>mean<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">     avg</span><br><span class="line"><span class="number">1</span> <span class="number">6.1875</span></span><br><span class="line"><span class="operator">&gt;</span> summarise<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="built_in">sum</span><span class="operator">=</span><span class="built_in">sum</span><span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    <span class="built_in">sum</span></span><br><span class="line"><span class="number">1</span> <span class="number">642.9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># % &gt; %链式操作符，管道符，前一个运算结果作为后一个的输入</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span><span class="built_in">sum</span><span class="operator">=</span><span class="built_in">sum</span><span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    <span class="built_in">sum</span></span><br><span class="line"><span class="number">1</span> <span class="number">642.9</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> tail<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">           mpg cyl  disp  hp drat   wt qsec vs am gear carb</span><br><span class="line">Merc <span class="number">240</span>D <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.19</span> <span class="number">20.0</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">230</span>  <span class="number">22.8</span>   <span class="number">4</span> <span class="number">140.8</span>  <span class="number">95</span> <span class="number">3.92</span> <span class="number">3.15</span> <span class="number">22.9</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line">Merc <span class="number">280</span>  <span class="number">19.2</span>   <span class="number">6</span> <span class="number">167.6</span> <span class="number">123</span> <span class="number">3.92</span> <span class="number">3.44</span> <span class="number">18.3</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># group_by()分组</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> cyl<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 32 x 11</span></span><br><span class="line"><span class="comment"># Groups:   cyl [3]</span></span><br><span class="line">     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span><br><span class="line">   <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"> <span class="number">1</span>  <span class="number">21</span>       <span class="number">6</span>  <span class="number">160</span>    <span class="number">110</span>  <span class="number">3.9</span>   <span class="number">2.62</span>  <span class="number">16.5</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">4</span>     <span class="number">4</span></span><br><span class="line"> <span class="number">2</span>  <span class="number">21</span>       <span class="number">6</span>  <span class="number">160</span>    <span class="number">110</span>  <span class="number">3.9</span>   <span class="number">2.88</span>  <span class="number">17.0</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">4</span>     <span class="number">4</span></span><br><span class="line"> <span class="number">3</span>  <span class="number">22.8</span>     <span class="number">4</span>  <span class="number">108</span>     <span class="number">93</span>  <span class="number">3.85</span>  <span class="number">2.32</span>  <span class="number">18.6</span>     <span class="number">1</span>     <span class="number">1</span>     <span class="number">4</span>     <span class="number">1</span></span><br><span class="line"> <span class="number">4</span>  <span class="number">21.4</span>     <span class="number">6</span>  <span class="number">258</span>    <span class="number">110</span>  <span class="number">3.08</span>  <span class="number">3.22</span>  <span class="number">19.4</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">3</span>     <span class="number">1</span></span><br><span class="line"> <span class="number">5</span>  <span class="number">18.7</span>     <span class="number">8</span>  <span class="number">360</span>    <span class="number">175</span>  <span class="number">3.15</span>  <span class="number">3.44</span>  <span class="number">17.0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">3</span>     <span class="number">2</span></span><br><span class="line"> <span class="number">6</span>  <span class="number">18.1</span>     <span class="number">6</span>  <span class="number">225</span>    <span class="number">105</span>  <span class="number">2.76</span>  <span class="number">3.46</span>  <span class="number">20.2</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">3</span>     <span class="number">1</span></span><br><span class="line"> <span class="number">7</span>  <span class="number">14.3</span>     <span class="number">8</span>  <span class="number">360</span>    <span class="number">245</span>  <span class="number">3.21</span>  <span class="number">3.57</span>  <span class="number">15.8</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">3</span>     <span class="number">4</span></span><br><span class="line"> <span class="number">8</span>  <span class="number">24.4</span>     <span class="number">4</span>  <span class="number">147.</span>    <span class="number">62</span>  <span class="number">3.69</span>  <span class="number">3.19</span>  <span class="number">20</span>       <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">2</span></span><br><span class="line"> <span class="number">9</span>  <span class="number">22.8</span>     <span class="number">4</span>  <span class="number">141.</span>    <span class="number">95</span>  <span class="number">3.92</span>  <span class="number">3.15</span>  <span class="number">22.9</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">2</span></span><br><span class="line"><span class="number">10</span>  <span class="number">19.2</span>     <span class="number">6</span>  <span class="number">168.</span>   <span class="number">123</span>  <span class="number">3.92</span>  <span class="number">3.44</span>  <span class="number">18.3</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">4</span>     <span class="number">4</span></span><br><span class="line"><span class="comment"># ... with 22 more rows</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> cyl<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 3 x 1</span></span><br><span class="line">    cyl</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">2</span>     <span class="number">6</span></span><br><span class="line"><span class="number">3</span>     <span class="number">8</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> cyl<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span>ave<span class="operator">=</span>mean<span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 3 x 2</span></span><br><span class="line">    cyl   ave</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span>     <span class="number">4</span>  <span class="number">26.7</span></span><br><span class="line"><span class="number">2</span>     <span class="number">6</span>  <span class="number">19.7</span></span><br><span class="line"><span class="number">3</span>     <span class="number">8</span>  <span class="number">15.1</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> cyl<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span>ave<span class="operator">=</span>mean<span class="punctuation">(</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> arrange<span class="punctuation">(</span>ave<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 3 x 2</span></span><br><span class="line">    cyl   ave</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span>     <span class="number">8</span>  <span class="number">15.1</span></span><br><span class="line"><span class="number">2</span>     <span class="number">6</span>  <span class="number">19.7</span></span><br><span class="line"><span class="number">3</span>     <span class="number">4</span>  <span class="number">26.7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mutate()加入新变量</span></span><br><span class="line"><span class="operator">&gt;</span> mt <span class="operator">&lt;-</span> mutate<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> new <span class="operator">=</span> mpg<span class="operator">+</span>disp<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mt<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">               mpg cyl disp  hp drat    wt  qsec vs am gear carb   new</span><br><span class="line">Mazda RX4     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> <span class="number">181.0</span></span><br><span class="line">Mazda RX4 Wag <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span> <span class="number">181.0</span></span><br><span class="line">Datsun <span class="number">710</span>    <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span> <span class="number">130.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整合x, y两个表格，类似于集合的操作</span></span><br><span class="line"><span class="operator">&gt;</span> a</span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span></span><br><span class="line"><span class="operator">&gt;</span> b</span><br><span class="line">  x1    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  D  <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 左右链接，以某列为标准</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>left_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span>    <span class="literal">NA</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>right_join<span class="punctuation">(</span>a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="string">&#x27;x1&#x27;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  D <span class="literal">NA</span>  <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 内链接取x1交集，外链接取全集</span></span><br><span class="line"><span class="operator">&gt;</span> inner_join<span class="punctuation">(</span>a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="string">&#x27;x1&#x27;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>full_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2    x3</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span>  <span class="literal">TRUE</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span> <span class="literal">FALSE</span></span><br><span class="line"><span class="number">3</span>  C  <span class="number">3</span>    <span class="literal">NA</span></span><br><span class="line"><span class="number">4</span>  D <span class="literal">NA</span>  <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 半链接取交集，反链接取补集</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>semi_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  A  <span class="number">1</span></span><br><span class="line"><span class="number">2</span>  B  <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> dplyr<span class="operator">::</span>anti_join<span class="punctuation">(</span>a<span class="punctuation">,</span>b<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&quot;x1&quot;</span><span class="punctuation">)</span></span><br><span class="line">  x1 x2</span><br><span class="line"><span class="number">1</span>  C  <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据框交集、补集、并集操作</span></span><br><span class="line"><span class="operator">&gt;</span> car1</span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="operator">&gt;</span> car2</span><br><span class="line">                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>        <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D         <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取交集</span></span><br><span class="line"><span class="operator">&gt;</span> intersect<span class="punctuation">(</span>car1<span class="punctuation">,</span> car2<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取并集，不包括重复项</span></span><br><span class="line"><span class="operator">&gt;</span> union<span class="punctuation">(</span>car1<span class="punctuation">,</span> car2<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>        <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D         <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取并集，包括重复项</span></span><br><span class="line"><span class="operator">&gt;</span> union_all<span class="punctuation">(</span>car1<span class="punctuation">,</span> car2<span class="punctuation">)</span></span><br><span class="line">                       mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4             <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag         <span class="number">21.0</span>   <span class="number">6</span> <span class="number">160.0</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710.</span>..3        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive...4    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout...5 <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Datsun <span class="number">710.</span>..6        <span class="number">22.8</span>   <span class="number">4</span> <span class="number">108.0</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive...7    <span class="number">21.4</span>   <span class="number">6</span> <span class="number">258.0</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout...8 <span class="number">18.7</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant               <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span>            <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.570</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D             <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.190</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取car1补集</span></span><br><span class="line"><span class="operator">&gt;</span> setdiff<span class="punctuation">(</span>car1<span class="punctuation">,</span> car2<span class="punctuation">)</span></span><br><span class="line">              mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4      <span class="number">21</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag  <span class="number">21</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span>  <span class="number">3.9</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="comment"># 取car2补集</span></span><br><span class="line"><span class="operator">&gt;</span> setdiff<span class="punctuation">(</span>car2<span class="punctuation">,</span> car1<span class="punctuation">)</span></span><br><span class="line">            mpg cyl  disp  hp drat   wt  qsec vs am gear carb</span><br><span class="line">Valiant    <span class="number">18.1</span>   <span class="number">6</span> <span class="number">225.0</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.46</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Duster <span class="number">360</span> <span class="number">14.3</span>   <span class="number">8</span> <span class="number">360.0</span> <span class="number">245</span> <span class="number">3.21</span> <span class="number">3.57</span> <span class="number">15.84</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">Merc <span class="number">240</span>D  <span class="number">24.4</span>   <span class="number">4</span> <span class="number">146.7</span>  <span class="number">62</span> <span class="number">3.69</span> <span class="number">3.19</span> <span class="number">20.00</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">4</span>    <span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="R函数">R函数</h2><h3 id="函数的选项参数">函数的选项参数</h3><p>函数选项类型</p><ol><li>输入控制</li><li>输出控制</li><li>调节</li></ol><h3 id="数学统计函数">数学统计函数</h3><p><code>d</code>概率密度函数</p><p><code>p</code>分布函数</p><p><code>q</code>分布函数的反函数</p><p><code>r</code>随机数函数</p><p>如正态分布函数norm()加上这4个前缀：</p><p><code>dnorm(), pnorm(), qnorm(), rnorm()</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成10个符合正态分布的随机数</span></span><br><span class="line"><span class="operator">&gt;</span> rnorm<span class="punctuation">(</span>n<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span> mean<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> sd<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6.329543</span> <span class="number">4.232249</span> <span class="number">6.033233</span> <span class="number">4.837938</span> <span class="number">3.984797</span> <span class="number">5.299808</span> <span class="number">5.202550</span> <span class="number">2.070615</span> <span class="number">5.830317</span> <span class="number">5.936402</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>rnorm<span class="punctuation">(</span>n<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span> mean<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> sd<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">4</span> <span class="number">5</span> <span class="number">5</span> <span class="number">5</span> <span class="number">4</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># runif()生成随机数</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.04366431</span> <span class="number">0.34873894</span> <span class="number">0.29974298</span> <span class="number">0.39224632</span> <span class="number">0.08980883</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.83081773</span> <span class="number">2.22285093</span> <span class="number">0.07499167</span> <span class="number">4.59838033</span> <span class="number">6.37444314</span></span><br><span class="line"><span class="operator">&gt;</span> runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">4.5102458</span> <span class="number">0.3494494</span> <span class="number">9.4862655</span> <span class="number">4.6722139</span> <span class="number">0.5983668</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">8</span>  <span class="number">6</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 固定生成的随机数</span></span><br><span class="line"><span class="operator">&gt;</span> set.seed<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">7</span> <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">6</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">7</span> <span class="number">6</span> <span class="number">1</span> <span class="number">6</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> set.seed<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">round</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="built_in">min</span><span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">5</span> <span class="number">3</span> <span class="number">4</span> <span class="number">7</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="描述性统计函数">描述性统计函数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="频数统计函数">频数统计函数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># table()直接统计频数</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span> </span><br><span class="line"><span class="number">11</span>  <span class="number">7</span> <span class="number">14</span> </span><br><span class="line"><span class="comment"># prop.table()计算频率</span></span><br><span class="line"><span class="operator">&gt;</span> prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">      <span class="number">4</span>       <span class="number">6</span>       <span class="number">8</span> </span><br><span class="line"><span class="number">0.34375</span> <span class="number">0.21875</span> <span class="number">0.43750</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># split()将数据分组(list)</span></span><br><span class="line"><span class="operator">&gt;</span> split<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> mtcars<span class="operator">$</span>cyl<span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>`<span class="number">4</span>`</span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span><br><span class="line">Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span><br><span class="line"></span><br><span class="line">$`6`</span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span><br><span class="line">Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span><br><span class="line"></span><br><span class="line">$`8`</span><br><span class="line">                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2</span><br><span class="line">Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4</span><br><span class="line">&gt; split(mtcars, mtcars$cyl)[&#x27;4&#x27;]</span><br><span class="line">$`4`</span><br><span class="line">                mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span><br><span class="line">Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2</span><br><span class="line"></span><br><span class="line"># 计算连续值频数和频率</span><br><span class="line">&gt; range(mtcars$mpg)</span><br><span class="line">[1] 10.4 33.9</span><br><span class="line">&gt; seq(10, 40, 5)</span><br><span class="line">[1] 10 15 20 25 30 35 40</span><br><span class="line">&gt; cut(mtcars$mpg, seq(10, 35, 5))</span><br><span class="line"> [1] (20,25] (20,25] (20,25] (20,25] (15,20] (15,20] (10,15] (20,25] (20,25] (15,20] (15,20] (15,20]</span><br><span class="line">[13] (15,20] (15,20] (10,15] (10,15] (10,15] (30,35] (30,35] (30,35] (20,25] (15,20] (15,20] (10,15]</span><br><span class="line">[25] (15,20] (25,30] (25,30] (30,35] (15,20] (15,20] (10,15] (20,25]</span><br><span class="line">Levels: (10,15] (15,20] (20,25] (25,30] (30,35]</span><br><span class="line"></span><br><span class="line">&gt; table(cut(mtcars$mpg, seq(10, 35, 5)))</span><br><span class="line"></span><br><span class="line">(10,15] (15,20] (20,25] (25,30] (30,35] </span><br><span class="line">      6      12       8       2       4 </span><br><span class="line"></span><br><span class="line">&gt; prop.table(table(cut(mtcars$mpg, seq(10, 35, 5))))</span><br><span class="line"></span><br><span class="line">(10,15] (15,20] (20,25] (25,30] (30,35] </span><br><span class="line"> 0.1875  0.3750  0.2500  0.0625  0.1250 </span><br><span class="line"></span><br><span class="line"># 二维，talbe() xtabs()</span><br><span class="line">&gt; library(vcd) </span><br><span class="line">&gt; Arthritis</span><br><span class="line">   ID Treatment    Sex Age Improved</span><br><span class="line">1  57   Treated   Male  27     Some</span><br><span class="line">2  46   Treated   Male  29     None</span><br><span class="line">3  77   Treated   Male  30     None</span><br><span class="line">                                 </span><br><span class="line">&gt; table(Arthritis$Treatment, Arthritis$Improved)</span><br><span class="line">         </span><br><span class="line">          None Some Marked</span><br><span class="line">  Placebo   29    7      7</span><br><span class="line">  Treated   13    7     21</span><br><span class="line">                                 </span><br><span class="line">&gt; xtabs(~ Treatment + Improved, data = Arthritis)</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   29    7      7</span><br><span class="line">  Treated   13    7     21</span><br><span class="line"></span><br><span class="line">&gt; with(data = Arthritis, &#123;table(Treatment, Improved)&#125;)</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   29    7      7</span><br><span class="line">  Treated   13    7     21</span><br><span class="line"> </span><br><span class="line"># 边际频数及统计，1表示按行统计，2表示按列统计</span><br><span class="line"># margin.table() addmargins()</span><br><span class="line">&gt; x &lt;- xtabs(~ Treatment + Improved, data = Arthritis)</span><br><span class="line">&gt; margin.table(x)</span><br><span class="line">[1] 84</span><br><span class="line">&gt; margin.table(x, 1)</span><br><span class="line">Treatment</span><br><span class="line">Placebo Treated </span><br><span class="line">     43      41 </span><br><span class="line">&gt; margin.table(x, 2)</span><br><span class="line">Improved</span><br><span class="line">  None   Some Marked </span><br><span class="line">    42     14     28 </span><br><span class="line">                                 </span><br><span class="line">&gt; prop.table(x, 1)</span><br><span class="line">         Improved</span><br><span class="line">Treatment      None      Some    Marked</span><br><span class="line">  Placebo 0.6744186 0.1627907 0.1627907</span><br><span class="line">  Treated 0.3170732 0.1707317 0.5121951</span><br><span class="line">&gt; prop.table(x, 2)</span><br><span class="line">         Improved</span><br><span class="line">Treatment      None      Some    Marked</span><br><span class="line">  Placebo 0.6904762 0.5000000 0.2500000</span><br><span class="line">  Treated 0.3095238 0.5000000 0.7500000</span><br><span class="line">&gt; prop.table(x)</span><br><span class="line">         Improved</span><br><span class="line">Treatment       None       Some     Marked</span><br><span class="line">  Placebo 0.34523810 0.08333333 0.08333333</span><br><span class="line">  Treated 0.15476190 0.08333333 0.25000000</span><br><span class="line"></span><br><span class="line">&gt; addmargins(x)</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked Sum</span><br><span class="line">  Placebo   29    7      7  43</span><br><span class="line">  Treated   13    7     21  41</span><br><span class="line">  Sum       42   14     28  84</span><br><span class="line">&gt; addmargins(x, 1)</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   29    7      7</span><br><span class="line">  Treated   13    7     21</span><br><span class="line">  Sum       42   14     28</span><br><span class="line">&gt; addmargins(x, 2)</span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked Sum</span><br><span class="line">  Placebo   29    7      7  43</span><br><span class="line">  Treated   13    7     21  41</span><br><span class="line"></span><br><span class="line"># 三维ftable()</span><br><span class="line">&gt; y &lt;- xtabs(~ Treatment + Improved + Sex, data = Arthritis)</span><br><span class="line">&gt; y</span><br><span class="line">, , Sex = Female</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   19    7      6</span><br><span class="line">  Treated    6    5     16</span><br><span class="line"></span><br><span class="line">, , Sex = Male</span><br><span class="line"></span><br><span class="line">         Improved</span><br><span class="line">Treatment None Some Marked</span><br><span class="line">  Placebo   10    0      1</span><br><span class="line">  Treated    7    2      5</span><br><span class="line"></span><br><span class="line">&gt; ftable(y)</span><br><span class="line">                   Sex Female Male</span><br><span class="line">Treatment Improved                </span><br><span class="line">Placebo   None             19   10</span><br><span class="line">          Some              7    0</span><br><span class="line">          Marked            6    1</span><br><span class="line">Treated   None              6    7</span><br><span class="line">          Some              5    2</span><br><span class="line">          Marked           16    5</span><br></pre></td></tr></table></figure><h3 id="独立性检验函数">独立性检验函数</h3><p>独立性检验是根据频数信息判断两类因子彼此相关或者独立的假设检验。</p><p>独立性检验算法：</p><ol><li>卡方检验</li><li>Fisher检验</li><li>Cochran-Mantel-Haenszel检验</li></ol><p>假设检验（Hypothesis Testing）：由抽样判断总体。</p><p>原假设：没有发生；</p><p>备择假设：发生了</p><p><code>p value</code>：原假设为真时，得到最大的或者超出所得到的的检验统计计算量的概率</p><p><code>p</code>值一般定到0.05，当<code>p&lt;0.05</code>时，拒绝原假设，<code>p&gt;0.05</code>时，不拒绝原假设（根据情况调整<code>p</code>值）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> Arthritis</span><br><span class="line">   ID Treatment    Sex Age Improved</span><br><span class="line"><span class="number">1</span>  <span class="number">57</span>   Treated   Male  <span class="number">27</span>     Some</span><br><span class="line"><span class="number">2</span>  <span class="number">46</span>   Treated   Male  <span class="number">29</span>     None</span><br><span class="line"><span class="number">3</span>  <span class="number">77</span>   Treated   Male  <span class="number">30</span>     None</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Treatment<span class="punctuation">,</span> Arthritis<span class="operator">$</span>Improved<span class="punctuation">)</span></span><br><span class="line">         </span><br><span class="line">          None Some Marked</span><br><span class="line">  Placebo   <span class="number">29</span>    <span class="number">7</span>      <span class="number">7</span></span><br><span class="line">  Treated   <span class="number">13</span>    <span class="number">7</span>     <span class="number">21</span></span><br><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Treatment<span class="punctuation">,</span> Arthritis<span class="operator">$</span>Improved<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 卡方检验，p&lt;0.05，拒绝原假设，Treatment和Improved有关</span></span><br><span class="line"><span class="operator">&gt;</span> chisq.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Pearson<span class="string">&#x27;s Chi-squared test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">X-squared = 13.055, df = 2, p-value = 0.001463</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># p&gt;0.05，不拒绝原假设，Sex和Improved独立</span></span><br><span class="line"><span class="string">&gt; mytable &lt;- table(Arthritis$Sex, Arthritis$Improved)</span></span><br><span class="line"><span class="string">&gt; chisq.test(mytable)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Pearson&#x27;</span>s Chi<span class="operator">-</span>squared test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  mytable</span><br><span class="line">X<span class="operator">-</span>squared <span class="operator">=</span> <span class="number">4.8407</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.08889</span></span><br><span class="line"></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">In chisq.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span> <span class="operator">:</span> Chi<span class="operator">-</span>squared approximation may be incorrect</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fisher检验，p&lt;0.05，拒绝原假设，Treatment和Improved有关</span></span><br><span class="line"><span class="operator">&gt;</span> mytable <span class="operator">&lt;-</span> table<span class="punctuation">(</span>Arthritis<span class="operator">$</span>Treatment<span class="punctuation">,</span> Arthritis<span class="operator">$</span>Improved<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fisher.test<span class="punctuation">(</span>mytable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Fisher<span class="string">&#x27;s Exact Test for Count Data</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">p-value = 0.001393</span></span><br><span class="line"><span class="string">alternative hypothesis: two.sided</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Cochran-Mantel-Haenszel检验，p&lt;0.05，拒绝原假设，Treatment和Improved有关</span></span><br><span class="line"><span class="string">&gt; mytable &lt;- xtabs(~ Treatment+Improved+Sex, data = Arthritis)</span></span><br><span class="line"><span class="string">&gt; mytable</span></span><br><span class="line"><span class="string">, , Sex = Female</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         Improved</span></span><br><span class="line"><span class="string">Treatment None Some Marked</span></span><br><span class="line"><span class="string">  Placebo   19    7      6</span></span><br><span class="line"><span class="string">  Treated    6    5     16</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">, , Sex = Male</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         Improved</span></span><br><span class="line"><span class="string">Treatment None Some Marked</span></span><br><span class="line"><span class="string">  Placebo   10    0      1</span></span><br><span class="line"><span class="string">  Treated    7    2      5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; mantelhaen.test(mytable)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Cochran-Mantel-Haenszel test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">Cochran-Mantel-Haenszel M^2 = 14.632, df = 2, p-value = 0.0006647</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 顺序很重要</span></span><br><span class="line"><span class="string">&gt; mytable &lt;- xtabs(~ Treatment+Sex+Improved, data = Arthritis)</span></span><br><span class="line"><span class="string">&gt; mantelhaen.test(mytable)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mantel-Haenszel chi-squared test with continuity correction</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">Mantel-Haenszel X-squared = 2.0863, df = 1, p-value = 0.1486</span></span><br><span class="line"><span class="string">alternative hypothesis: true common odds ratio is not equal to 1</span></span><br><span class="line"><span class="string">95 percent confidence interval:</span></span><br><span class="line"><span class="string"> 0.8566711 8.0070521</span></span><br><span class="line"><span class="string">sample estimates:</span></span><br><span class="line"><span class="string">common odds ratio </span></span><br><span class="line"><span class="string">         2.619048 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; mytable &lt;- xtabs(~ Sex+Improved+Treatment, data = Arthritis)</span></span><br><span class="line"><span class="string">&gt; mantelhaen.test(mytable)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Cochran-Mantel-Haenszel test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  mytable</span></span><br><span class="line"><span class="string">Cochran-Mantel-Haenszel M^2 = 6.846, df = 2, p-value = 0.03261</span></span><br></pre></td></tr></table></figure><h3 id="相关性分析函数">相关性分析函数</h3><p>相关系数：</p><ol><li>Pearson相关系数</li><li>Spearman相关系数</li><li>Kendall相关系数</li><li>偏相关系数</li><li>多分格相关系数（polychoric）</li><li>多系列相关系数（polyserial）</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment"># 文盲率和高中毕业率负相关</span></span><br><span class="line"><span class="comment"># 可选参数method = &#x27;spearman&#x27;，计算不同的相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">            Population     Income Illiteracy     HS Grad</span><br><span class="line">Population  <span class="number">1.00000000</span>  <span class="number">0.2082276</span>  <span class="number">0.1076224</span> <span class="operator">-</span><span class="number">0.09848975</span></span><br><span class="line">Income      <span class="number">0.20822756</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.4370752</span>  <span class="number">0.61993232</span></span><br><span class="line">Illiteracy  <span class="number">0.10762237</span> <span class="operator">-</span><span class="number">0.4370752</span>  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.65718861</span></span><br><span class="line">HS Grad    <span class="operator">-</span><span class="number">0.09848975</span>  <span class="number">0.6199323</span> <span class="operator">-</span><span class="number">0.6571886</span>  <span class="number">1.00000000</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line">           Life Exp     Murder</span><br><span class="line">Life Exp  <span class="number">1.0000000</span> <span class="operator">-</span><span class="number">0.7808458</span></span><br><span class="line">Murder   <span class="operator">-</span><span class="number">0.7808458</span>  <span class="number">1.0000000</span></span><br><span class="line"><span class="comment"># 计算两个变量的相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> cor<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span></span><br><span class="line">              Life Exp     Murder</span><br><span class="line">Population <span class="operator">-</span><span class="number">0.06805195</span>  <span class="number">0.3436428</span></span><br><span class="line">Income      <span class="number">0.34025534</span> <span class="operator">-</span><span class="number">0.2300776</span></span><br><span class="line">Illiteracy <span class="operator">-</span><span class="number">0.58847793</span>  <span class="number">0.7029752</span></span><br><span class="line">HS Grad     <span class="number">0.58221620</span> <span class="operator">-</span><span class="number">0.4879710</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算协方差</span></span><br><span class="line"><span class="operator">&gt;</span> cov<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">             Population     Income   Illiteracy      HS Grad</span><br><span class="line">Population <span class="number">19931683.759</span> <span class="number">571229.780</span>  <span class="number">292.8679592</span> <span class="operator">-</span><span class="number">3551.509551</span></span><br><span class="line">Income       <span class="number">571229.780</span> <span class="number">377573.306</span> <span class="operator">-</span><span class="number">163.7020408</span>  <span class="number">3076.768980</span></span><br><span class="line">Illiteracy      <span class="number">292.868</span>   <span class="operator">-</span><span class="number">163.702</span>    <span class="number">0.3715306</span>    <span class="operator">-</span><span class="number">3.235469</span></span><br><span class="line">HS Grad       <span class="operator">-</span><span class="number">3551.510</span>   <span class="number">3076.769</span>   <span class="operator">-</span><span class="number">3.2354694</span>    <span class="number">65.237894</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ggm包中的pcor()计算偏相关系数</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>ggm<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> colnames<span class="punctuation">(</span>state.x77<span class="punctuation">)</span>    </span><br><span class="line"><span class="operator">&gt;</span> pcor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cov<span class="punctuation">(</span>state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.3462724</span></span><br></pre></td></tr></table></figure><h3 id="相关性检验函数">相关性检验函数</h3><p>相关性检验函数<code>cor.test()</code>，给出<code>p</code>值和相关系数</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> cor.test<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&#x27;Murder&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&#x27;Illiteracy&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Pearson<span class="string">&#x27;s product-moment correlation</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data:  state.x77[, &quot;Murder&quot;] and state.x77[, &quot;Illiteracy&quot;]</span></span><br><span class="line"><span class="string">t = 6.8479, df = 48, p-value = 1.258e-08</span></span><br><span class="line"><span class="string">alternative hypothesis: true correlation is not equal to 0</span></span><br><span class="line"><span class="string">95 percent confidence interval:</span></span><br><span class="line"><span class="string"> 0.5279280 0.8207295</span></span><br><span class="line"><span class="string">sample estimates:</span></span><br><span class="line"><span class="string">      cor </span></span><br><span class="line"><span class="string">0.7029752 </span></span><br></pre></td></tr></table></figure><p><code>psych</code>包的<code>corr.test()</code>函数可计算多个变量的相关性，并给出<code>p</code>值</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> corr.test<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span></span><br><span class="line">Call<span class="operator">:</span>corr.test<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span></span><br><span class="line">Correlation matrix </span><br><span class="line">           Life Exp Murder</span><br><span class="line">Population    <span class="operator">-</span><span class="number">0.07</span>   <span class="number">0.34</span></span><br><span class="line">Income         <span class="number">0.34</span>  <span class="operator">-</span><span class="number">0.23</span></span><br><span class="line">Illiteracy    <span class="operator">-</span><span class="number">0.59</span>   <span class="number">0.70</span></span><br><span class="line">HS Grad        <span class="number">0.58</span>  <span class="operator">-</span><span class="number">0.49</span></span><br><span class="line">Sample Size </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">50</span></span><br><span class="line">These are the unadjusted probability values.</span><br><span class="line">  The probability values  adjusted <span class="keyword">for</span> multiple tests are <span class="keyword">in</span> the p.adj object. </span><br><span class="line">           Life Exp Murder</span><br><span class="line">Population     <span class="number">0.64</span>   <span class="number">0.01</span></span><br><span class="line">Income         <span class="number">0.02</span>   <span class="number">0.11</span></span><br><span class="line">Illiteracy     <span class="number">0.00</span>   <span class="number">0.00</span></span><br><span class="line">HS Grad        <span class="number">0.00</span>   <span class="number">0.00</span></span><br><span class="line"></span><br><span class="line"> To see confidence intervals of the correlations<span class="punctuation">,</span> print with the short<span class="operator">=</span><span class="literal">FALSE</span> option</span><br></pre></td></tr></table></figure><p>偏相关性检验</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>ggm<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> pcor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cov<span class="punctuation">(</span>state.x77<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.3462724</span></span><br><span class="line"><span class="operator">&gt;</span> pcor.test<span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">50</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>tval</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2.476049</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>df</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">45</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>pvalue</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.01711252</span></span><br></pre></td></tr></table></figure><p>Student’s t test</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>MASS<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> UScrime</span><br><span class="line"><span class="operator">&gt;</span> t.test<span class="punctuation">(</span>Prob <span class="operator">~</span> So<span class="punctuation">,</span> data <span class="operator">=</span> UScrime<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Welch Two Sample t<span class="operator">-</span>test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  Prob by So</span><br><span class="line">t <span class="operator">=</span> <span class="operator">-</span><span class="number">3.8954</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">24.925</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">=</span> <span class="number">0.0006506</span></span><br><span class="line">alternative hypothesis<span class="operator">:</span> true difference <span class="keyword">in</span> means between group <span class="number">0</span> and group <span class="number">1</span> is not equal to <span class="number">0</span></span><br><span class="line"><span class="number">95</span> percent confidence interval<span class="operator">:</span></span><br><span class="line"> <span class="operator">-</span><span class="number">0.03852569</span> <span class="operator">-</span><span class="number">0.01187439</span></span><br><span class="line">sample estimates<span class="operator">:</span></span><br><span class="line">mean <span class="keyword">in</span> group <span class="number">0</span> mean <span class="keyword">in</span> group <span class="number">1</span> </span><br><span class="line">     <span class="number">0.03851265</span>      <span class="number">0.06371269</span> </span><br></pre></td></tr></table></figure><h3 id="绘图函数">绘图函数</h3><p>见第三章</p><h3 id="自定义函数">自定义函数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自定义计算偏度和丰度的函数</span></span><br><span class="line">myfun <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> na.omit<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>na.omit<span class="punctuation">)</span></span><br><span class="line">    x <span class="operator">&lt;-</span> x<span class="punctuation">[</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">  m <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  n <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  s <span class="operator">&lt;-</span> sd<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  skew <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span>x<span class="operator">-</span>m<span class="operator">^</span><span class="number">3</span><span class="operator">/</span>s<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">/</span>n</span><br><span class="line">  kurt <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span>x<span class="operator">-</span>m<span class="operator">^</span><span class="number">4</span><span class="operator">/</span>s<span class="operator">^</span><span class="number">4</span><span class="punctuation">)</span><span class="operator">/</span>n<span class="operator">-</span><span class="number">3</span></span><br><span class="line">  <span class="built_in">return</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>n<span class="operator">=</span>m<span class="punctuation">,</span> mean<span class="operator">=</span>m<span class="punctuation">,</span> stdev<span class="operator">=</span>s<span class="punctuation">,</span> skew<span class="operator">=</span>skew<span class="punctuation">,</span> kurtosis<span class="operator">=</span>kurt<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>print<span class="punctuation">(</span><span class="string">&#x27;11&#x27;</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> i<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="keyword">while</span><span class="punctuation">(</span>i<span class="operator">&lt;=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>print<span class="punctuation">(</span><span class="string">&#x27;2&#x27;</span><span class="punctuation">)</span>;i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> ifelse<span class="punctuation">(</span>i<span class="operator">&gt;</span><span class="number">10</span><span class="punctuation">,</span> print<span class="punctuation">(</span><span class="string">&#x27;yes&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> print<span class="punctuation">(</span><span class="string">&#x27;No&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="数据分析实战">数据分析实战</h2><h3 id="线性回归">线性回归</h3><p>回归（Regression）：用用预测变量（自变量、解释变量）来预测响应变量（因变量、结果变量）</p><table><thead><tr><th style="text-align:center">回归</th><th style="text-align:left">用途</th></tr></thead><tbody><tr><td style="text-align:center">简单线性</td><td style="text-align:left">用一个量化的解释变量预测一个量化的响应变量</td></tr><tr><td style="text-align:center">多项式</td><td style="text-align:left">用一个量化的解释变量预测一个量化的响应变量，模型的关系是n阶多项式</td></tr><tr><td style="text-align:center">多元线性</td><td style="text-align:left">用两个或多个量化的解释变量预测一个量化的响应变量</td></tr><tr><td style="text-align:center">多变量</td><td style="text-align:left">用一个或多个解释变量预测多个响应变量</td></tr><tr><td style="text-align:center">Logistic</td><td style="text-align:left">用一个或多个解释变量预测一个类别型响应变量</td></tr><tr><td style="text-align:center">泊松</td><td style="text-align:left">用一个或多个解释变量预测一个代表频数的响应变量</td></tr><tr><td style="text-align:center">Cox比例风险</td><td style="text-align:left">用一个或多个解释变量预测一个事件 ( 死亡、失败或旧病复发)发生的时间</td></tr><tr><td style="text-align:center">时间序列</td><td style="text-align:left">对误差项相关的时间序列数据建模</td></tr><tr><td style="text-align:center">非线性</td><td style="text-align:left">用一个或多个量化的解释变量预测一个量化的响应变量，不过模型是非线性的</td></tr><tr><td style="text-align:center">非参数</td><td style="text-align:left">用一个或多个量化的解释变量预测一个量化的响应变量，模型的形式源自数据形式,不事先设定</td></tr><tr><td style="text-align:center">稳健</td><td style="text-align:left">用一个或多个量化的解释变量预测一个量化的响应变量，能抵御强影响点的干扰</td></tr></tbody></table><p>线性回归：</p><ol><li>简单线性回归</li><li>多项式</li><li>多元线性</li><li>多变量</li><li>Logistic</li></ol><h4 id="简单线性回归">简单线性回归</h4><p>普通最小二乘回归法（OLS）</p><p><code>lm()</code>函数进行线性回归</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> women</span><br><span class="line">   height weight</span><br><span class="line"><span class="number">1</span>      <span class="number">58</span>    <span class="number">115</span></span><br><span class="line"><span class="number">2</span>      <span class="number">59</span>    <span class="number">117</span></span><br><span class="line"><span class="number">3</span>      <span class="number">60</span>    <span class="number">120</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  </span><br><span class="line">     <span class="operator">-</span><span class="number">87.52</span>         <span class="number">3.45</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 回归分析结果</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span> <span class="comment"># 回归所用公式</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span> <span class="comment"># 残差：真实值与预测值的差，越小越精确，残差分布</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">1.7333</span> <span class="operator">-</span><span class="number">1.1333</span> <span class="operator">-</span><span class="number">0.3833</span>  <span class="number">0.7417</span>  <span class="number">3.1167</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>     <span class="comment"># p value</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">87.51667</span>    <span class="number">5.93694</span>  <span class="operator">-</span><span class="number">14.74</span> <span class="number">1.71e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="comment"># 截距</span></span><br><span class="line">height        <span class="number">3.45000</span>    <span class="number">0.09114</span>   <span class="number">37.85</span> <span class="number">1.09e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="comment"># 系数</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">1.525</span> on <span class="number">13</span> degrees of freedom <span class="comment"># 残差的标准误差，越小越好</span></span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.991</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9903</span> <span class="comment"># R2判定系数，回归模型能解释的响应变量的方差比例</span></span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">1433</span> on <span class="number">1</span> and <span class="number">13</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">1.091e-14</span>  <span class="comment"># F统计量，说明模型是否显著</span></span><br><span class="line"><span class="comment"># 一般先看F统计量，p&gt;0.05模型就没有价值，需重新拟合</span></span><br><span class="line"><span class="comment"># 再看R2，看模型能够解释多少变量</span></span><br></pre></td></tr></table></figure><p>响应变量<code>~</code>预测变量1<code>+</code>预测变量2<code>+</code>预测变量3</p><img src="https://s2.loli.net/2022/07/09/b9nYREt3lvquSkO.png" style="zoom:80%;" /><p>拟合线性模型的常用函数</p><img src="https://s2.loli.net/2022/07/09/J95a37wPEOlc6bd.png" style="zoom:80%;" /><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height<span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  </span><br><span class="line">     <span class="operator">-</span><span class="number">87.52</span>         <span class="number">3.45</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出拟合模型的截距和斜率</span></span><br><span class="line"><span class="operator">&gt;</span> coefficients<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>      height </span><br><span class="line">  <span class="operator">-</span><span class="number">87.51667</span>     <span class="number">3.45000</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 给出置信区间</span></span><br><span class="line"><span class="operator">&gt;</span> confint<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">                  <span class="number">2.5</span> <span class="operator">%     97.5 %</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">100.342655</span> <span class="operator">-</span><span class="number">74.690679</span></span><br><span class="line">height         <span class="number">3.253112</span>   <span class="number">3.646888</span></span><br><span class="line"><span class="operator">&gt;</span> confint<span class="punctuation">(</span>fit<span class="punctuation">,</span> level <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line">                  <span class="number">25</span> <span class="operator">%       75 %</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">91.635892</span> <span class="operator">-</span><span class="number">83.397441</span></span><br><span class="line">height        <span class="number">3.386767</span>   <span class="number">3.513233</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给出预测值</span></span><br><span class="line"><span class="operator">&gt;</span> fitted<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span>        <span class="number">9</span>       <span class="number">10</span> </span><br><span class="line"><span class="number">112.5833</span> <span class="number">116.0333</span> <span class="number">119.4833</span> <span class="number">122.9333</span> <span class="number">126.3833</span> <span class="number">129.8333</span> <span class="number">133.2833</span> <span class="number">136.7333</span> <span class="number">140.1833</span> <span class="number">143.6333</span> </span><br><span class="line">      <span class="number">11</span>       <span class="number">12</span>       <span class="number">13</span>       <span class="number">14</span>       <span class="number">15</span> </span><br><span class="line"><span class="number">147.0833</span> <span class="number">150.5333</span> <span class="number">153.9833</span> <span class="number">157.4333</span> <span class="number">160.8833</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 给出残差</span></span><br><span class="line"><span class="operator">&gt;</span> residuals<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">          <span class="number">1</span>           <span class="number">2</span>           <span class="number">3</span>           <span class="number">4</span>           <span class="number">5</span>           <span class="number">6</span>           <span class="number">7</span>           <span class="number">8</span> </span><br><span class="line"> <span class="number">2.41666667</span>  <span class="number">0.96666667</span>  <span class="number">0.51666667</span>  <span class="number">0.06666667</span> <span class="operator">-</span><span class="number">0.38333333</span> <span class="operator">-</span><span class="number">0.83333333</span> <span class="operator">-</span><span class="number">1.28333333</span> <span class="operator">-</span><span class="number">1.73333333</span> </span><br><span class="line">          <span class="number">9</span>          <span class="number">10</span>          <span class="number">11</span>          <span class="number">12</span>          <span class="number">13</span>          <span class="number">14</span>          <span class="number">15</span> </span><br><span class="line"><span class="operator">-</span><span class="number">1.18333333</span> <span class="operator">-</span><span class="number">1.63333333</span> <span class="operator">-</span><span class="number">1.08333333</span> <span class="operator">-</span><span class="number">0.53333333</span>  <span class="number">0.01666667</span>  <span class="number">1.56666667</span>  <span class="number">3.11666667</span> </span><br><span class="line"> </span><br><span class="line"><span class="operator">&gt;</span> women<span class="operator">$</span>weight<span class="operator">-</span>fitted<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">          <span class="number">1</span>           <span class="number">2</span>           <span class="number">3</span>           <span class="number">4</span>           <span class="number">5</span>           <span class="number">6</span>           <span class="number">7</span>           <span class="number">8</span> </span><br><span class="line"> <span class="number">2.41666667</span>  <span class="number">0.96666667</span>  <span class="number">0.51666667</span>  <span class="number">0.06666667</span> <span class="operator">-</span><span class="number">0.38333333</span> <span class="operator">-</span><span class="number">0.83333333</span> <span class="operator">-</span><span class="number">1.28333333</span> <span class="operator">-</span><span class="number">1.73333333</span> </span><br><span class="line">          <span class="number">9</span>          <span class="number">10</span>          <span class="number">11</span>          <span class="number">12</span>          <span class="number">13</span>          <span class="number">14</span>          <span class="number">15</span> </span><br><span class="line"><span class="operator">-</span><span class="number">1.18333333</span> <span class="operator">-</span><span class="number">1.63333333</span> <span class="operator">-</span><span class="number">1.08333333</span> <span class="operator">-</span><span class="number">0.53333333</span>  <span class="number">0.01666667</span>  <span class="number">1.56666667</span>  <span class="number">3.11666667</span> </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> women1 <span class="operator">&lt;-</span> women</span><br><span class="line"><span class="comment"># 利用拟合模型对新数据集的响应变量进行预测</span></span><br><span class="line"><span class="operator">&gt;</span> predict<span class="punctuation">(</span>fit<span class="punctuation">,</span> women1<span class="punctuation">)</span></span><br><span class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span>        <span class="number">9</span>       <span class="number">10</span> </span><br><span class="line"><span class="number">112.5833</span> <span class="number">116.0333</span> <span class="number">119.4833</span> <span class="number">122.9333</span> <span class="number">126.3833</span> <span class="number">129.8333</span> <span class="number">133.2833</span> <span class="number">136.7333</span> <span class="number">140.1833</span> <span class="number">143.6333</span> </span><br><span class="line">      <span class="number">11</span>       <span class="number">12</span>       <span class="number">13</span>       <span class="number">14</span>       <span class="number">15</span> </span><br><span class="line"><span class="number">147.0833</span> <span class="number">150.5333</span> <span class="number">153.9833</span> <span class="number">157.4333</span> <span class="number">160.8833</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成评价拟合模型的诊断图</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="多项式回归">多项式回归</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多项式用I()括起来</span></span><br><span class="line"><span class="operator">&gt;</span> fit2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight<span class="operator">~</span>height<span class="operator">+</span>I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> data<span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit2</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span> <span class="comment"># 给出各项系数</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>       height  I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span>  </span><br><span class="line">  <span class="number">261.87818</span>     <span class="operator">-</span><span class="number">7.34832</span>      <span class="number">0.08306</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合效果优于简单线性回归</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.50941</span> <span class="operator">-</span><span class="number">0.29611</span> <span class="operator">-</span><span class="number">0.00941</span>  <span class="number">0.28615</span>  <span class="number">0.59706</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">261.87818</span>   <span class="number">25.19677</span>  <span class="number">10.393</span> <span class="number">2.36e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">height       <span class="operator">-</span><span class="number">7.34832</span>    <span class="number">0.77769</span>  <span class="operator">-</span><span class="number">9.449</span> <span class="number">6.58e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span>   <span class="number">0.08306</span>    <span class="number">0.00598</span>  <span class="number">13.891</span> <span class="number">9.32e-09</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.3841</span> on <span class="number">12</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9995</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9994</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">1.139e+04</span> on <span class="number">2</span> and <span class="number">12</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> fit3 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight<span class="operator">~</span>height<span class="operator">+</span>I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="operator">+</span>I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> data<span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit3<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> weight <span class="operator">~</span> height <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span> I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> women<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">0.40677</span> <span class="operator">-</span><span class="number">0.17391</span>  <span class="number">0.03091</span>  <span class="number">0.12051</span>  <span class="number">0.42191</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>   </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">8.967e+02</span>  <span class="number">2.946e+02</span>  <span class="operator">-</span><span class="number">3.044</span>  <span class="number">0.01116</span> <span class="operator">*</span> </span><br><span class="line">height       <span class="number">4.641e+01</span>  <span class="number">1.366e+01</span>   <span class="number">3.399</span>  <span class="number">0.00594</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span> <span class="operator">-</span><span class="number">7.462e-01</span>  <span class="number">2.105e-01</span>  <span class="operator">-</span><span class="number">3.544</span>  <span class="number">0.00460</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">I<span class="punctuation">(</span>height<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span>  <span class="number">4.253e-03</span>  <span class="number">1.079e-03</span>   <span class="number">3.940</span>  <span class="number">0.00231</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">0.2583</span> on <span class="number">11</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9998</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.9997</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">1.679e+04</span> on <span class="number">3</span> and <span class="number">11</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看拟合效果</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>women<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> abline<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> lines<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span> fitted<span class="punctuation">(</span>fit2<span class="punctuation">)</span><span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> lines<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span> fitted<span class="punctuation">(</span>fit3<span class="punctuation">)</span><span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="多元线性回归">多元线性回归</h4><p>回归系数的含义：其他预测变量保持不变时，一个预测变量增加一个单位后，因变量的增量。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> state <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Murder&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Life Exp&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Illiteracy&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Income&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;HS Grad&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> colnames<span class="punctuation">(</span>state<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Murder&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Life_Exp&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Illiteracy&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Income&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;HS_Grad&#x27;</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 加入多个变量</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Life_Exp<span class="operator">+</span>Illiteracy<span class="operator">+</span>Income<span class="operator">+</span>HS_Grad<span class="punctuation">,</span> data<span class="operator">=</span>state<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Life_Exp <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> HS_Grad<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> state<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>     Life_Exp   Illiteracy       Income      HS_Grad  </span><br><span class="line"> <span class="number">116.507133</span>    <span class="operator">-</span><span class="number">1.662190</span>     <span class="number">2.786755</span>     <span class="number">0.000718</span>     <span class="number">0.042163</span>  </span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Life_Exp <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> HS_Grad<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> state<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">   Min     <span class="number">1</span>Q Median     <span class="number">3</span>Q    Max </span><br><span class="line"><span class="operator">-</span><span class="number">3.715</span> <span class="operator">-</span><span class="number">1.524</span>  <span class="number">0.113</span>  <span class="number">1.737</span>  <span class="number">3.848</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">              Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">1.165e+02</span>  <span class="number">1.976e+01</span>   <span class="number">5.897</span> <span class="number">4.44e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Life_Exp    <span class="operator">-</span><span class="number">1.662e+00</span>  <span class="number">2.822e-01</span>  <span class="operator">-</span><span class="number">5.891</span> <span class="number">4.53e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Illiteracy   <span class="number">2.787e+00</span>  <span class="number">6.708e-01</span>   <span class="number">4.154</span> <span class="number">0.000144</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Income       <span class="number">7.180e-04</span>  <span class="number">6.024e-04</span>   <span class="number">1.192</span> <span class="number">0.239535</span>    </span><br><span class="line">HS_Grad      <span class="number">4.216e-02</span>  <span class="number">5.736e-02</span>   <span class="number">0.735</span> <span class="number">0.466095</span>    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.028</span> on <span class="number">45</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7229</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.6983</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">29.35</span> on <span class="number">4</span> and <span class="number">45</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">4.961e-12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看系数</span></span><br><span class="line"><span class="operator">&gt;</span> coef<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">(</span>Intercept<span class="punctuation">)</span>      Life_Exp    Illiteracy        Income       HS_Grad </span><br><span class="line"> <span class="number">1.165071e+02</span> <span class="operator">-</span><span class="number">1.662190e+00</span>  <span class="number">2.786755e+00</span>  <span class="number">7.179837e-04</span>  <span class="number">4.216343e-02</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 回归模型比较</span></span><br><span class="line"><span class="operator">&gt;</span> fit1 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Life_Exp<span class="operator">+</span>Illiteracy<span class="operator">+</span>Income<span class="operator">+</span>HS_Grad<span class="punctuation">,</span> data<span class="operator">=</span>state<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit2 <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Life_Exp<span class="operator">+</span>Illiteracy<span class="punctuation">,</span> data<span class="operator">=</span>state<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Life_Exp <span class="operator">+</span> Illiteracy<span class="punctuation">,</span> data <span class="operator">=</span> state<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">4.3725</span> <span class="operator">-</span><span class="number">1.5867</span>  <span class="number">0.0284</span>  <span class="number">1.1919</span>  <span class="number">4.3641</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">114.2162</span>    <span class="number">19.6698</span>   <span class="number">5.807</span> <span class="number">5.27e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Life_Exp     <span class="operator">-</span><span class="number">1.5446</span>     <span class="number">0.2716</span>  <span class="operator">-</span><span class="number">5.688</span> <span class="number">7.96e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Illiteracy    <span class="number">2.2557</span>     <span class="number">0.5981</span>   <span class="number">3.772</span> <span class="number">0.000453</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.063</span> on <span class="number">47</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7004</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.6876</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">54.94</span> on <span class="number">2</span> and <span class="number">47</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">4.998e-13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AIC()函数比较拟合模型，越小越好，表明模型用较少的参数就可以得到很好的拟合度</span></span><br><span class="line"><span class="operator">&gt;</span> AIC<span class="punctuation">(</span>fit1<span class="punctuation">,</span> fit2<span class="punctuation">)</span></span><br><span class="line">     df      AIC</span><br><span class="line">fit1  <span class="number">6</span> <span class="number">219.3144</span></span><br><span class="line">fit2  <span class="number">4</span> <span class="number">219.2232</span></span><br></pre></td></tr></table></figure><h4 id="有交互项的多元线性回归">有交互项的多元线性回归</h4><p>有时候变量之间不是独立的，有交互关系，如车辆马力与车重有关系.</p><p>若两个预测变量的交互项显著，说明响应变量与其中一个预测变量的关系依赖于另一个预测变量的水平。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>mpg<span class="operator">~</span>hp<span class="operator">+</span>wt<span class="operator">+</span>hp<span class="operator">:</span>wt<span class="punctuation">,</span> data<span class="operator">=</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> mpg <span class="operator">~</span> hp <span class="operator">+</span> wt <span class="operator">+</span> hp<span class="operator">:</span>wt<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">)</span> <span class="comment"># 不清楚是什么交互关系，用:连接</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">3.0632</span> <span class="operator">-</span><span class="number">1.6491</span> <span class="operator">-</span><span class="number">0.7362</span>  <span class="number">1.4211</span>  <span class="number">4.5513</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="number">49.80842</span>    <span class="number">3.60516</span>  <span class="number">13.816</span> <span class="number">5.01e-14</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">hp          <span class="operator">-</span><span class="number">0.12010</span>    <span class="number">0.02470</span>  <span class="operator">-</span><span class="number">4.863</span> <span class="number">4.04e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">wt          <span class="operator">-</span><span class="number">8.21662</span>    <span class="number">1.26971</span>  <span class="operator">-</span><span class="number">6.471</span> <span class="number">5.20e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">hp<span class="operator">:</span>wt        <span class="number">0.02785</span>    <span class="number">0.00742</span>   <span class="number">3.753</span> <span class="number">0.000811</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="comment"># hp与wt交互显著</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">2.153</span> on <span class="number">28</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.8848</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.8724</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">71.66</span> on <span class="number">3</span> and <span class="number">28</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">2.981e-13</span></span><br></pre></td></tr></table></figure><p><code>AIC()</code>只能比较两个模型</p><p>如果变量很多，可以采用逐步回归法和全子集回归法</p><p>逐步回归法：模型会一次添加或删除变量，向前或向后逐步回归</p><p>全子集回归法：计算所有模型后选出最优模型，更全面</p><p>逐步回归法</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>MASS<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> states <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Murder&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Population&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>                                      <span class="string">&quot;Illiteracy&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Income&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Frost&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span></span><br><span class="line"><span class="operator">+</span>           data<span class="operator">=</span>states<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> stepAIC<span class="punctuation">(</span>fit<span class="punctuation">,</span> direction <span class="operator">=</span> <span class="string">&quot;backward&quot;</span><span class="punctuation">)</span></span><br><span class="line">Start<span class="operator">:</span>  AIC<span class="operator">=</span><span class="number">97.75</span></span><br><span class="line">Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost</span><br><span class="line"></span><br><span class="line">             Df Sum of Sq    RSS     AIC</span><br><span class="line"><span class="operator">-</span> Frost       <span class="number">1</span>     <span class="number">0.021</span> <span class="number">289.19</span>  <span class="number">95.753</span></span><br><span class="line"><span class="operator">-</span> Income      <span class="number">1</span>     <span class="number">0.057</span> <span class="number">289.22</span>  <span class="number">95.759</span></span><br><span class="line"><span class="operator">&lt;</span>none<span class="operator">&gt;</span>                    <span class="number">289.17</span>  <span class="number">97.749</span></span><br><span class="line"><span class="operator">-</span> Population  <span class="number">1</span>    <span class="number">39.238</span> <span class="number">328.41</span> <span class="number">102.111</span></span><br><span class="line"><span class="operator">-</span> Illiteracy  <span class="number">1</span>   <span class="number">144.264</span> <span class="number">433.43</span> <span class="number">115.986</span></span><br><span class="line"></span><br><span class="line">Step<span class="operator">:</span>  AIC<span class="operator">=</span><span class="number">95.75</span></span><br><span class="line">Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income</span><br><span class="line"></span><br><span class="line">             Df Sum of Sq    RSS     AIC</span><br><span class="line"><span class="operator">-</span> Income      <span class="number">1</span>     <span class="number">0.057</span> <span class="number">289.25</span>  <span class="number">93.763</span></span><br><span class="line"><span class="operator">&lt;</span>none<span class="operator">&gt;</span>                    <span class="number">289.19</span>  <span class="number">95.753</span></span><br><span class="line"><span class="operator">-</span> Population  <span class="number">1</span>    <span class="number">43.658</span> <span class="number">332.85</span> <span class="number">100.783</span></span><br><span class="line"><span class="operator">-</span> Illiteracy  <span class="number">1</span>   <span class="number">236.196</span> <span class="number">525.38</span> <span class="number">123.605</span></span><br><span class="line"></span><br><span class="line">Step<span class="operator">:</span>  AIC<span class="operator">=</span><span class="number">93.76</span></span><br><span class="line">Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy</span><br><span class="line"></span><br><span class="line">             Df Sum of Sq    RSS     AIC</span><br><span class="line"><span class="operator">&lt;</span>none<span class="operator">&gt;</span>                    <span class="number">289.25</span>  <span class="number">93.763</span></span><br><span class="line"><span class="operator">-</span> Population  <span class="number">1</span>    <span class="number">48.517</span> <span class="number">337.76</span>  <span class="number">99.516</span></span><br><span class="line"><span class="operator">-</span> Illiteracy  <span class="number">1</span>   <span class="number">299.646</span> <span class="number">588.89</span> <span class="number">127.311</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy<span class="punctuation">,</span> data <span class="operator">=</span> states<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   Population   Illiteracy  </span><br><span class="line">  <span class="number">1.6515497</span>    <span class="number">0.0002242</span>    <span class="number">4.0807366</span>  </span><br></pre></td></tr></table></figure><p>全子集回归法</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>leaps<span class="punctuation">)</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> states <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>state.x77<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Murder&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Population&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Illiteracy&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Income&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Frost&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> leaps <span class="operator">&lt;-</span>regsubsets<span class="punctuation">(</span>Murder <span class="operator">~</span> Population <span class="operator">+</span> Illiteracy <span class="operator">+</span> Income <span class="operator">+</span> Frost<span class="punctuation">,</span> data<span class="operator">=</span>states<span class="punctuation">,</span> nbest<span class="operator">=</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>leaps<span class="punctuation">,</span> scale<span class="operator">=</span><span class="string">&quot;adjr2&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="回归诊断">回归诊断</h4><p>模型是否最佳？是否经得起更多数据的检验？</p><p>满足OLS模型的统计假设才能够用<code>lm()</code>进行拟合</p><ol><li>正态性：对于固定的自变量值，因变量成正态分布</li><li>独立性：因变量之间相互独立</li><li>线性：因变量和自变量之间为线性关系</li><li>同方差性：因变量的方差不随自变量的水平不同而变化。也称不变方差</li></ol><p><code>plot(fit)</code>的四幅图即是对这四个条件的反应</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">opar <span class="operator">&lt;-</span> par<span class="punctuation">(</span>no.readonly<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>weight <span class="operator">~</span> height<span class="punctuation">,</span> data<span class="operator">=</span>women<span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>opar<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>残差——拟合图</p><h3 id="ANOVA">ANOVA</h3><p>Analysis of Variance，ANOVA，也称变异数分析，一种统计检验，用于分析<u>两个以上</u>样本之间的均值的差异。</p><p>方差分析分类：</p><ol><li>单因素方差分析ANOVA（组内、组间）</li><li>双因素方差分析ANOVA</li><li>协方差分析ANCOVA</li><li>多元方差分析MANOVA</li><li>多元协方差分析MANCOVA</li></ol><p><code>aov()</code>和<code>lm()</code>均可进行方差分析，<code>aov()</code>用法类似</p><img src="https://s2.loli.net/2022/07/09/ISzl3vNGH9dYnuC.png" alt="image-20220404095055952" style="zoom:80%;" /><p>常见的公式</p><p><img src="https://s2.loli.net/2022/07/09/ktHCIpOB3KhVPl9.png" alt="image-20220404095308548"></p><p>公式中各项的顺序很重要。</p><h4 id="one-way-ANOVA">one-way ANOVA</h4><p>探究单个单个因素（自变量）对响应变量的影响。</p><p>one-way ANOVA，单因素方差分析，一个自变量（independent variable）</p><p>适用情况：  自变量至少有3个水平（level，即类型为因子factor），即至少3个不同组或类别，因变量（dependent variable）为数值型（numeric）</p><p>ANOVA可检测因变量是否随自变量的水平变化而变化，比如</p><ul><li>自变量为微信使用频率，分为低、中、高三个组，探究其晚上睡眠时长是否有差异。</li><li>自变量为汽水品牌，收集可口可乐、百事、芬达、康师傅的数据，分析其每100 mL汽水的价格是否有差异。</li><li>自变量为肥料种类，使用3种肥料对作物施肥，分析作物产量是否有差异。</li></ul><p>ANOVA的零假设（null hypothesis，H<sub>0</sub>）：不同组之间的均值没有差异</p><p>备择假设（alternative hypothesis， H<sub>a</sub>）：至少有一个组与因变量的总体均值显著不同</p><p>原理：计算各组的均值是否与因变量总体均值不同，如果有任何一个组的均值与总体均值显著不同，则拒绝零假设。ANOVA使用F检验（F-test）进行统计的显著性分析。由于误差是针对整个组比较计算的，所以F检验允许一次比较多个均值，而不是针对每个单独的双向比较（t-test）。F检验将每组均值的方差与总体组的方差进行比较，如果组内方差小于组间方差，则F检验得到的F值很大，因此观察到的差异是真实存在的可能性更高，而不是偶然现象。</p><p><strong>ANOVA假设条件</strong></p><ol><li>观测之间相互独立：使用有效的统计学方法收集数据，观测之间没有隐藏的联系</li><li>响应变量符合正态分布：因变量的值符合正态分布</li><li>同方差性：被比较的每组的方差是相似的，如果组间方差不同，则方差分析可能不适合</li></ol><p><strong>实例</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作物数据</span></span><br><span class="line"><span class="comment"># density：种植密度，1：低，2：高</span></span><br><span class="line"><span class="comment"># block：种植区域，1,2,3,4</span></span><br><span class="line"><span class="comment"># fertilizer：肥料种类：1,2,3</span></span><br><span class="line"><span class="comment"># yield：产量（bushels/acre，蒲式耳/英亩）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入数据时，直接转换为 factor</span></span><br><span class="line"><span class="operator">&gt;</span> oneway <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;crop.data.csv&#x27;</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;factor&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;factor&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;factor&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;numeric&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>oneway<span class="punctuation">)</span></span><br><span class="line">  density block fertilizer    yield</span><br><span class="line"><span class="number">1</span>       <span class="number">1</span>     <span class="number">1</span>          <span class="number">1</span> <span class="number">177.2287</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2</span>     <span class="number">2</span>          <span class="number">1</span> <span class="number">177.5500</span></span><br><span class="line"><span class="number">3</span>       <span class="number">1</span>     <span class="number">3</span>          <span class="number">1</span> <span class="number">176.4085</span></span><br><span class="line"><span class="number">4</span>       <span class="number">2</span>     <span class="number">4</span>          <span class="number">1</span> <span class="number">177.7036</span></span><br><span class="line"><span class="number">5</span>       <span class="number">1</span>     <span class="number">1</span>          <span class="number">1</span> <span class="number">177.1255</span></span><br><span class="line"><span class="number">6</span>       <span class="number">2</span>     <span class="number">2</span>          <span class="number">1</span> <span class="number">176.7783</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>oneway<span class="punctuation">)</span></span><br><span class="line"> density block  fertilizer     yield      </span><br><span class="line"> <span class="number">1</span><span class="operator">:</span><span class="number">48</span>    <span class="number">1</span><span class="operator">:</span><span class="number">24</span>   <span class="number">1</span><span class="operator">:</span><span class="number">32</span>       Min.   <span class="operator">:</span><span class="number">175.4</span>  </span><br><span class="line"> <span class="number">2</span><span class="operator">:</span><span class="number">48</span>    <span class="number">2</span><span class="operator">:</span><span class="number">24</span>   <span class="number">2</span><span class="operator">:</span><span class="number">32</span>       <span class="number">1</span>st Qu.<span class="operator">:</span><span class="number">176.5</span>  </span><br><span class="line">         <span class="number">3</span><span class="operator">:</span><span class="number">24</span>   <span class="number">3</span><span class="operator">:</span><span class="number">32</span>       Median <span class="operator">:</span><span class="number">177.1</span>  </span><br><span class="line">         <span class="number">4</span><span class="operator">:</span><span class="number">24</span>              Mean   <span class="operator">:</span><span class="number">177.0</span>  </span><br><span class="line">                           <span class="number">3</span>rd Qu.<span class="operator">:</span><span class="number">177.4</span>  </span><br><span class="line">                           Max.   <span class="operator">:</span><span class="number">179.1</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 探究肥料与产量的关系</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>yield<span class="operator">~</span>fertilizer<span class="punctuation">,</span> data <span class="operator">=</span> oneway<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">fertilizer   <span class="number">2</span>   <span class="number">6.07</span>  <span class="number">3.0340</span>   <span class="number">7.863</span>  <span class="number">7e-04</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">93</span>  <span class="number">35.89</span>  <span class="number">0.3859</span>                   </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ANOVA 输出内容解释</p><ul><li>第一列：自变量和模型残差（model residuals），也即模型误差（model error）</li><li><code>Df</code>：为自变量的自由度（自变量level-1）和残差的自由度（观测总数-1-？？？？），fertilizer自由度为3-1=2，残差为96-1-2=93</li><li><code>Sum Sq</code>：由该变量解释的组均值和总体均值之间的平方和（sum of squares），fertilizer平方和为6.07，残差为35.89</li><li><code>Mean Sq</code>：平方和的均值，即平方和÷自由度</li><li><code>F value</code>：来自F检验（F-test）的检验统计量，每个自变量的平均方差÷残差的平均方差，F值越大，与自变量相关的变化越有可能是真实的，而不是偶然的</li><li><code>Pr(&gt;F)</code>：F统计量的p值，表示，如果组均值之间没有差异的零假设为真时，F值发生的可能性</li></ul><p>由于自变量fertilizer的<code>p &lt; 0.05</code>，显著，拒绝零假设，所以肥料种类对作物产量有显著影响。</p><p>ANOVA 能够分析自变量的水平之间是否存在差异，但哪些差异是显著的却不知道。</p><p>可以使用<code>TukeyHSD()</code>函数进行 Tukey’s Honestly-Significant Difference post-hoc test</p><p>Tukey test 对组进行两两比较，并使用保守误差（conservative error estimate）估计找出在统计上不同的组</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> TukeyHSD<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">  Tukey multiple comparisons of means</span><br><span class="line">    <span class="number">95</span>% family<span class="operator">-</span>wise confidence level</span><br><span class="line"></span><br><span class="line">Fit<span class="operator">:</span> aov<span class="punctuation">(</span>formula <span class="operator">=</span> yield <span class="operator">~</span> fertilizer<span class="punctuation">,</span> data <span class="operator">=</span> oneway<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>fertilizer</span><br><span class="line">         diff         lwr       upr     p adj</span><br><span class="line"><span class="number">2</span><span class="operator">-</span><span class="number">1</span> <span class="number">0.1761687</span> <span class="operator">-</span><span class="number">0.19371896</span> <span class="number">0.5460564</span> <span class="number">0.4954705</span></span><br><span class="line"><span class="number">3</span><span class="operator">-</span><span class="number">1</span> <span class="number">0.5991256</span>  <span class="number">0.22923789</span> <span class="number">0.9690133</span> <span class="number">0.0006125</span></span><br><span class="line"><span class="number">3</span><span class="operator">-</span><span class="number">2</span> <span class="number">0.4229569</span>  <span class="number">0.05306916</span> <span class="number">0.7928445</span> <span class="number">0.0208735</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>oneway<span class="operator">$</span>yield<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>oneway<span class="operator">$</span>fertilizer<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">176.7570</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">176.9332</span></span><br><span class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">177.3562</span></span><br></pre></td></tr></table></figure><p>输出内容解释</p><p><code>Fit</code>：检验的模型</p><p><code>diff</code>：两组的均值差</p><p><code>lwr, upr</code>：95%置信区间的上下限</p><p><code>p adj</code>：调整后的p值</p><p>结果表明，3-2和3-1之间的差异显著（p &lt; 0.05），肥料3的作物平均产量显著高于肥料1和2；</p><p>而肥料1和2之间的作物平均产量差异不显著。</p><p>ANOVA 总结方式</p><blockquote><p>We found a statistically-significant difference in average crop yield according to fertilizer type (f(2)=9.073, p &lt; 0.001). A Tukey post-hoc test revealed significant pairwise differences between fertilizer types 3 and 2, with an average difference of 0.42 bushels/acre (p &lt; 0.05) and between fertilizer types 3 and 1, with an average difference of 0.59 bushels/acre (p &lt; 0.01).</p></blockquote><p><code>multcomp</code>包中的<code>cholesterol</code>数据集</p><p>自变量：5种疗法<code>trt</code></p><p>响应变量：问卷得分<code>response</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>multcomp<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>cholesterol<span class="punctuation">)</span></span><br><span class="line">    trt response</span><br><span class="line"><span class="number">1</span> <span class="number">1</span>time   <span class="number">3.8612</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span>time  <span class="number">10.3868</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span>time   <span class="number">5.9059</span></span><br><span class="line"><span class="number">4</span> <span class="number">1</span>time   <span class="number">3.0609</span></span><br><span class="line"><span class="number">5</span> <span class="number">1</span>time   <span class="number">7.7204</span></span><br><span class="line"><span class="number">6</span> <span class="number">1</span>time   <span class="number">2.7139</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 频数统计</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>cholesterol<span class="operator">$</span>trt<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"> <span class="number">1</span>time <span class="number">2</span>times <span class="number">4</span>times  drugD  drugE </span><br><span class="line">    <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span>     <span class="number">10</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组统计均值和标准差</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>cholesterol<span class="operator">$</span>response<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>cholesterol<span class="operator">$</span>trt<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>time  <span class="number">5.78197</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>times  <span class="number">9.22497</span></span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>times <span class="number">12.37478</span></span><br><span class="line"><span class="number">4</span>   drugD <span class="number">15.36117</span></span><br><span class="line"><span class="number">5</span>   drugE <span class="number">20.94752</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>cholesterol<span class="operator">$</span>response<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>cholesterol<span class="operator">$</span>trt<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>sd<span class="punctuation">)</span></span><br><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>time <span class="number">2.878113</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>times <span class="number">3.483054</span></span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>times <span class="number">2.923119</span></span><br><span class="line"><span class="number">4</span>   drugD <span class="number">3.454636</span></span><br><span class="line"><span class="number">5</span>   drugE <span class="number">3.345003</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方差分析</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>response<span class="operator">~</span>trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> fit</span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">   aov<span class="punctuation">(</span>formula <span class="operator">=</span> response <span class="operator">~</span> trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Terms<span class="operator">:</span></span><br><span class="line">                      trt Residuals</span><br><span class="line">Sum of Squares  <span class="number">1351.3690</span>  <span class="number">468.7504</span></span><br><span class="line">Deg. of Freedom         <span class="number">4</span>        <span class="number">45</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">3.227488</span></span><br><span class="line">Estimated effects may be unbalanced</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value   Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">trt          <span class="number">4</span> <span class="number">1351.4</span>   <span class="number">337.8</span>   <span class="number">32.43</span> <span class="number">9.82e-13</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="comment"># F值越大，组间差异越大，p值越小，F值越可靠</span></span><br><span class="line">Residuals   <span class="number">45</span>  <span class="number">468.8</span>    <span class="number">10.4</span>                     </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检测数据是否满足假设条件</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># lm()函数方差分析</span></span><br><span class="line"><span class="operator">&gt;</span> fit_lm <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>response<span class="operator">~</span>trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit_lm<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> response <span class="operator">~</span> trt<span class="punctuation">,</span> data <span class="operator">=</span> cholesterol<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">    Min      <span class="number">1</span>Q  Median      <span class="number">3</span>Q     Max </span><br><span class="line"><span class="operator">-</span><span class="number">6.5418</span> <span class="operator">-</span><span class="number">1.9672</span> <span class="operator">-</span><span class="number">0.0016</span>  <span class="number">1.8901</span>  <span class="number">6.6008</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">            Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>    <span class="number">5.782</span>      <span class="number">1.021</span>   <span class="number">5.665</span> <span class="number">9.78e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trt2times      <span class="number">3.443</span>      <span class="number">1.443</span>   <span class="number">2.385</span>   <span class="number">0.0213</span> <span class="operator">*</span>  </span><br><span class="line">trt4times      <span class="number">6.593</span>      <span class="number">1.443</span>   <span class="number">4.568</span> <span class="number">3.82e-05</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trtdrugD       <span class="number">9.579</span>      <span class="number">1.443</span>   <span class="number">6.637</span> <span class="number">3.53e-08</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">trtdrugE      <span class="number">15.166</span>      <span class="number">1.443</span>  <span class="number">10.507</span> <span class="number">1.08e-13</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">3.227</span> on <span class="number">45</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7425</span><span class="punctuation">,</span>Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7196</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span> <span class="number">32.43</span> on <span class="number">4</span> and <span class="number">45</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">9.819e-13</span> <span class="comment"># F值与p值和aov()函数得出的相同</span></span><br></pre></td></tr></table></figure><p>单因素协方差分析</p><p><code>litter</code>怀孕小鼠数据集</p><p>因变量：给药剂量<code>dose</code>，0, 5, 50, 500</p><p>响应变量：每窝幼崽平均出生体重<code>weight</code></p><p>协变量：怀孕时间<code>gesttime</code>、产仔数</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>multcomp<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>litter<span class="punctuation">)</span></span><br><span class="line">  dose weight gesttime number</span><br><span class="line"><span class="number">1</span>    <span class="number">0</span>  <span class="number">28.05</span>     <span class="number">22.5</span>     <span class="number">15</span></span><br><span class="line"><span class="number">2</span>    <span class="number">0</span>  <span class="number">33.33</span>     <span class="number">22.5</span>     <span class="number">14</span></span><br><span class="line"><span class="number">3</span>    <span class="number">0</span>  <span class="number">36.37</span>     <span class="number">22.0</span>     <span class="number">14</span></span><br><span class="line"><span class="number">4</span>    <span class="number">0</span>  <span class="number">35.52</span>     <span class="number">22.0</span>     <span class="number">13</span></span><br><span class="line"><span class="number">5</span>    <span class="number">0</span>  <span class="number">36.77</span>     <span class="number">21.5</span>     <span class="number">15</span></span><br><span class="line"><span class="number">6</span>    <span class="number">0</span>  <span class="number">29.60</span>     <span class="number">23.0</span>      <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 频数统计</span></span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>litter<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">  <span class="number">0</span>   <span class="number">5</span>  <span class="number">50</span> <span class="number">500</span> </span><br><span class="line"> <span class="number">20</span>  <span class="number">19</span>  <span class="number">18</span>  <span class="number">17</span> </span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>litter<span class="operator">$</span>gesttime<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="number">21.5</span>   <span class="number">22</span> <span class="number">22.5</span>   <span class="number">23</span> </span><br><span class="line">  <span class="number">20</span>   <span class="number">24</span>   <span class="number">27</span>    <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组统计平均值，差异不明显</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>litter<span class="operator">$</span>weight<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>litter<span class="operator">$</span>dose<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1        x</span><br><span class="line"><span class="number">1</span>       <span class="number">0</span> <span class="number">32.30850</span></span><br><span class="line"><span class="number">2</span>       <span class="number">5</span> <span class="number">29.30842</span></span><br><span class="line"><span class="number">3</span>      <span class="number">50</span> <span class="number">29.86611</span></span><br><span class="line"><span class="number">4</span>     <span class="number">500</span> <span class="number">29.64647</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 协变量放在前面，分析控制协变量时，自变量的影响</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>weight<span class="operator">~</span>gesttime<span class="operator">+</span>dose<span class="punctuation">,</span> data <span class="operator">=</span> litter<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value  Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>   </span><br><span class="line">gesttime     <span class="number">1</span>  <span class="number">134.3</span>  <span class="number">134.30</span>   <span class="number">8.049</span> <span class="number">0.00597</span> <span class="operator">*</span><span class="operator">*</span> <span class="comment"># 怀孕时间与出生幼崽的体重有关</span></span><br><span class="line">dose         <span class="number">3</span>  <span class="number">137.1</span>   <span class="number">45.71</span>   <span class="number">2.739</span> <span class="number">0.04988</span> <span class="operator">*</span> <span class="comment"># 控制怀孕时间，药物剂量与出生体重相关</span></span><br><span class="line">Residuals   <span class="number">69</span> <span class="number">1151.3</span>   <span class="number">16.69</span>                   </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="two-way-ANOVA">two-way ANOVA</h4><p>two-way ANOVA，双因素方差分析，两个自变量</p><p><code>ToothGrowth</code>数据集</p><p>自变量：喂食种类<code>supp</code>、剂量<code>dose</code></p><p>响应变量：牙齿长度<code>len</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>ToothGrowth<span class="punctuation">)</span></span><br><span class="line">   len supp dose</span><br><span class="line"><span class="number">1</span>  <span class="number">4.2</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">2</span> <span class="number">11.5</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">3</span>  <span class="number">7.3</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">4</span>  <span class="number">5.8</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">5</span>  <span class="number">6.4</span>   VC  <span class="number">0.5</span></span><br><span class="line"><span class="number">6</span> <span class="number">10.0</span>   VC  <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将自变量转化为因子类型</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>supp<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;numeric&quot;</span></span><br><span class="line"><span class="operator">&gt;</span> ToothGrowth<span class="operator">$</span>dose <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 频数统计二联表</span></span><br><span class="line"><span class="operator">&gt;</span> xtabs<span class="punctuation">(</span><span class="operator">~</span>dose<span class="operator">+</span>supp<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">)</span></span><br><span class="line">     supp</span><br><span class="line">dose  OJ VC</span><br><span class="line">  <span class="number">0.5</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line">  <span class="number">1</span>   <span class="number">10</span> <span class="number">10</span></span><br><span class="line">  <span class="number">2</span>   <span class="number">10</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组统计均值</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>len<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">,</span> ToothGrowth<span class="operator">$</span>supp<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1 Group.2     x</span><br><span class="line"><span class="number">1</span>     <span class="number">0.5</span>      OJ <span class="number">13.23</span></span><br><span class="line"><span class="number">2</span>       <span class="number">1</span>      OJ <span class="number">22.70</span></span><br><span class="line"><span class="number">3</span>       <span class="number">2</span>      OJ <span class="number">26.06</span></span><br><span class="line"><span class="number">4</span>     <span class="number">0.5</span>      VC  <span class="number">7.98</span></span><br><span class="line"><span class="number">5</span>       <span class="number">1</span>      VC <span class="number">16.77</span></span><br><span class="line"><span class="number">6</span>       <span class="number">2</span>      VC <span class="number">26.14</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二者存在交互，用*表示所有情况，即A+B+A:B</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> aov<span class="punctuation">(</span>len<span class="operator">~</span>supp<span class="operator">*</span>dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value   Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">supp         <span class="number">1</span>  <span class="number">205.4</span>   <span class="number">205.4</span>  <span class="number">15.572</span> <span class="number">0.000231</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="comment"># 结果显著，supp和dose对len都有影响</span></span><br><span class="line">dose         <span class="number">2</span> <span class="number">2426.4</span>  <span class="number">1213.2</span>  <span class="number">92.000</span>  <span class="operator">&lt;</span> <span class="number">2e-16</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">supp<span class="operator">:</span>dose    <span class="number">2</span>  <span class="number">108.3</span>    <span class="number">54.2</span>   <span class="number">4.107</span> <span class="number">0.021860</span> <span class="operator">*</span>   <span class="comment"># 交互项也显著</span></span><br><span class="line">Residuals   <span class="number">54</span>  <span class="number">712.1</span>    <span class="number">13.2</span>                     </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可使用HH包的函数将dose和supp的交互效应可视化</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>HH<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> interaction.plot<span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">,</span> ToothGrowth<span class="operator">$</span>supp<span class="punctuation">,</span> ToothGrowth<span class="operator">$</span>len<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="多元方差分析">多元方差分析</h4><p>当因变量不止一个时，可以使用多元方差分析</p><p>MASS包UScereal数据集</p><p>自变量：货架shelf</p><p>因变量：谷物所含卡路里calories、脂肪fat、糖sugars</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>MASS<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> attach<span class="punctuation">(</span>UScereal<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># aggregate()只接受一个值，cbind()连接</span></span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>calories<span class="punctuation">,</span> fat<span class="punctuation">,</span> sugars<span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>shelf<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">Error <span class="keyword">in</span> mean.default<span class="punctuation">(</span>X<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="operator">:</span> <span class="string">&#x27;trim&#x27;</span>必需是长度必需为一的数值</span><br><span class="line">In addition<span class="operator">:</span> Warning message<span class="operator">:</span></span><br><span class="line">In <span class="keyword">if</span> <span class="punctuation">(</span>na.rm<span class="punctuation">)</span> x <span class="operator">&lt;-</span> x<span class="punctuation">[</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">:</span></span><br><span class="line">  the condition has <span class="built_in">length</span> <span class="operator">&gt;</span> <span class="number">1</span> and only the first element will be used</span><br><span class="line"><span class="operator">&gt;</span> aggregate<span class="punctuation">(</span>cbind<span class="punctuation">(</span>calories<span class="punctuation">,</span> fat<span class="punctuation">,</span> sugars<span class="punctuation">)</span><span class="punctuation">,</span> by<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>shelf<span class="punctuation">)</span><span class="punctuation">,</span> FUN<span class="operator">=</span>mean<span class="punctuation">)</span></span><br><span class="line">  Group.1 calories       fat    sugars</span><br><span class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">119.4774</span> <span class="number">0.6621338</span>  <span class="number">6.295493</span></span><br><span class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">129.8162</span> <span class="number">1.3413488</span> <span class="number">12.507670</span></span><br><span class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">180.1466</span> <span class="number">1.9449071</span> <span class="number">10.856821</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自变量转化为因子</span></span><br><span class="line"><span class="operator">&gt;</span> shelf <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>shelf<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># +号只能写右边，同样cbind()连接</span></span><br><span class="line"><span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> manova<span class="punctuation">(</span>cbind<span class="punctuation">(</span>calories<span class="punctuation">,</span> fat<span class="punctuation">,</span> sugars<span class="punctuation">)</span><span class="operator">~</span>shelf<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">          Df Pillai approx <span class="built_in">F</span> num Df den Df    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">shelf      <span class="number">2</span> <span class="number">0.4021</span>   <span class="number">5.1167</span>      <span class="number">6</span>    <span class="number">122</span> <span class="number">0.0001015</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals <span class="number">62</span>                                            </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出单变量结果</span></span><br><span class="line"><span class="operator">&gt;</span> summary.aov<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"> Response calories <span class="operator">:</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line">shelf        <span class="number">2</span>  <span class="number">50435</span> <span class="number">25217.6</span>  <span class="number">7.8623</span> <span class="number">0.0009054</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span> <span class="number">198860</span>  <span class="number">3207.4</span>                      </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> Response fat <span class="operator">:</span></span><br><span class="line">            Df Sum Sq Mean Sq <span class="built_in">F</span> value  Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>  </span><br><span class="line">shelf        <span class="number">2</span>  <span class="number">18.44</span>  <span class="number">9.2199</span>  <span class="number">3.6828</span> <span class="number">0.03081</span> <span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span> <span class="number">155.22</span>  <span class="number">2.5035</span>                  </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> Response sugars <span class="operator">:</span></span><br><span class="line">            Df  Sum Sq Mean Sq <span class="built_in">F</span> value   Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>   </span><br><span class="line">shelf        <span class="number">2</span>  <span class="number">381.33</span> <span class="number">190.667</span>  <span class="number">6.5752</span> <span class="number">0.002572</span> <span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Residuals   <span class="number">62</span> <span class="number">1797.87</span>  <span class="number">28.998</span>                    </span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Student’s-t-test">Student’s t test</h3><p>学生 t 检验（student’s t test，也称 t-test）是一种统计检验，用于比较两组的均值。在假设检验中常用于确定某个过程、处理是否对目标真的有显著影响，或者两组是否有显著差异。</p><p>比如：想知道鸢尾花的平均花瓣长度是否和花的种类有关，收集两种鸢尾花的花瓣长度数据，每组测量25次，可使用 t 检验检测两组之间的差异。</p><p>零假设 H<sub>0</sub>：两组均值之间的真实差异为零，即没有差异</p><p>备择假设H<sub>a</sub>：真实差异不为零</p><p>适用情况： t 检验只能用于比较两组的均值（也称成对比较），如果想比较两组以上，用 ANOVA 检验或 post-hoc test。</p><p><strong>t 检验假设</strong></p><ol><li>数据之间相互独立</li><li>数据满足（或近似满足）正态分布</li><li>方差同质性：被比较的组的方差相似</li></ol><p>若数据不满足要求，可以尝试非参数检验（nonparametric test），如 Wilcoxon Signed-Rank test。</p><p><strong>t 检验类型</strong></p><p>one-sample，two-sample，paired t-test？</p><ul><li>paired t-test，配对样本均值检验：组来自同一类别（如某种处理的前后测量）</li><li>two-sample，两独立样本均值检验：组来自两个不同类别（如两种物种，来自两个城市的人），也即 independent t-stet</li><li>one-sample，单样本均值检验：一组和标准值相比较（如将液体的 ph 与中性 ph7 相比）</li></ul><p>one-tailed，two-tailed t-test？</p><ul><li>two-tailed， 双侧 t 检验：只关注两组是否有差异</li><li>one-tailed，单侧 t 检验：需要知道两组的均值谁大谁小</li></ul><p>如想知道鸢尾花的平均花瓣长度是否和花的种类有关，观测来自两种花，故使用 two-sample t-test；只关注是否有差异，故使用 two-tailed t-test。</p><p><strong>t 检验方程</strong></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mover accent="true"><msub><mi>x</mi><mn>1</mn></msub><mo>ˉ</mo></mover><mo>−</mo><mover accent="true"><msub><mi>x</mi><mn>2</mn></msub><mo>ˉ</mo></mover></mrow><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="false">)</mo></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">t=\frac{\bar{x_{1}}-\bar{x_{2}}}{\sqrt{s^{2}(\frac{1}{n_{1} }+ \frac{1}{n_{2} })} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9903em;vertical-align:-1.73em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.185em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.185em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.145em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.655em;"><span></span></span></span></span></span></span></span><span style="top:-3.415em;"><span class="pstrut" style="height:3.185em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.862em;"><span class="pstrut" style="height:3.185em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>式中，t 为 t 值，x1，x2是两组的均值，s两组的合并标准误差，n1，n2是每组的观测个数</p><p>t 值大，则两组的均值差异大于合并标准误差，表明两组的差异显著</p><p><strong>实例</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检验鸢尾花花瓣长度是否与花的种类有关</span></span><br><span class="line"><span class="comment"># Petal.Length：花瓣长度</span></span><br><span class="line"><span class="comment"># Species：花种类</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> flower.data <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;flower.data.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;character&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为因子</span></span><br><span class="line"><span class="operator">&gt;</span> flower.data<span class="operator">$</span>Species <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>flower.data<span class="punctuation">)</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>  setosa</span><br><span class="line"><span class="number">5</span>          <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.7</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">   setosa virginica </span><br><span class="line">       <span class="number">25</span>        <span class="number">25</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># two-sample two-tailed t test</span></span><br><span class="line"><span class="operator">&gt;</span> t.test<span class="punctuation">(</span>Petal.Length<span class="operator">~</span>Species<span class="punctuation">,</span> flower.data<span class="punctuation">,</span> paired<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span> alternative<span class="operator">=</span><span class="string">&#x27;two.sided&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Welch Two Sample t<span class="operator">-</span>test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  Petal.Length by Species</span><br><span class="line">t <span class="operator">=</span> <span class="operator">-</span><span class="number">33.719</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">30.196</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line">alternative hypothesis<span class="operator">:</span> true difference <span class="keyword">in</span> means between group setosa and group virginica is not equal to <span class="number">0</span></span><br><span class="line"><span class="number">95</span> percent confidence interval<span class="operator">:</span></span><br><span class="line"> <span class="operator">-</span><span class="number">4.331287</span> <span class="operator">-</span><span class="number">3.836713</span></span><br><span class="line">sample estimates<span class="operator">:</span></span><br><span class="line">   mean <span class="keyword">in</span> group setosa mean <span class="keyword">in</span> group virginica </span><br><span class="line">                  <span class="number">1.456</span>                   <span class="number">5.540</span> </span><br></pre></td></tr></table></figure><p><code>t.test()</code>输出内容解释</p><ul><li><code>data</code>：对比项</li><li><code>t</code>值：-33.719，虽然是负的，但是大多数情况下，只关注其绝对值</li><li><code>df</code>：自由度，30.196，自由度与样本大小有关，表示有多少数据点可用于比较，自由度越大，统计检验越有效</li><li><code>p</code>值：2.2e-16，偶然得到这样的<code>t</code>值的概率</li><li><code>alternative hypothesis</code>：备择假设，setosa 和 virginica 组的真实均值差异不为0</li><li><code>95% confidence interval</code>：95% 置信区间，真实的均值差在 95% 可能性下所处的区间，即两组的真实均值差有 95% 可能性处于<code>[-4.331287, -3.836713]</code>区间内；可以更改区间，但 95% 常用</li><li><code>mean</code>：各组的均值</li></ul><p>由以上结果，样本数据的均值差 = 1.456 - 5.540 = -4.084，置信区间显示均值的真实差异在<code>[-4.331287, -3.836713]</code>之间。所以，95% 的情况下均值的真实差异不为0。<code>p</code>值远小于 0.05，所以可以拒绝原假设（均值差异为0），即可以说，均值的真实差异显著不为0。</p><p><strong>t 检验总结方式</strong></p><p>展示重要的信息：t 值，p 值，自由度</p><p>也可以带上均值（mean）和标准差差（standard deviation）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> flower.data <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>summarize<span class="punctuation">(</span>mean_length<span class="operator">=</span>mean<span class="punctuation">(</span>Petal.Length<span class="punctuation">)</span><span class="punctuation">,</span>sd_length<span class="operator">=</span>sd<span class="punctuation">(</span>Petal.Length<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 2 x 3</span></span><br><span class="line">  Species   mean_length sd_length</span><br><span class="line">  <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>           <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> setosa           <span class="number">1.46</span>     <span class="number">0.206</span></span><br><span class="line"><span class="number">2</span> virginica        <span class="number">5.54</span>     <span class="number">0.569</span></span><br></pre></td></tr></table></figure><h3 id="功效分析">功效分析</h3><p>power analysis，可以帮助在给定置信度的情况下，判断检测到给定效应值所需的样本量。反过来，也可以在给定置信度水平情况下，计算某样本量内能检测到给定效应值的概率。</p><p>理论基础</p><ol><li>样本大小<code>n</code>：实验设计中每种条件/组中观测的数目</li><li>显著性水平<code>p</code>（也称alpha）：Type I error probability。也可把他看做是发现效应不发生的概率</li><li>功效<code>1-p</code>：1 minus Type II error probability。可把他看成是真实效应发生的概率</li><li>效应值<code>ES</code>：在备择假设或研究假设下效应的量。效应值的表达式依赖于假设检验中使用的统计方法</li></ol><p>功效分析中研究设计的四个基本量，知三求一</p><p>R中使用<code>pwr</code>包进行功效分析，根据不同的假设检验选择不同的函数</p><p>线性回归的功效分析：<code>pwr.f2.test()</code></p><p>假设要研究老板风格对员工满意度的影响，是否超过薪水和消费对员工满意度的影响。老板风格用4个变量来估计，薪水和小费与3个变量有关。已有研究表明，薪水和小费能够解释约30%员工满意度的方差，而从现实出发，老板风格至少能解释35%的方差，假定显著性水平为0.05，在90%的置信度水平下，需要多少受试者，才能得到这样的方差贡献率？</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linear Models</span></span><br><span class="line"><span class="comment"># sig.level：显著性水平，默认0.05；power：功效水平；u, v：分子自由度和分母自由度；f2：效应值</span></span><br><span class="line"><span class="operator">&gt;</span> pwr.f2.test<span class="punctuation">(</span>u<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span> f2<span class="operator">=</span><span class="number">0.0769</span><span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">0.05</span><span class="punctuation">,</span> power<span class="operator">=</span><span class="number">0.90</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Multiple regression power calculation </span><br><span class="line"></span><br><span class="line">              u <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">              v <span class="operator">=</span> <span class="number">184.2426</span> <span class="comment"># 至少需要185个样本</span></span><br><span class="line">             f2 <span class="operator">=</span> <span class="number">0.0769</span>   <span class="comment"># f2通过计算得来</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.9</span></span><br></pre></td></tr></table></figure><p>方差分析：<code>pwr.anova.test()</code></p><p>假设2组样品做单因素方差分析，要达到0.9的功效，效应值为0.25，并选择0.05的显著性水平，求每一组的样本量</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ANOVA</span></span><br><span class="line"><span class="comment"># k：组数；n：每组的样本大小；f：效应值；sig.level：显著性水平；power：功效</span></span><br><span class="line"><span class="operator">&gt;</span> pwr.anova.test<span class="punctuation">(</span>k<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>f<span class="operator">=</span><span class="number">.25</span><span class="punctuation">,</span>sig.level<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span>power<span class="operator">=</span><span class="number">.9</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Balanced one<span class="operator">-</span>way analysis of variance power calculation </span><br><span class="line"></span><br><span class="line">              k <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">              n <span class="operator">=</span> <span class="number">85.03128</span> <span class="comment"># 每组需要86个样本，总样本大小×2</span></span><br><span class="line">              f <span class="operator">=</span> <span class="number">0.25</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.9</span></span><br><span class="line"></span><br><span class="line">NOTE<span class="operator">:</span> n is number <span class="keyword">in</span> each group</span><br></pre></td></tr></table></figure><p>t检验：<code>pwr.t.test()</code></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># t tests</span></span><br><span class="line"><span class="comment"># n：每组样本大小；d：效应值，即标准化的均值之差</span></span><br><span class="line"><span class="comment"># sig.level：显著性水平；power：功效；type：t检验类型（单样本、双样本或相依样本）</span></span><br><span class="line"><span class="comment"># alternative：统计检验为双侧还是单侧检验</span></span><br><span class="line"><span class="operator">&gt;</span> pwr.t.test<span class="punctuation">(</span>d<span class="operator">=</span><span class="number">.8</span><span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span>power<span class="operator">=</span><span class="number">.9</span><span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;two.sample&quot;</span><span class="punctuation">,</span>  </span><br><span class="line">           alternative<span class="operator">=</span><span class="string">&quot;two.sided&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Two<span class="operator">-</span>sample t test power calculation </span><br><span class="line"></span><br><span class="line">              n <span class="operator">=</span> <span class="number">33.82555</span></span><br><span class="line">              d <span class="operator">=</span> <span class="number">0.8</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.9</span></span><br><span class="line">    alternative <span class="operator">=</span> two.sided</span><br><span class="line"></span><br><span class="line">NOTE<span class="operator">:</span> n is number <span class="keyword">in</span> <span class="operator">*</span>each<span class="operator">*</span> group</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> pwr.t.test<span class="punctuation">(</span>n<span class="operator">=</span><span class="number">20</span><span class="punctuation">,</span> d<span class="operator">=</span><span class="number">.5</span><span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">.01</span><span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;two.sample&quot;</span><span class="punctuation">,</span> </span><br><span class="line">           alternative<span class="operator">=</span><span class="string">&quot;two.sided&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">     Two<span class="operator">-</span>sample t test power calculation </span><br><span class="line"></span><br><span class="line">              n <span class="operator">=</span> <span class="number">20</span></span><br><span class="line">              d <span class="operator">=</span> <span class="number">0.5</span></span><br><span class="line">      sig.level <span class="operator">=</span> <span class="number">0.01</span></span><br><span class="line">          power <span class="operator">=</span> <span class="number">0.1439551</span></span><br><span class="line">    alternative <span class="operator">=</span> two.sided</span><br><span class="line"></span><br><span class="line">NOTE<span class="operator">:</span> n is number <span class="keyword">in</span> <span class="operator">*</span>each<span class="operator">*</span> group</span><br></pre></td></tr></table></figure><p>相关性</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Correlations</span></span><br><span class="line">pwr.r.test<span class="punctuation">(</span>r<span class="operator">=</span><span class="number">.25</span><span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span> power<span class="operator">=</span><span class="number">.90</span><span class="punctuation">,</span> alternative<span class="operator">=</span><span class="string">&quot;greater&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>比例检验</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Tests of proportions</span></span><br><span class="line">pwr.2p.test<span class="punctuation">(</span>h<span class="operator">=</span>ES.h<span class="punctuation">(</span><span class="number">.65</span><span class="punctuation">,</span> <span class="number">.6</span><span class="punctuation">)</span><span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span> power<span class="operator">=</span><span class="number">.9</span><span class="punctuation">,</span> </span><br><span class="line">            alternative<span class="operator">=</span><span class="string">&quot;greater&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>卡方检验</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Chi-square tests</span></span><br><span class="line">prob <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">.42</span><span class="punctuation">,</span> <span class="number">.28</span><span class="punctuation">,</span> <span class="number">.03</span><span class="punctuation">,</span> <span class="number">.07</span><span class="punctuation">,</span> <span class="number">.10</span><span class="punctuation">,</span> <span class="number">.10</span><span class="punctuation">)</span><span class="punctuation">,</span> byrow<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> nrow<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">ES.w2<span class="punctuation">(</span>prob<span class="punctuation">)</span></span><br><span class="line">pwr.chisq.test<span class="punctuation">(</span>w<span class="operator">=</span><span class="number">.1853</span><span class="punctuation">,</span> df<span class="operator">=</span><span class="number">3</span> <span class="punctuation">,</span> sig.level<span class="operator">=</span><span class="number">.05</span><span class="punctuation">,</span> power<span class="operator">=</span><span class="number">.9</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="广义线性模型">广义线性模型</h3><p>前面所学的线性回归和方差分析基于正态分布的假设</p><p>许多变量并不是正态分布</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;robust&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>breslow.dat<span class="punctuation">,</span> package<span class="operator">=</span><span class="string">&#x27;robust&#x27;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>breslow.dat<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">fit <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>sumY<span class="operator">~</span>Base<span class="operator">+</span>Age<span class="operator">+</span>Trt<span class="punctuation">,</span> data<span class="operator">=</span>breslow.dat<span class="punctuation">,</span> family <span class="operator">=</span> poisson<span class="punctuation">(</span>link <span class="operator">=</span> <span class="string">&#x27;log&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line">coef<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">exp</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="R语言作图">R语言作图</h2><h3 id="条形图">条形图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/homo_length.csv&#x27;</span><span class="punctuation">)</span> <span class="comment"># 可加参数 header = FALSE，不读表头</span></span><br><span class="line"><span class="comment"># 取所需数据</span></span><br><span class="line">xx</span><br><span class="line">xx <span class="operator">&lt;-</span> x<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">xx<span class="operator">$</span>chr <span class="comment"># $查看</span></span><br><span class="line">xx<span class="operator">$</span><span class="built_in">length</span></span><br><span class="line"><span class="comment"># 画图</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">)</span> <span class="comment"># 先画基本图，避免报错</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">,</span> names.arg <span class="operator">=</span> xx<span class="operator">$</span>chr<span class="punctuation">)</span> <span class="comment"># 每个条形加标签</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">,</span> names.arg <span class="operator">=</span> xx<span class="operator">$</span>chr<span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="comment"># 改变标尺数字方向</span></span><br><span class="line">yanse <span class="operator">&lt;-</span> sample<span class="punctuation">(</span>colours<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">24</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 设置随机颜色</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">,</span> names.arg <span class="operator">=</span> xx<span class="operator">$</span>chr<span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">)</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">,</span> names.arg <span class="operator">=</span> xx<span class="operator">$</span>chr<span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">,</span> border <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 取消条形图描边</span></span><br><span class="line">barplot<span class="punctuation">(</span>height <span class="operator">=</span> xx<span class="operator">$</span><span class="built_in">length</span><span class="punctuation">,</span> names.arg <span class="operator">=</span> xx<span class="operator">$</span>chr<span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">,</span> border <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Human Chromosome Length Distribution&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Chromosome&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Length&#x27;</span><span class="punctuation">)</span> <span class="comment"># 设置图表标题、坐标轴标题</span></span><br></pre></td></tr></table></figure><h3 id="分组条形图">分组条形图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>file <span class="operator">=</span> <span class="string">&#x27;../Rdata/sv_distrubution.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="comment"># 第一列作为行名</span></span><br><span class="line">tail<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 查看最末或最前几行</span></span><br><span class="line">head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 画图</span></span><br><span class="line">barplot<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># x为数据框，转换为矩阵</span></span><br><span class="line">barplot<span class="punctuation">(</span>t<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 转置一下</span></span><br><span class="line">barplot<span class="punctuation">(</span>t<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> beside <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 默认堆砌，可以转换为分组</span></span><br><span class="line">colnames<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 矩阵每列名称，即表头</span></span><br><span class="line">barplot<span class="punctuation">(</span>t<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> colnames<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment">#将图例设置为列名</span></span><br><span class="line">barplot<span class="punctuation">(</span>t<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> colnames<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">800</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 设置y轴范围</span></span><br><span class="line">barplot<span class="punctuation">(</span>t<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> colnames<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">800</span><span class="punctuation">)</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;SV Distribution&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Numbers&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Chromosomes&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="直方图">直方图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据，跳过前7行，字符串取消用&#x27;&#x27;显示</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;../Rdata/H37Rv.gff&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> skip <span class="operator">=</span> <span class="number">7</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line">View<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="operator">==</span><span class="string">&#x27;gene&#x27;</span><span class="punctuation">)</span> <span class="comment">#取类型为gene的行</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span></span><br><span class="line">x<span class="punctuation">[</span>x<span class="operator">$</span>V3<span class="operator">==</span><span class="string">&#x27;gene&#x27;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">x <span class="operator">&lt;-</span> x<span class="punctuation">[</span>x<span class="operator">$</span>V3<span class="operator">==</span><span class="string">&#x27;gene&#x27;</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">x <span class="operator">&lt;-</span> <span class="built_in">abs</span><span class="punctuation">(</span>x<span class="operator">$</span>V5<span class="operator">-</span>x<span class="operator">$</span>V4<span class="operator">+</span><span class="number">1</span><span class="punctuation">)</span> <span class="comment"># 计算基因长度，保险起见加绝对值</span></span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">3978</span></span><br><span class="line"><span class="built_in">range</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 范围</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>    <span class="number">61</span> <span class="number">12456</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">)</span> <span class="comment"># 分成80个</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">500</span><span class="punctuation">,</span><span class="number">1000</span><span class="punctuation">,</span><span class="number">1500</span><span class="punctuation">,</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">2500</span><span class="punctuation">,</span><span class="number">15000</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 也可以手动设置范围</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">,</span> freq <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 默认以频数显示，可以改成频率</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">,</span> freq <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> density <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">,</span> freq <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> density <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;pink&#x27;</span><span class="punctuation">)</span></span><br><span class="line">hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">,</span> freq <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;histogram of Gene Length&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Gene Length (bp)&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">h <span class="operator">&lt;-</span> hist<span class="punctuation">(</span>x<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="number">80</span><span class="punctuation">,</span> freq <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;histogram of Gene Length&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Gene Length (bp)&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>h<span class="punctuation">)</span> <span class="comment"># h包含了此直方图的所有信息</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;histogram&quot;</span></span><br><span class="line">h<span class="operator">$</span>xname</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;x&quot;</span></span><br><span class="line">h<span class="operator">$</span>breaks</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>     <span class="number">0</span>   <span class="number">200</span>   <span class="number">400</span>   <span class="number">600</span>   <span class="number">800</span>  <span class="number">1000</span>  <span class="number">1200</span>  <span class="number">1400</span>  <span class="number">1600</span>  <span class="number">1800</span>  <span class="number">2000</span>  <span class="number">2200</span>  <span class="number">2400</span>  <span class="number">2600</span>  <span class="number">2800</span>  <span class="number">3000</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">17</span><span class="punctuation">]</span>  <span class="number">3200</span>  <span class="number">3400</span>  <span class="number">3600</span>  <span class="number">3800</span>  <span class="number">4000</span>  <span class="number">4200</span>  <span class="number">4400</span>  <span class="number">4600</span>  <span class="number">4800</span>  <span class="number">5000</span>  <span class="number">5200</span>  <span class="number">5400</span>  <span class="number">5600</span>  <span class="number">5800</span>  <span class="number">6000</span>  <span class="number">6200</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">33</span><span class="punctuation">]</span>  <span class="number">6400</span>  <span class="number">6600</span>  <span class="number">6800</span>  <span class="number">7000</span>  <span class="number">7200</span>  <span class="number">7400</span>  <span class="number">7600</span>  <span class="number">7800</span>  <span class="number">8000</span>  <span class="number">8200</span>  <span class="number">8400</span>  <span class="number">8600</span>  <span class="number">8800</span>  <span class="number">9000</span>  <span class="number">9200</span>  <span class="number">9400</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>  <span class="number">9600</span>  <span class="number">9800</span> <span class="number">10000</span> <span class="number">10200</span> <span class="number">10400</span> <span class="number">10600</span> <span class="number">10800</span> <span class="number">11000</span> <span class="number">11200</span> <span class="number">11400</span> <span class="number">11600</span> <span class="number">11800</span> <span class="number">12000</span> <span class="number">12200</span> <span class="number">12400</span> <span class="number">12600</span></span><br><span class="line">h<span class="operator">$</span>counts</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">120</span> <span class="number">548</span> <span class="number">578</span> <span class="number">601</span> <span class="number">571</span> <span class="number">430</span> <span class="number">356</span> <span class="number">268</span> <span class="number">165</span>  <span class="number">84</span>  <span class="number">55</span>  <span class="number">43</span>  <span class="number">27</span>  <span class="number">20</span>  <span class="number">24</span>  <span class="number">12</span>  <span class="number">12</span>  <span class="number">13</span>   <span class="number">7</span>   <span class="number">5</span>   <span class="number">3</span>   <span class="number">5</span>   <span class="number">4</span>   <span class="number">4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">25</span><span class="punctuation">]</span>   <span class="number">5</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">4</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">2</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">1</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">49</span><span class="punctuation">]</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span></span><br><span class="line">h<span class="operator">$</span>density</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.508296e-04</span> <span class="number">6.887883e-04</span> <span class="number">7.264957e-04</span> <span class="number">7.554047e-04</span> <span class="number">7.176973e-04</span> <span class="number">5.404726e-04</span> <span class="number">4.474610e-04</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">8</span><span class="punctuation">]</span> <span class="number">3.368527e-04</span> <span class="number">2.073906e-04</span> <span class="number">1.055807e-04</span> <span class="number">6.913022e-05</span> <span class="number">5.404726e-05</span> <span class="number">3.393665e-05</span> <span class="number">2.513826e-05</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">15</span><span class="punctuation">]</span> <span class="number">3.016591e-05</span> <span class="number">1.508296e-05</span> <span class="number">1.508296e-05</span> <span class="number">1.633987e-05</span> <span class="number">8.798391e-06</span> <span class="number">6.284565e-06</span> <span class="number">3.770739e-06</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span> <span class="number">6.284565e-06</span> <span class="number">5.027652e-06</span> <span class="number">5.027652e-06</span> <span class="number">6.284565e-06</span> <span class="number">1.256913e-06</span> <span class="number">1.256913e-06</span> <span class="number">1.256913e-06</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">29</span><span class="punctuation">]</span> <span class="number">2.513826e-06</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">5.027652e-06</span> <span class="number">1.256913e-06</span> <span class="number">1.256913e-06</span> <span class="number">0.000000e+00</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">36</span><span class="punctuation">]</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">2.513826e-06</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">43</span><span class="punctuation">]</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">1.256913e-06</span> <span class="number">1.256913e-06</span> <span class="number">0.000000e+00</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">50</span><span class="punctuation">]</span> <span class="number">1.256913e-06</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">1.256913e-06</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">57</span><span class="punctuation">]</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">0.000000e+00</span> <span class="number">1.256913e-06</span></span><br></pre></td></tr></table></figure><h3 id="散点图">散点图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">m <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;../Rdata/prok_representative.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">View<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">gene_number <span class="operator">&lt;-</span> m<span class="operator">$</span>V4</span><br><span class="line">gnome_size <span class="operator">&lt;-</span> m<span class="operator">$</span>V2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置散点类型(0-25)，散点大小</span></span><br><span class="line">plot<span class="punctuation">(</span>gnome_size<span class="punctuation">,</span> gene_number<span class="punctuation">,</span>pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span>cex<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span>xlab <span class="operator">=</span> <span class="string">&#x27;Gnome Size&#x27;</span><span class="punctuation">,</span>ylab <span class="operator">=</span> <span class="string">&#x27;Genes&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 线性回归</span></span><br><span class="line">fit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>gene_number <span class="operator">~</span> gnome_size<span class="punctuation">)</span></span><br><span class="line">fit</span><br><span class="line"></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> gene_number <span class="operator">~</span> gnome_size<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>   gnome_size  </span><br><span class="line">      <span class="number">286.6</span>        <span class="number">843.7</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 画线</span></span><br><span class="line">abline<span class="punctuation">(</span>fit<span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可以直接根据回归结果添加文本</span></span><br><span class="line">text<span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span><span class="number">6000</span><span class="punctuation">,</span>labels<span class="operator">=</span><span class="string">&#x27;y=843.691x+286.598\nR2=0.97&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以设置变量取到相应值，这样不用每次都手动敲</span></span><br><span class="line"><span class="built_in">c</span> <span class="comment"># R2存储位置</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.9676204</span></span><br><span class="line"><span class="built_in">round</span><span class="punctuation">(</span>summary<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="operator">$</span>adj.r.squared<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.97</span></span><br><span class="line">rr <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>summary<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="operator">$</span>adj.r.squared<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">intercept <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>summary<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="operator">$</span>coefficients<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span> <span class="comment"># 截距存储位置</span></span><br><span class="line">intercept</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">286.6</span></span><br><span class="line">slope <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>summary<span class="punctuation">(</span>fit<span class="punctuation">)</span><span class="operator">$</span>coefficients<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span> <span class="comment"># 斜率存储位置</span></span><br><span class="line">slope</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">843.69</span></span><br><span class="line">eq <span class="operator">&lt;-</span> bquote<span class="punctuation">(</span> atop<span class="punctuation">(</span> <span class="string">&quot;y = &quot;</span> <span class="operator">*</span> .<span class="punctuation">(</span>slope<span class="punctuation">)</span> <span class="operator">*</span> <span class="string">&quot; x + &quot;</span> <span class="operator">*</span> .<span class="punctuation">(</span>intercept<span class="punctuation">)</span><span class="punctuation">,</span> R<span class="operator">^</span><span class="number">2</span> <span class="operator">==</span> .<span class="punctuation">(</span>rr<span class="punctuation">)</span> <span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line">text<span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span><span class="number">6000</span><span class="punctuation">,</span>eq<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="饼图">饼图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读文件</span></span><br><span class="line">read.table<span class="punctuation">(</span><span class="string">&#x27;../Rdata/Species.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line">        V1             V2       V3</span><br><span class="line"><span class="number">1</span>  Viruses         noname <span class="number">31.42034</span></span><br><span class="line"><span class="number">2</span> Bacteria  Bacteroidetes <span class="number">31.27472</span></span><br><span class="line"><span class="number">3</span> Bacteria  Fibrobacteres <span class="number">24.74666</span></span><br><span class="line"><span class="number">4</span> Bacteria     Firmicutes  <span class="number">8.06092</span></span><br><span class="line"><span class="number">5</span> Bacteria   Spirochaetes  <span class="number">2.32585</span></span><br><span class="line"><span class="number">6</span>  Archaea  Euryarchaeota  <span class="number">1.42253</span></span><br><span class="line"><span class="number">7</span> Bacteria Proteobacteria  <span class="number">0.74899</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;../Rdata/Species.txt&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 画饼图</span></span><br><span class="line">pie<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 设置数据标签</span></span><br><span class="line">lab <span class="operator">&lt;-</span> paste<span class="punctuation">(</span>x<span class="operator">$</span>V2<span class="punctuation">,</span><span class="string">&#x27;\n&#x27;</span><span class="punctuation">,</span>x<span class="operator">$</span>V3<span class="punctuation">,</span><span class="string">&#x27;%&#x27;</span><span class="punctuation">)</span></span><br><span class="line">lab</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;noname \n 31.42034 %&quot;</span>        <span class="string">&quot;Bacteroidetes \n 31.27472 %&quot;</span> <span class="string">&quot;Fibrobacteres \n 24.74666 %&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;Firmicutes \n 8.06092 %&quot;</span>     <span class="string">&quot;Spirochaetes \n 2.32585 %&quot;</span>   <span class="string">&quot;Euryarchaeota \n 1.42253 %&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;Proteobacteria \n 0.74899 %&quot;</span></span><br><span class="line"><span class="comment"># 设置颜色、饼图半径、标签大小</span></span><br><span class="line"><span class="comment"># pie数据个数多的话，标签容易堆在一起，可以调小字体，还是重叠可以用plotrix的pie.labels()函数</span></span><br><span class="line">pie<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> labels <span class="operator">=</span> lab<span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pie<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> labels <span class="operator">=</span> lab<span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 3D饼图需要plotrix库</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&quot;plotrix&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>plotrix<span class="punctuation">)</span>s</span><br><span class="line"><span class="comment"># pie换成pie3D即可，可以设置explode分割距离</span></span><br><span class="line">pie3D<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> labels <span class="operator">=</span> lab<span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">pie3D<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> labels <span class="operator">=</span> lab<span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> explode <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pie3D.labels()解决标签堆叠问题</span></span><br><span class="line">pieplot3d <span class="operator">&lt;-</span> pie<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> explode <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span></span><br><span class="line">pie3D.labels<span class="punctuation">(</span>pieplot3d<span class="punctuation">,</span>labels <span class="operator">=</span> lab<span class="punctuation">,</span>labelcex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span>labelrad <span class="operator">=</span> <span class="number">1.4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pie.labels()解决标签堆叠问题</span></span><br><span class="line">pieplot3d <span class="operator">&lt;-</span> pie<span class="punctuation">(</span>x<span class="operator">$</span>V3<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span>col <span class="operator">=</span> rainbow<span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">ang <span class="operator">&lt;-</span> floating.pie<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span>x<span class="operator">$</span>V3<span class="punctuation">)</span> <span class="comment"># 标签分散的角度，可以设置成数据的百分比</span></span><br><span class="line">pie.labels<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> angles <span class="operator">=</span> ang<span class="punctuation">,</span> labels<span class="operator">=</span>lab<span class="punctuation">,</span> radius<span class="operator">=</span><span class="number">1.2</span><span class="punctuation">,</span> minangle <span class="operator">=</span> <span class="number">0.17</span><span class="punctuation">)</span> <span class="comment"># 最小角度设置为10/180*pie</span></span><br></pre></td></tr></table></figure><h3 id="箱线图">箱线图</h3><p>箱线图展示了数据的5个指标（最小值、下四分位数、中位数、上四分位数、最大值）和离群点。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">boxplot<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span></span><br><span class="line">fivenum<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span> <span class="comment"># 给出数据的最小值、下四分位数、中位数、上四分位数、最大值</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">10.40</span> <span class="number">15.35</span> <span class="number">19.20</span> <span class="number">22.80</span> <span class="number">33.90</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x ~ y，y为分组因子，多个y用:隔开</span></span><br><span class="line">boxplot<span class="punctuation">(</span>mpg <span class="operator">~</span> cyl<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>hp <span class="operator">~</span> cyl<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="operator">:</span>supp<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>mpg <span class="operator">~</span> cyl<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 颜色</span></span><br><span class="line">boxplot<span class="punctuation">(</span>mpg <span class="operator">~</span> cyl<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span> <span class="comment"># 离散点形状、大小</span></span><br><span class="line">boxplot<span class="punctuation">(</span>mpg <span class="operator">~</span> cyl<span class="punctuation">,</span> data <span class="operator">=</span> mtcars<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;number of cylinders&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;miles/gallon&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> notch <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 显示缺口</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> width <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 指定箱子宽度</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> varwidth <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 箱子宽度与组中观察数的平方根成正比</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> boxwex <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="comment"># 所有箱子宽度等比缩放</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> staplewex <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="comment"># 最大最小值横线的宽度</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="operator">:</span>supp<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;:&#x27;</span><span class="punctuation">)</span> <span class="comment"># 多个分组因子y的分隔符号</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="operator">:</span>supp<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;:&#x27;</span><span class="punctuation">,</span> lex.order <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 箱子排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读数据，第一列作为行名</span></span><br><span class="line">x <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/gene_expression.csv&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">         A1    A2    A3    B1    B2    B3</span><br><span class="line">gene1  <span class="number">0.33</span>  <span class="number">0.13</span>  <span class="number">0.30</span>  <span class="number">0.48</span>  <span class="number">0.37</span>  <span class="number">1.73</span></span><br><span class="line">gene2  <span class="number">0.00</span>  <span class="number">0.00</span>  <span class="number">0.30</span>  <span class="number">0.54</span>  <span class="number">0.43</span>  <span class="number">0.35</span></span><br><span class="line">gene3 <span class="number">10.27</span> <span class="number">10.05</span>  <span class="number">5.51</span> <span class="number">30.95</span> <span class="number">15.85</span> <span class="number">25.72</span></span><br><span class="line">gene4  <span class="number">3.74</span>  <span class="number">4.44</span>  <span class="number">4.24</span>  <span class="number">0.24</span>  <span class="number">0.06</span>  <span class="number">1.04</span></span><br><span class="line">gene5  <span class="number">9.66</span> <span class="number">10.05</span> <span class="number">15.57</span>  <span class="number">6.83</span>  <span class="number">2.66</span>  <span class="number">5.89</span></span><br><span class="line">gene6  <span class="number">0.50</span>  <span class="number">0.64</span>  <span class="number">0.18</span>  <span class="number">0.72</span>  <span class="number">1.24</span>  <span class="number">2.60</span></span><br><span class="line">boxplot<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment"># 可以直接绘制</span></span><br><span class="line">boxplot<span class="punctuation">(</span>x<span class="punctuation">,</span> outline <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 去除离群点</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以用reshape2函数重新组合数据，用x ~ y的方式，推荐这种</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line">x <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">No id variables; using <span class="built_in">all</span> as measure variables</span><br><span class="line">head<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  variable value</span><br><span class="line"><span class="number">1</span>       A1  <span class="number">0.33</span></span><br><span class="line"><span class="number">2</span>       A1  <span class="number">0.00</span></span><br><span class="line"><span class="number">3</span>       A1 <span class="number">10.27</span></span><br><span class="line"><span class="number">4</span>       A1  <span class="number">3.74</span></span><br><span class="line"><span class="number">5</span>       A1  <span class="number">9.66</span></span><br><span class="line"><span class="number">6</span>       A1  <span class="number">0.50</span></span><br><span class="line">boxplot<span class="punctuation">(</span>value <span class="operator">~</span> variable<span class="punctuation">,</span> data <span class="operator">=</span> x<span class="punctuation">,</span> outline <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="热图">热图</h3><p>生信分析中常见的图，根据颜色的深浅反应数值的大小，可用于基因表达的可视化和聚类。</p><p>绘制热图的对象是数值矩阵。</p><p>绘制热图的方法：</p><ol><li><code>heatmap()</code></li><li><code>gplot</code>包<code>heatmap.2()</code></li><li><code>pheatmap</code>包<code>pheatmap()</code></li><li><code>ComplexHeatmap</code>包</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不是数值矩阵要先转换</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;data.frame&quot;</span></span><br><span class="line">heatmap<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">Error <span class="keyword">in</span> heatmap<span class="punctuation">(</span>mtcars<span class="punctuation">)</span> <span class="operator">:</span> <span class="string">&#x27;x&#x27;</span> must be a numeric matrix</span><br><span class="line">heatmap<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果数据差距过大，热图无法分辨，可以加入scale参数按row或col进行标准化</span></span><br><span class="line">heatmap<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="string">&#x27;col&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">m <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/heatmap.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">x <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">heatmap<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">heatmap<span class="punctuation">(</span>t<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 可转置互换坐标轴</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加颜色，但是无渐变不好看</span></span><br><span class="line">heatmap<span class="punctuation">(</span>x<span class="punctuation">,</span> col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成渐变色</span></span><br><span class="line">colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#FF0000&quot;</span> <span class="string">&quot;#ED0000&quot;</span> <span class="string">&quot;#DB0000&quot;</span> <span class="string">&quot;#CA0000&quot;</span> <span class="string">&quot;#B80000&quot;</span> <span class="string">&quot;#A70000&quot;</span> <span class="string">&quot;#950000&quot;</span> <span class="string">&quot;#830000&quot;</span> <span class="string">&quot;#720000&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="string">&quot;#600000&quot;</span> <span class="string">&quot;#4F0000&quot;</span> <span class="string">&quot;#3D0000&quot;</span> <span class="string">&quot;#2B0000&quot;</span> <span class="string">&quot;#1A0000&quot;</span> <span class="string">&quot;#080000&quot;</span> <span class="string">&quot;#000800&quot;</span> <span class="string">&quot;#001A00&quot;</span> <span class="string">&quot;#002B00&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;#003D00&quot;</span> <span class="string">&quot;#004F00&quot;</span> <span class="string">&quot;#006000&quot;</span> <span class="string">&quot;#007200&quot;</span> <span class="string">&quot;#008300&quot;</span> <span class="string">&quot;#009500&quot;</span> <span class="string">&quot;#00A700&quot;</span> <span class="string">&quot;#00B800&quot;</span> <span class="string">&quot;#00CA00&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">28</span><span class="punctuation">]</span> <span class="string">&quot;#00DB00&quot;</span> <span class="string">&quot;#00ED00&quot;</span> <span class="string">&quot;#00FF00&quot;</span></span><br><span class="line">yanse <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span>nrow<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">heatmap<span class="punctuation">(</span>x<span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 添加边色</span></span><br><span class="line">heatmap<span class="punctuation">(</span>x<span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">,</span> ColSideColors <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span>ncol<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> RowSideColors <span class="operator">=</span> yanse<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取消按列或按行聚类</span></span><br><span class="line">heatmap<span class="punctuation">(</span>x<span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">,</span> Colv <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> Rowv <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># heatmap.2()绘制热图</span></span><br><span class="line">library<span class="punctuation">(</span>gplots<span class="punctuation">)</span></span><br><span class="line">m <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/heatmap.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> key <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="comment"># 是否显示图例</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> symkey <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span> <span class="comment"># 图例是否对称</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> symkey <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> symkey <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> density.info <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> symkey <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> trace <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span> <span class="comment"># 是否显示图例</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> symkey <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> tracecol <span class="operator">=</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span> <span class="comment"># 竖线颜色</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> dendrogram <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span> <span class="comment"># 是否聚类</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> dendrogram <span class="operator">=</span> <span class="string">&#x27;row&#x27;</span><span class="punctuation">)</span></span><br><span class="line">heatmap.2<span class="punctuation">(</span>m<span class="punctuation">,</span> dendrogram <span class="operator">=</span> <span class="string">&#x27;col&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pheatmap()</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>m<span class="punctuation">,</span> border_color <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 加入聚类类型</span></span><br><span class="line"><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;N1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;N2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T2&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> each<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;N1&quot;</span> <span class="string">&quot;N1&quot;</span> <span class="string">&quot;N1&quot;</span> <span class="string">&quot;N1&quot;</span> <span class="string">&quot;N1&quot;</span> <span class="string">&quot;T1&quot;</span> <span class="string">&quot;T1&quot;</span> <span class="string">&quot;T1&quot;</span> <span class="string">&quot;T1&quot;</span> <span class="string">&quot;T1&quot;</span> <span class="string">&quot;N2&quot;</span> <span class="string">&quot;N2&quot;</span> <span class="string">&quot;N2&quot;</span> <span class="string">&quot;N2&quot;</span> <span class="string">&quot;N2&quot;</span> <span class="string">&quot;T2&quot;</span> <span class="string">&quot;T2&quot;</span> <span class="string">&quot;T2&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;T2&quot;</span> <span class="string">&quot;T2&quot;</span></span><br><span class="line">factor<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;N1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;N2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T2&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> each<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> N1 N1 N1 N1 N1 T1 T1 T1 T1 T1 N2 N2 N2 N2 N2 T2 T2 T2 T2 T2</span><br><span class="line">Levels<span class="operator">:</span> N1 N2 T1 T2</span><br><span class="line">annotation_col <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>factor<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;N1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;N2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;T2&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> each<span class="operator">=</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">row.names<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="string">&#x27;Cell Type&#x27;</span></span><br><span class="line">head<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span></span><br><span class="line">      Cell Type</span><br><span class="line">N.GD1        N1</span><br><span class="line">N.GD2        N1</span><br><span class="line">N.GD3        N1</span><br><span class="line">N.GD4        N1</span><br><span class="line">N.GD5        N1</span><br><span class="line">T.GD1        T1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="图表设置">图表设置</h3><h4 id="图表参数">图表参数</h4><p>par函数，Parameter简写，设置绘图中的参数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>par<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>xlog</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>ylog</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>adj</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>ann</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>ask</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line"><span class="operator">$</span>bg</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;white&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">?</span>par<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment"># 查看帮助文档</span></span><br><span class="line"><span class="comment"># par()中自带的为默认值，可以更改，如</span></span><br><span class="line">par<span class="punctuation">(</span>pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">)</span> <span class="comment"># 更改点样式，之后绘图均按此值，重启R后恢复到默认值</span></span><br><span class="line"><span class="comment"># 为防止默认值更改，存储可更改的参数</span></span><br><span class="line">opar <span class="operator">&lt;-</span> par<span class="punctuation">(</span>no.readonly <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>opar<span class="punctuation">)</span> <span class="comment"># 恢复默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 具体设置查看帮助文档</span></span><br><span class="line">plot<span class="punctuation">(</span>women<span class="operator">$</span>height<span class="punctuation">,</span>women<span class="operator">$</span>weight<span class="punctuation">,</span>type <span class="operator">=</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span>pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">1.2</span><span class="punctuation">,</span>las<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;This is main title&quot;</span><span class="punctuation">,</span> sub <span class="operator">=</span> <span class="string">&quot;This is sub title&quot;</span><span class="punctuation">,</span>xlab <span class="operator">=</span> <span class="string">&quot;x label&quot;</span><span class="punctuation">,</span>ylab <span class="operator">=</span> <span class="string">&quot;y label&quot;</span><span class="punctuation">,</span></span><br><span class="line">     xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">50</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span>ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">,</span><span class="number">200</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">     adj<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">,</span>bty<span class="operator">=</span><span class="string">&quot;]&quot;</span><span class="punctuation">,</span>tck<span class="operator">=</span><span class="operator">-</span><span class="number">0.03</span><span class="punctuation">,</span></span><br><span class="line">     col<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>fg<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span>col.main<span class="operator">=</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span>col.sub<span class="operator">=</span><span class="string">&#x27;pink&#x27;</span><span class="punctuation">,</span>col.lab<span class="operator">=</span><span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span>col.axis<span class="operator">=</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span></span><br><span class="line">     cex<span class="operator">=</span><span class="number">1.5</span><span class="punctuation">,</span>cex.lab<span class="operator">=</span><span class="number">1.2</span><span class="punctuation">,</span>cex.axis<span class="operator">=</span><span class="number">1.2</span><span class="punctuation">,</span>cex.main<span class="operator">=</span><span class="number">1.5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h4 id="图表颜色">图表颜色</h4><p>颜色选择标准：</p><ol><li>对比明显</li><li>低调内敛</li><li>色盲友好</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">colors<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;white&quot;</span>                <span class="string">&quot;aliceblue&quot;</span>            <span class="string">&quot;antiquewhite&quot;</span>        </span><br><span class="line">  <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;antiquewhite1&quot;</span>        <span class="string">&quot;antiquewhite2&quot;</span>        <span class="string">&quot;antiquewhite3&quot;</span>       </span><br><span class="line">  <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;antiquewhite4&quot;</span>        <span class="string">&quot;aquamarine&quot;</span>           <span class="string">&quot;aquamarine1&quot;</span> </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机抽取颜色</span></span><br><span class="line">sample<span class="punctuation">(</span>colors<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;cadetblue4&quot;</span>      <span class="string">&quot;palegreen4&quot;</span>      <span class="string">&quot;hotpink2&quot;</span>        <span class="string">&quot;lightsteelblue2&quot;</span> <span class="string">&quot;gray12&quot;</span> </span><br><span class="line"></span><br><span class="line">rgb<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#1A334D&quot;</span></span><br><span class="line">hsv<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.3</span><span class="punctuation">)</span> <span class="comment"># 色调（H），饱和度（S），明度（V）</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#4D463D&quot;</span></span><br><span class="line">hcl<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.3</span><span class="punctuation">)</span> <span class="comment"># 色调（H），色度（S），亮度（L）</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#020101&quot;</span></span><br><span class="line">rainbow<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span> <span class="comment"># 彩虹色</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#FF0000&quot;</span> <span class="string">&quot;#CCFF00&quot;</span> <span class="string">&quot;#00FF66&quot;</span> <span class="string">&quot;#0066FF&quot;</span> <span class="string">&quot;#CC00FF&quot;</span></span><br><span class="line"></span><br><span class="line">heat.colors<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#FF0000&quot;</span> <span class="string">&quot;#FF5500&quot;</span> <span class="string">&quot;#FFAA00&quot;</span> <span class="string">&quot;#FFFF00&quot;</span> <span class="string">&quot;#FFFF80&quot;</span></span><br><span class="line">terrain.colors<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#00A600&quot;</span> <span class="string">&quot;#E6E600&quot;</span> <span class="string">&quot;#EAB64E&quot;</span> <span class="string">&quot;#EEB99F&quot;</span> <span class="string">&quot;#F2F2F2&quot;</span></span><br><span class="line">topo.colors<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#4C00FF&quot;</span> <span class="string">&quot;#004CFF&quot;</span> <span class="string">&quot;#00E5FF&quot;</span> <span class="string">&quot;#00FF4D&quot;</span> <span class="string">&quot;#FFFF00&quot;</span></span><br><span class="line">cm.colors<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#80FFFF&quot;</span> <span class="string">&quot;#BFFFFF&quot;</span> <span class="string">&quot;#FFFFFF&quot;</span> <span class="string">&quot;#FFBFFF&quot;</span> <span class="string">&quot;#FF80FF&quot;</span></span><br><span class="line">grey.colors<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#4D4D4D&quot;</span> <span class="string">&quot;#888888&quot;</span> <span class="string">&quot;#AEAEAE&quot;</span> <span class="string">&quot;#CCCCCC&quot;</span> <span class="string">&quot;#E6E6E6&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># R包RColorBrewer带了很多颜色</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">display.brewer.all<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment"># 显示所有颜色集</span></span><br><span class="line">display.brewer.pal<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&#x27;Set3&#x27;</span><span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="comment"># 显示所选颜色</span></span><br><span class="line">brewer.pal<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&#x27;Set3&#x27;</span><span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="comment"># 设置颜色</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#8DD3C7&quot;</span> <span class="string">&quot;#FFFFB3&quot;</span> <span class="string">&quot;#BEBADA&quot;</span> <span class="string">&quot;#FB8072&quot;</span> <span class="string">&quot;#80B1D3&quot;</span></span><br><span class="line">pie<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> col <span class="operator">=</span> brewer.pal<span class="punctuation">(</span><span class="string">&#x27;Set3&#x27;</span><span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 使用时传递给col参数即可</span></span><br></pre></td></tr></table></figure><h3 id="韦恩图">韦恩图</h3><p>一般最少2组，最多5组，再多图很复杂没有意义。</p><p>韦恩图画法：</p><ol><li><code>gplots</code>包<code>venn</code>函数（简单，无颜色）</li><li><code>venneuler</code>包中的<code>venneuler</code>函数（安装失败）</li><li><code>venn</code>包中的<code>venn</code>函数（简单，有颜色，推荐）</li><li><code>vennDiagram</code>包中的<code>venn.Diagram</code>函数（有颜色，图没有上个好看，必须输出文件，无法在<code>plots</code>窗口预览）</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">listA <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/genes_list_A.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">listB <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/genes_list_B.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">listC <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/genes_list_C.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">listD <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/genes_list_D.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">listE <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/genes_list_E.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">A <span class="operator">&lt;-</span> listA<span class="operator">$</span>V1</span><br><span class="line">B <span class="operator">&lt;-</span> listB<span class="operator">$</span>V1</span><br><span class="line">C <span class="operator">&lt;-</span> listC<span class="operator">$</span>V1</span><br><span class="line">D <span class="operator">&lt;-</span> listD<span class="operator">$</span>V1</span><br><span class="line">E <span class="operator">&lt;-</span> listE<span class="operator">$</span>V1</span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span>A<span class="punctuation">)</span>;<span class="built_in">length</span><span class="punctuation">(</span>B<span class="punctuation">)</span>;<span class="built_in">length</span><span class="punctuation">(</span>C<span class="punctuation">)</span>;<span class="built_in">length</span><span class="punctuation">(</span>D<span class="punctuation">)</span>;<span class="built_in">length</span><span class="punctuation">(</span>E<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">562</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">474</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2273</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1735</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">594</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gplots包</span></span><br><span class="line">library<span class="punctuation">(</span>gplots<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 绘图简单，没有颜色</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># vennDiagram包</span></span><br><span class="line">library<span class="punctuation">(</span>VennDiagram<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 需指明输出文件，无法预览</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>sampleC<span class="operator">=</span>C<span class="punctuation">,</span> sampleD<span class="operator">=</span>D<span class="punctuation">)</span><span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># 不输出log文件</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>sampleC<span class="operator">=</span>C<span class="punctuation">,</span> sampleD<span class="operator">=</span>D<span class="punctuation">)</span><span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn2.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span> disable.logging <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="built_in">list</span><span class="punctuation">(</span>sampleC <span class="operator">=</span> C<span class="punctuation">,</span> sampleD <span class="operator">=</span> D<span class="punctuation">)</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> </span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="operator">$</span>filename</span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;venn2.png&quot;</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> </span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="operator">$</span>fill</span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span> <span class="string">&quot;cyan&quot;</span><span class="punctuation">)</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> </span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="operator">$</span>cex</span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1.2</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> </span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="operator">$</span>disable.logging</span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> <span class="built_in">T</span></span><br><span class="line">INFO <span class="punctuation">[</span><span class="number">2022</span><span class="operator">-</span><span class="number">02</span><span class="operator">-</span><span class="number">01</span> <span class="number">17</span><span class="operator">:</span><span class="number">06</span><span class="operator">:</span><span class="number">37</span><span class="punctuation">]</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># 三维</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>sampleC<span class="operator">=</span>C<span class="punctuation">,</span> sampleD<span class="operator">=</span>D<span class="punctuation">,</span> sampleA<span class="operator">=</span>A<span class="punctuation">)</span><span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn3.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span> disable.logging <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 四维</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>sampleC<span class="operator">=</span>C<span class="punctuation">,</span> sampleD<span class="operator">=</span>D<span class="punctuation">,</span> sampleA<span class="operator">=</span>A<span class="punctuation">,</span> sampleB<span class="operator">=</span>B<span class="punctuation">)</span><span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn4.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span> disable.logging <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 五维</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>sampleC<span class="operator">=</span>C<span class="punctuation">,</span> sampleD<span class="operator">=</span>D<span class="punctuation">,</span> sampleA<span class="operator">=</span>A<span class="punctuation">,</span> sampleB<span class="operator">=</span>B<span class="punctuation">,</span> sampleE<span class="operator">=</span>E<span class="punctuation">)</span><span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn5.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;pink&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span> disable.logging <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># venn包</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 不显示方框</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">,</span> box <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 改变边线颜色</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">,</span> box <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 加标签</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">,</span> box <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> snames <span class="operator">=</span> <span class="string">&#x27;Sample A,Sample B,Sample C,Sample D,Sample E&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 加颜色</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">,</span> box <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> snames <span class="operator">=</span> <span class="string">&#x27;Sample A,Sample B,Sample C,Sample D,Sample E&#x27;</span><span class="punctuation">,</span> zcolor <span class="operator">=</span> <span class="string">&#x27;red, green, purple, blue, cyan&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 如果可以，强制形状为椭圆</span></span><br><span class="line">venn<span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>A<span class="punctuation">,</span>B<span class="punctuation">,</span>C<span class="punctuation">,</span>D<span class="punctuation">,</span>E<span class="punctuation">)</span><span class="punctuation">,</span> box <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> snames <span class="operator">=</span> <span class="string">&#x27;Sample A,Sample B,Sample C,Sample D,Sample E&#x27;</span><span class="punctuation">,</span> zcolor <span class="operator">=</span> <span class="string">&#x27;red, green, purple, blue, cyan&#x27;</span><span class="punctuation">,</span> ellipse <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="曼哈顿图">曼哈顿图</h3><p>曼哈顿图是用二维散点图展示大量数据的方法，主要用于全基因组关联分析。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>qqman<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 此包内置数据集，导入数据时也要是这样的格式</span></span><br><span class="line">gwasResults</span><br><span class="line">      SNP CHR  BP            P</span><br><span class="line"><span class="number">1</span>     rs1   <span class="number">1</span>   <span class="number">1</span> <span class="number">0.9148060435</span></span><br><span class="line"><span class="number">2</span>     rs2   <span class="number">1</span>   <span class="number">2</span> <span class="number">0.9370754133</span></span><br><span class="line"><span class="number">3</span>     rs3   <span class="number">1</span>   <span class="number">3</span> <span class="number">0.2861395348</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加标题，设置y轴范围，散点大小，轴字体大小</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Manhattan Plot&#x27;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> cex.axis <span class="operator">=</span> <span class="number">0.9</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 控制两根限制条：-log10(1e-5)和-log10(1e-8)</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Manhattan Plot&#x27;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> suggestiveline <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> genomewideline <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加颜色</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Manhattan Plot&#x27;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> cex.axis<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange3&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">yanse <span class="operator">&lt;-</span> brewer.pal<span class="punctuation">(</span><span class="string">&#x27;Set3&#x27;</span><span class="punctuation">,</span> n<span class="operator">=</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Manhattan Plot&#x27;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> cex.axis<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">,</span> col <span class="operator">=</span> yanse<span class="punctuation">,</span> chrlabs <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="string">&#x27;P&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Q&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 染色体标签</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Manhattan Plot&#x27;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> cex.axis<span class="operator">=</span><span class="number">0.9</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> chrlabs <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> <span class="string">&#x27;P&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Q&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 局部显示显著的染色体</span></span><br><span class="line">manhattan<span class="punctuation">(</span>subset<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span>CHR<span class="operator">==</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出感兴趣的snps</span></span><br><span class="line">snpsOfInterest</span><br><span class="line">  <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;rs3001&quot;</span> <span class="string">&quot;rs3002&quot;</span> <span class="string">&quot;rs3003&quot;</span> <span class="string">&quot;rs3004&quot;</span> <span class="string">&quot;rs3005&quot;</span> <span class="string">&quot;rs3006&quot;</span> <span class="string">&quot;rs3007&quot;</span> <span class="string">&quot;rs3008&quot;</span> <span class="string">&quot;rs3009&quot;</span> <span class="string">&quot;rs3010&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">11</span><span class="punctuation">]</span> <span class="string">&quot;rs3011&quot;</span> <span class="string">&quot;rs3012&quot;</span> <span class="string">&quot;rs3013&quot;</span> <span class="string">&quot;rs3014&quot;</span> <span class="string">&quot;rs3015&quot;</span> <span class="string">&quot;rs3016&quot;</span> <span class="string">&quot;rs3017&quot;</span> <span class="string">&quot;rs3018&quot;</span> <span class="string">&quot;rs3019&quot;</span> <span class="string">&quot;rs3020&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">21</span><span class="punctuation">]</span> <span class="string">&quot;rs3021&quot;</span> <span class="string">&quot;rs3022&quot;</span> <span class="string">&quot;rs3023&quot;</span> <span class="string">&quot;rs3024&quot;</span> <span class="string">&quot;rs3025&quot;</span> <span class="string">&quot;rs3026&quot;</span> <span class="string">&quot;rs3027&quot;</span> <span class="string">&quot;rs3028&quot;</span> <span class="string">&quot;rs3029&quot;</span> <span class="string">&quot;rs3030&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">31</span><span class="punctuation">]</span> <span class="string">&quot;rs3031&quot;</span> <span class="string">&quot;rs3032&quot;</span> <span class="string">&quot;rs3033&quot;</span> <span class="string">&quot;rs3034&quot;</span> <span class="string">&quot;rs3035&quot;</span> <span class="string">&quot;rs3036&quot;</span> <span class="string">&quot;rs3037&quot;</span> <span class="string">&quot;rs3038&quot;</span> <span class="string">&quot;rs3039&quot;</span> <span class="string">&quot;rs3040&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">41</span><span class="punctuation">]</span> <span class="string">&quot;rs3041&quot;</span> <span class="string">&quot;rs3042&quot;</span> <span class="string">&quot;rs3043&quot;</span> <span class="string">&quot;rs3044&quot;</span> <span class="string">&quot;rs3045&quot;</span> <span class="string">&quot;rs3046&quot;</span> <span class="string">&quot;rs3047&quot;</span> <span class="string">&quot;rs3048&quot;</span> <span class="string">&quot;rs3049&quot;</span> <span class="string">&quot;rs3050&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">51</span><span class="punctuation">]</span> <span class="string">&quot;rs3051&quot;</span> <span class="string">&quot;rs3052&quot;</span> <span class="string">&quot;rs3053&quot;</span> <span class="string">&quot;rs3054&quot;</span> <span class="string">&quot;rs3055&quot;</span> <span class="string">&quot;rs3056&quot;</span> <span class="string">&quot;rs3057&quot;</span> <span class="string">&quot;rs3058&quot;</span> <span class="string">&quot;rs3059&quot;</span> <span class="string">&quot;rs3060&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">61</span><span class="punctuation">]</span> <span class="string">&quot;rs3061&quot;</span> <span class="string">&quot;rs3062&quot;</span> <span class="string">&quot;rs3063&quot;</span> <span class="string">&quot;rs3064&quot;</span> <span class="string">&quot;rs3065&quot;</span> <span class="string">&quot;rs3066&quot;</span> <span class="string">&quot;rs3067&quot;</span> <span class="string">&quot;rs3068&quot;</span> <span class="string">&quot;rs3069&quot;</span> <span class="string">&quot;rs3070&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">71</span><span class="punctuation">]</span> <span class="string">&quot;rs3071&quot;</span> <span class="string">&quot;rs3072&quot;</span> <span class="string">&quot;rs3073&quot;</span> <span class="string">&quot;rs3074&quot;</span> <span class="string">&quot;rs3075&quot;</span> <span class="string">&quot;rs3076&quot;</span> <span class="string">&quot;rs3077&quot;</span> <span class="string">&quot;rs3078&quot;</span> <span class="string">&quot;rs3079&quot;</span> <span class="string">&quot;rs3080&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">81</span><span class="punctuation">]</span> <span class="string">&quot;rs3081&quot;</span> <span class="string">&quot;rs3082&quot;</span> <span class="string">&quot;rs3083&quot;</span> <span class="string">&quot;rs3084&quot;</span> <span class="string">&quot;rs3085&quot;</span> <span class="string">&quot;rs3086&quot;</span> <span class="string">&quot;rs3087&quot;</span> <span class="string">&quot;rs3088&quot;</span> <span class="string">&quot;rs3089&quot;</span> <span class="string">&quot;rs3090&quot;</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">91</span><span class="punctuation">]</span> <span class="string">&quot;rs3091&quot;</span> <span class="string">&quot;rs3092&quot;</span> <span class="string">&quot;rs3093&quot;</span> <span class="string">&quot;rs3094&quot;</span> <span class="string">&quot;rs3095&quot;</span> <span class="string">&quot;rs3096&quot;</span> <span class="string">&quot;rs3097&quot;</span> <span class="string">&quot;rs3098&quot;</span> <span class="string">&quot;rs3099&quot;</span> <span class="string">&quot;rs3100&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 高亮显示感兴趣的snps</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> highlight <span class="operator">=</span> snpsOfInterest<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标注满足p值的rs</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> annotatePval <span class="operator">=</span> <span class="number">0.001</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 默认只显示最顶部的rs，可全部显示</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> annotatePval <span class="operator">=</span> <span class="number">0.001</span><span class="punctuation">,</span> annotateTop <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="火山图">火山图</h3><p>散点图的一种，主要用于基因表达的分析中。</p><p>自带散点图</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据</span></span><br><span class="line">m <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/Deseq2.csv&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">                    baseMean log2FoldChange      lfcSE       stat       pvalue         padj</span><br><span class="line">ENSG00000000003  <span class="number">708.6021697</span>    <span class="operator">-</span><span class="number">0.38125397</span> <span class="number">0.10065597</span> <span class="operator">-</span><span class="number">3.7876937</span> <span class="number">1.520521e-04</span> <span class="number">0.0012815112</span></span><br><span class="line">ENSG00000000419  <span class="number">520.2979006</span>     <span class="number">0.20681259</span> <span class="number">0.11222180</span>  <span class="number">1.8428915</span> <span class="number">6.534485e-02</span> <span class="number">0.1962308610</span></span><br><span class="line">ENSG00000000457  <span class="number">237.1630368</span>     <span class="number">0.03792034</span> <span class="number">0.14345322</span>  <span class="number">0.2643394</span> <span class="number">7.915184e-01</span> <span class="number">0.9112208706</span></span><br><span class="line">ENSG00000000460   <span class="number">57.9326331</span>    <span class="operator">-</span><span class="number">0.08816367</span> <span class="number">0.28716771</span> <span class="operator">-</span><span class="number">0.3070111</span> <span class="number">7.588349e-01</span> <span class="number">0.8946714454</span></span><br><span class="line">ENSG00000000938    <span class="number">0.3180984</span>    <span class="operator">-</span><span class="number">1.37822703</span> <span class="number">3.49987280</span> <span class="operator">-</span><span class="number">0.3937935</span> <span class="number">6.937335e-01</span>           <span class="literal">NA</span></span><br><span class="line">ENSG00000000971 <span class="number">5817.3528677</span>     <span class="number">0.42640216</span> <span class="number">0.08831006</span>  <span class="number">4.8284666</span> <span class="number">1.375884e-06</span> <span class="number">0.0000181641</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除NA</span></span><br><span class="line">m <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 画图</span></span><br><span class="line">plot<span class="punctuation">(</span>m<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span>m<span class="operator">$</span>padj<span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>m<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span><span class="operator">-</span>log10<span class="punctuation">(</span>m<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span> cex<span class="operator">=</span><span class="number">0.6</span><span class="punctuation">,</span> xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一次性计算-log10(m$padj)并赋值</span></span><br><span class="line">transform<span class="punctuation">(</span>m<span class="punctuation">,</span>padj<span class="operator">=</span><span class="operator">-</span>log10<span class="punctuation">(</span>m<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">                   baseMean log2FoldChange      lfcSE         stat       pvalue         padj</span><br><span class="line">ENSG00000000003  <span class="number">708.602170</span>  <span class="operator">-</span><span class="number">0.3812539747</span> <span class="number">0.10065597</span> <span class="operator">-</span><span class="number">3.787693677</span> <span class="number">1.520521e-04</span> <span class="number">2.892278e+00</span></span><br><span class="line">ENSG00000000419  <span class="number">520.297901</span>   <span class="number">0.2068125935</span> <span class="number">0.11222180</span>  <span class="number">1.842891491</span> <span class="number">6.534485e-02</span> <span class="number">7.072327e-01</span></span><br><span class="line">ENSG00000000457  <span class="number">237.163037</span>   <span class="number">0.0379203397</span> <span class="number">0.14345322</span>  <span class="number">0.264339418</span> <span class="number">7.915184e-01</span> <span class="number">4.037634e-02</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">m <span class="operator">&lt;-</span> transform<span class="punctuation">(</span>m<span class="punctuation">,</span>padj<span class="operator">=</span><span class="operator">-</span>log10<span class="punctuation">(</span>m<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将数据分开，为明显上调、明显下调、不显著</span></span><br><span class="line">down <span class="operator">&lt;-</span> m<span class="punctuation">[</span>m<span class="operator">$</span>log2FoldChange <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">up <span class="operator">&lt;-</span> m<span class="punctuation">[</span>m<span class="operator">$</span>log2FoldChange <span class="operator">&gt;=</span> <span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">mid <span class="operator">&lt;-</span> m<span class="punctuation">[</span>m<span class="operator">$</span>log2FoldChange <span class="operator">-</span><span class="number">1</span> <span class="operator">&amp;</span> m<span class="operator">$</span>log2FoldChange <span class="operator">&lt;</span> <span class="number">1</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分别画图</span></span><br><span class="line">plot<span class="punctuation">(</span>mid<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span> mid<span class="operator">$</span>padj<span class="punctuation">,</span> xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;grey&#x27;</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Gene Expression&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;log2FodeChange&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;-log10(Qvalue)&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 低级绘图命令plots加上另外两个</span></span><br><span class="line">points<span class="punctuation">(</span>up<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span>up<span class="operator">$</span>padj<span class="punctuation">,</span>pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span>cex<span class="operator">=</span><span class="number">0.6</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line">points<span class="punctuation">(</span>down<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span>down<span class="operator">$</span>padj<span class="punctuation">,</span>pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span>cex<span class="operator">=</span><span class="number">0.6</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><code>ggplot</code>包</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读数据并处理</span></span><br><span class="line">m <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;../Rdata/Deseq2.csv&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">m <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span>m<span class="punctuation">)</span></span><br><span class="line">transform<span class="punctuation">(</span>m<span class="punctuation">,</span>padj<span class="operator">=</span><span class="operator">-</span>log10<span class="punctuation">(</span>m<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">m <span class="operator">&lt;-</span> transform<span class="punctuation">(</span>m<span class="punctuation">,</span>padj<span class="operator">=</span><span class="operator">-</span>log10<span class="punctuation">(</span>m<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="ggplot2作图">ggplot2作图</h2><p>逻辑清晰，绘图方便，简介好看，有很多基于ggplot2的绘图包。</p><p>图形语法：grammar of graphis，类似于图层的概念。</p><p>1.数据（data）</p><p>一般为数据框</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>2.映射（mapping）</p><p>可以将size，shape，col等映射为数据框中的值</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>wt<span class="punctuation">,</span> y<span class="operator">=</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>wt<span class="punctuation">,</span> y<span class="operator">=</span>mpg<span class="punctuation">,</span> size<span class="operator">=</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>wt<span class="punctuation">,</span> y<span class="operator">=</span>mpg<span class="punctuation">,</span> shape<span class="operator">=</span>as.factor<span class="punctuation">(</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>wt<span class="punctuation">,</span> y<span class="operator">=</span>mpg<span class="punctuation">,</span> col<span class="operator">=</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>3.几何对象</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> mtcars<span class="punctuation">,</span> mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>wt<span class="punctuation">,</span> y<span class="operator">=</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 笔记：Shell 基础与 Shell 编程</title>
      <link href="/posts/31168/"/>
      <url>/posts/31168/</url>
      
        <content type="html"><![CDATA[<h2 id="历史命令与命令补全">历史命令与命令补全</h2><p><code>history</code>：历史命令</p><p><code>-c</code>：清空历史</p><p><code>-w</code>：把内存中的历史命令写入历史命令文件中，<code>~/.bash_history</code>（内存中的历史命令不会立马保存到文件中）</p><p>历史命令默认保存 1000 条，可以更改配置文件中的 <code>HISTSIZE</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> ~/.bashrc | grep HIS</span></span><br><span class="line">HISTCONTROL=ignoreboth</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> setting <span class="built_in">history</span> length see HISTSIZE and HISTFILESIZE <span class="keyword">in</span> bash(1)</span></span><br><span class="line">HISTSIZE=1000</span><br><span class="line">HISTFILESIZE=2000</span><br></pre></td></tr></table></figure><p><code>!n</code>：重复执行第 n 条历史命令，先用 <code>history</code> 查看条数</p><p><code>!!</code>：重复执行上条历史命令</p><p><code>!xxx</code>：重复执行最后一条以 xxx 开头的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">!<span class="built_in">echo</span></span></span><br><span class="line">echo &quot;alias ls=&#x27;ls -lh&#x27;&quot; &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure><p>Bash 中，命令与目录均可以用 <code>Tab</code> 键即可补全。</p><h2 id="脚本执行">脚本执行</h2><ol><li><p>赋予执行权限，通过绝对路径或相对路径执行</p><p><code>chmod 755 xx.sh</code></p><p><code>./xx.sh</code></p></li><li><p>通过 bash 直接执行脚本，不需要执行权限</p><p><code>bash xx.sh</code></p></li></ol><h2 id="命令行展开">命令行展开</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &#123;1,2,3,4&#125;</span></span><br><span class="line">1 2 3 4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> file&#123;1,3,6&#125;</span></span><br><span class="line">file1 file3 file6</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &#123;1..5&#125;</span></span><br><span class="line">1 2 3 4 5</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &#123;1..5..2&#125;</span></span><br><span class="line">1 3 5</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &#123;01..05..2&#125;</span></span><br><span class="line">01 03 05</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &#123;a..e&#125;</span></span><br><span class="line">a b c d e</span><br></pre></td></tr></table></figure><h2 id="别名与快捷键">别名与快捷键</h2><h3 id="别名">别名</h3><p><code>alias 别名='原命令'</code></p><p><code>unalias 别名</code>：取消别名</p><p><code>\ 命令</code>：忽略别名执行命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">alias</span></span></span><br><span class="line">alias grep=&#x27;grep --color=auto&#x27;</span><br><span class="line">alias ls=&#x27;ls --color=auto&#x27;</span><br></pre></td></tr></table></figure><p>命令行中定义的别名重启即失效，需要写入环境变量配置文件才能永久生效，如 <code>~/.bashrc</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;alias ls=&#x27;ls -lh&#x27;&quot;</span> &gt;&gt; ~/.bashrc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">. ~/.bashrc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">alias</span></span></span><br><span class="line">alias ls=&#x27;ls -lh&#x27;</span><br></pre></td></tr></table></figure><p>命令执行顺序</p><ol><li><p>通过相对路径或绝对路径调用</p></li><li><p>别名</p></li><li><p>Bash 内部命令，如 <code>cd</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">whereis <span class="built_in">ls</span></span></span><br><span class="line">ls: /usr/bin/ls /usr/share/man/man1/ls.1.gz</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">whereis <span class="built_in">cd</span></span></span><br><span class="line">cd:</span><br></pre></td></tr></table></figure></li><li><p><code>PATH</code> 环境变量定义的目录中查找到的第一个命令</p></li></ol><h3 id="Bash-常用快捷键">Bash 常用快捷键</h3><p>常用的</p><p><code>Ctrl+A</code>：光标移到开头</p><p><code>Ctrl+E</code>：光标移到结尾</p><p><code>Ctrl+C</code>：强制终止当前命令</p><p><code>Ctrl+L</code>：清屏，相当于 <code>clear</code></p><p><code>Ctrl+U</code>：删除或剪切光标之前输入的命令</p><p><code>Ctrl+K</code>：删除或剪切光标之后输入的命令</p><p><code>Ctrl+Y</code>：粘贴 <code>Ctrl+U</code> 或 <code>Ctrl+K</code> 剪切的内容</p><p><code>Ctrl+R</code>：在历史命令中搜索</p><p><code>Ctrl+D</code>：退出当前终端</p><h2 id="输入输出重定向">输入输出重定向</h2><h3 id="输出重定向">输出重定向</h3><p>Linux 中标准的输入输出和标准错误输出：</p><table><thead><tr><th>设备</th><th>文件名</th><th>文件描述符</th><th>类型</th></tr></thead><tbody><tr><td>键盘</td><td><code>/dev/stdin</code></td><td><code>0</code></td><td>标准输入</td></tr><tr><td>显示器</td><td><code>/dev/stdout</code></td><td><code>1</code></td><td>标准输出</td></tr><tr><td>显示器</td><td><code>/dev/stderr</code></td><td><code>2</code></td><td>标准错误输出</td></tr></tbody></table><p>正常情况下，Shell 通过显示器输出命令返回的内容，可以通过重定向将其存入文件。</p><ol><li><p>将正确输出重定向至文件</p><p><code>ls &gt; file</code>，<code>ls &gt;&gt; file</code>（追加写入）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">a  b  date_now</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &gt; right</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> right</span> </span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">date_now</span><br><span class="line">right</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &gt; /dev/null <span class="comment"># 输出丢进黑洞</span></span></span><br></pre></td></tr></table></figure></li><li><p>将错误输出重定向至文件</p><p><code>lssss 2&gt; file_error</code>，注意 2 和 &gt; 之间<strong>没有空格</strong></p><p><code>lssss 2&gt;&gt; file_error</code>（追加写入）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lssss 2&gt; file_error</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file_error</span> </span><br><span class="line">lssss: command not found</span><br></pre></td></tr></table></figure></li><li><p>将正确和错误输出同时重定向至文件</p><p><code>ls &gt; file 2&gt;&amp;1</code>，<code>ls &gt;&gt; file 2&gt;&amp;1</code>（追加写入）</p><p>或 <code>ls &amp;&gt; file</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &gt; file 2&gt;&amp;1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">file</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lss &gt; file 2&gt;&amp;1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file</span></span><br><span class="line">Command &#x27;lss&#x27; not found, but there are 15 similar ones.</span><br></pre></td></tr></table></figure></li><li><p>将正确和错误输出分开重定向至文件</p><p><code>ls &gt; right 2&gt; error</code>，<code>ls &gt;&gt; right 2&gt;&gt; error</code>（追加写入）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &gt; right 2&gt; error</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> right</span> </span><br><span class="line">right</span><br><span class="line">testfile</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> error</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lss &gt; right 2&gt; error</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> right</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> error</span></span><br><span class="line">Command &#x27;lss&#x27; not found, but there are 15 similar ones.</span><br></pre></td></tr></table></figure></li></ol><h3 id="输入重定向">输入重定向</h3><p>使用不多，了解即可。</p><p><code>wc [选项] [文件名]</code></p><p><code>-c</code>：统计字节数</p><p><code>-w</code>：统计单词数</p><p><code>-l</code>：统计行数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ctrl + D 结束输入，分别为行数、单词数、字节数</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span></span></span><br><span class="line">my pony is a cat</span><br><span class="line">my cat is a pony</span><br><span class="line">      2      10      34</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">统计文件的行数、单词数、字节数</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> testfile</span></span><br><span class="line">dasd</span><br><span class="line">asdas</span><br><span class="line">asdasd sdc sdc sdc</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> testfile</span></span><br><span class="line"> 3  6 30 testfile</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> -w testfile</span></span><br><span class="line">6 testfile</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> -l testfile</span></span><br><span class="line">3 testfile</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> &lt; testfile</span></span><br><span class="line"> 3  6 30</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> &lt;&lt; <span class="string">hello</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="string">12</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="string">12112</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="string">121</span></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash"><span class="string">hello</span> <span class="comment"># 直到输入 hello 才结束统计</span></span></span><br><span class="line">      3       3      13</span><br></pre></td></tr></table></figure><h2 id="多命令顺序执行与管道符">多命令顺序执行与管道符</h2><h3 id="多命令">多命令</h3><table><thead><tr><th>符号</th><th>格式</th><th>作用</th></tr></thead><tbody><tr><td><code>;</code></td><td><code>ls;date</code></td><td>顺序执行，无逻辑关系，仅连接作用</td></tr><tr><td><code>&amp;&amp;</code></td><td><code>make &amp;&amp; make install</code></td><td>命令 1 成功执行后才会执行命令 2</td></tr><tr><td>`</td><td></td><td>`</td></tr></tbody></table><p>例：<code>;</code></p><p>磁盘复制命令：<code>dd</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">date</span>;<span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=./testfile bs=1k count=102400;<span class="built_in">date</span></span></span><br><span class="line">Sun Jul  3 09:01:03 AM CST 2022</span><br><span class="line">102400+0 records in</span><br><span class="line">102400+0 records out</span><br><span class="line">104857600 bytes (105 MB, 100 MiB) copied, 0.19336 s, 542 MB/s</span><br><span class="line">Sun Jul  3 09:01:03 AM CST 2022</span><br></pre></td></tr></table></figure><p>例：<code>&amp;&amp;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span></span></span><br><span class="line">linux_learn  testfile</span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lsssss &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span></span></span><br><span class="line">lsssss: command not found</span><br></pre></td></tr></table></figure><p>例：<code>||</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> || <span class="built_in">echo</span> <span class="built_in">yes</span></span></span><br><span class="line">linux_learn  testfile</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lssss || <span class="built_in">echo</span> no</span></span><br><span class="line">lssss: command not found</span><br><span class="line">no</span><br></pre></td></tr></table></figure><p><code>命令 &amp;&amp; echo yes || echo no</code>，判断命令是否正确执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">linux_learn  testfile</span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lssss &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">lssss: command not found</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h3 id="管道符">管道符</h3><p>格式：<code>命令1 | 命令2</code>，命令 1 的<strong>正确输出</strong>作为命令 2 的<strong>操作对象</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/passwd | grep -n <span class="string">&#x27;root&#x27;</span></span></span><br><span class="line">1:root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure><p><code>grep [选项] '搜索内容' 文件名</code></p><p><code>-i</code>：忽略大小写</p><p><code>-n</code>：输出行号</p><p><code>-v</code>：反向查找</p><p><code>--color=auto</code>：关键字高亮（已在 <code>.bashrc</code> 中设置别名）</p><h2 id="通配符及特殊符号">通配符及特殊符号</h2><h3 id="通配符">通配符</h3><p>用来匹配<strong>文件名</strong>，不同于正则表达式。</p><table><thead><tr><th>通配符</th><th>作用</th></tr></thead><tbody><tr><td><code>？</code></td><td>任意一个字符</td></tr><tr><td><code>*</code></td><td>0 个或任意多个字符，即任何内容</td></tr><tr><td><code>[]</code></td><td>匹配中括号中的任意一个字符。<code>[abc]</code>：a 或 b 或 c</td></tr><tr><td><code>[-]</code></td><td>匹配中括号中范围内的一个字符。<code>[a-c]</code>：a 或 b 或 c</td></tr><tr><td><code>[^]</code></td><td>逻辑非，排除此范围内的一个字符。<code>[^0-9]</code>：不是数字</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">012  0abc  abc  abcd</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> ?abc</span></span><br><span class="line">0abc</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> *abc</span></span><br><span class="line">0abc  abc</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> *abc*</span></span><br><span class="line">0abc  abc  abcd</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> [0-9]*</span></span><br><span class="line">012  0abc</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> [^0-9]*</span></span><br><span class="line">abc  abcd</span><br></pre></td></tr></table></figure><h3 id="Bash-中常见特殊符号">Bash 中常见特殊符号</h3><table><thead><tr><th>符号</th><th>作用</th></tr></thead><tbody><tr><td><code>''</code></td><td>单引号中的所有特殊符号都没有特殊含义，如：<code>$</code> ```</td></tr><tr><td><code>&quot;&quot;</code></td><td>双引号中除 <code>$</code> <code>\</code> ``` 外，均无特殊含义，分别为调用变量值、转义符、引用命令</td></tr><tr><td>``</td><td>反引号中的内容是系统命令，在 Bash中先执行它。与 <code>$()</code> 作用一致。</td></tr><tr><td><code>$()</code></td><td>与反引号作用一致，用来引用系统命令。</td></tr><tr><td><code>#</code></td><td>在 shell 脚本中，<code>#</code> 开头表示注释。</td></tr><tr><td><code>$</code></td><td>用于调用变量值，如调用 <code>name</code> 变量，<code>$name</code>。</td></tr><tr><td><code>\</code></td><td>转义符，在 <code>\</code> 之后的字符失去特殊含义，变为普通字符。</td></tr></tbody></table><p>例：<code>$</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">name=tim</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$name</span></span></span><br><span class="line">tim</span><br></pre></td></tr></table></figure><p>例：<code>''</code> <code>&quot;&quot;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">test</span>=1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$test</span>&quot;</span></span></span><br><span class="line">1</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&#x27;$test&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">test</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$test</span></span></span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>例：<code>$()</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&#x27;$(date)&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">(<span class="built_in">date</span>)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date)</span>&quot;</span></span></span><br><span class="line">Sun Jul  3 09:41:34 AM CST 2022</span><br></pre></td></tr></table></figure><p>例：<code>\</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$name</span></span></span><br><span class="line">tim</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> \<span class="variable">$name</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">name</span></span><br></pre></td></tr></table></figure><h2 id="Bash-变量">Bash 变量</h2><p>Bash 变量规则</p><ul><li><p>变量名同其他编程语言，不能数字开头</p></li><li><p>Bash 中默认变量类型为<strong>字符串</strong>，如果进行数值运算，则必须指定变量类型为数值型</p></li><li><p>变量用等号连接，左右两侧不能加空格</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">a = 1</span></span><br><span class="line">a: command not found</span><br></pre></td></tr></table></figure></li><li><p>变量值若有空格，需要用引号括起来</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">a=<span class="string">&#x27;1 1 1&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$a</span></span></span><br><span class="line">1 1 1</span><br></pre></td></tr></table></figure></li><li><p>变量值中可以使用 <code>\</code> 转义</p></li><li><p>变量可以叠加，需要用 <code>&quot;$变量&quot;</code> 或 <code>$&#123;变量&#125;</code> 的形式</p></li><li><p>可以把命令结果作为值赋给变量，需要用反引号或 <code>$()</code> 包含命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">a=$(<span class="built_in">date</span>)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$a</span></span></span><br><span class="line">Sun Jul 3 02:15:57 PM CST 2022</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">a=`<span class="built_in">date</span>`</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$a</span></span></span><br><span class="line">Sun Jul 3 02:16:12 PM CST 2022</span><br></pre></td></tr></table></figure></li><li><p>环境变量名建议大写，便于区分</p></li></ul><p>变量分类</p><ul><li>用户自定义变量</li><li>环境变量：主要保存和操作系统环境相关的数据</li><li>位置参数变量：主要用来向脚本传递参数或数据，变量名不能自定义，变量的作用是固定的</li><li>预定义变量：Bash 中已经定义好的变量，变量名不能自定义，变量的作用也是固定的</li></ul><h3 id="用户自定义变量">用户自定义变量</h3><p>用户自定义变量，也叫本地变量</p><p>变量定义：<code>str1='123'</code></p><p>变量调用：<code>$str1</code></p><p>变量叠加：<code>str1=&quot;$str1&quot;456</code> 或 <code>str1=$&#123;str1&#125;456</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">str1=<span class="string">&#x27;123&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$str1</span></span></span><br><span class="line">123</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">str1=<span class="string">&quot;<span class="variable">$str1</span>&quot;</span>456</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$str1</span></span></span><br><span class="line">123456</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">str1=<span class="variable">$&#123;str1&#125;</span>789</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$str1</span></span></span><br><span class="line">123456789</span><br></pre></td></tr></table></figure><p>变量查看：<code>set</code>（所有变量）</p><p>变量删除：<code>set str1</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">set</span> | grep str1</span></span><br><span class="line">str1=123456789</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">unset</span> str1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">set</span> | grep str1</span></span><br><span class="line">_=str1</span><br></pre></td></tr></table></figure><h3 id="环境变量">环境变量</h3><p>用户自定义变量只在当前 shell 生效，而环境变量会在当前 shell 和此 shell 的子 shell 中生效；如果将环境变量写入配置文件，则此环境变量会在所有 shell 中生效。</p><p>子 shell 的定义</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pstree</span></span><br><span class="line">init─┬─init───init───bash───pstree</span><br><span class="line">     └─2*[&#123;init&#125;]</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bash</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pstree</span></span><br><span class="line">init─┬─init───init───bash───bash───pstree</span><br><span class="line">     └─2*[&#123;init&#125;]</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bash</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pstree</span></span><br><span class="line">init─┬─init───init───bash───bash───bash───pstree</span><br><span class="line">     └─2*[&#123;init&#125;]</span><br></pre></td></tr></table></figure><p>设置环境变量：<code>export 变量名=变量值</code></p><p>将已有变量设置为环境变量：<code>export 变量名</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">name=xiaoming</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> gender=man</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">age=18</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> age</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pstree</span></span><br><span class="line">init─┬─init───init───bash───pstree</span><br><span class="line">     └─2*[&#123;init&#125;]</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bash</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pstree</span></span><br><span class="line">init─┬─init───init───bash───bash───pstree</span><br><span class="line">     └─2*[&#123;init&#125;]</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$name</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$age</span></span></span><br><span class="line">18</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$gender</span></span></span><br><span class="line">man</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">本地变量只在当前 shell 生效，环境变量在子 shell 中也生效</span></span><br></pre></td></tr></table></figure><p>查询环境变量：<code>env</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">env</span></span></span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">WSL_DISTRO_NAME=Ubuntu-22.04</span><br><span class="line">gender=man</span><br><span class="line">age=18</span><br></pre></td></tr></table></figure><p>删除环境变量：<code>unset 变量名</code></p><h4 id="常见环境变量">常见环境变量</h4><p><code>PATH</code>：冒号分割的文件路径</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$PATH</span></span></span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib:/mnt/c/Program Files (x86)/Common Files/Intel/Shared Libraries/redist/intel64/compiler:/mnt/c/WINDOWS/system32:/mnt/c/WINDOWS:/mnt/c/WINDOWS/System32/Wbem:/mnt/c/WINDOWS/System32/WindowsPowerShell/v1.0/:/mnt/c/WINDOWS/System32/OpenSSH/:/mnt/c/Users/liuao/AppData/Roaming/nvm:/mnt/c/Program Files/nodejs:/mnt/c/Program Files/Git/cmd:/mnt/c/Program Files/dotnet/:/mnt/c/R/Java/jre1.8.0_333/bin:/mnt/c/Users/liuao/AppData/Local/Programs/Python/Python310/Scripts/:/mnt/c/Users/liuao/AppData/Local/Programs/Python/Python310/:/mnt/c/Users/liuao/AppData/Local/Microsoft/WindowsApps:/mnt/c/Users/liuao/AppData/Local/Programs/Microsoft VS Code/bin:/mnt/c/Program Files/Bandizip/:/mnt/c/Users/liuao/AppData/Local/GitHubDesktop/bin:/snap/bin</span><br></pre></td></tr></table></figure><p>输入命令时，系统会在 <code>PATH</code> 定义的路径中搜索命令并执行，省去了输入绝对路径的麻烦。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">which</span> <span class="built_in">ls</span></span></span><br><span class="line">/usr/bin/ls</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">/usr/bin/ls</span></span><br><span class="line">linux_learn  testfile</span><br></pre></td></tr></table></figure><p>一般习惯把可执行文件的路径追加到 <code>PATH</code> 中，这样便可以直接执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PATH=&quot;$PATH&quot;:[路径]</span><br><span class="line">PATH=$&#123;PATH&#125;:[路径]</span><br></pre></td></tr></table></figure><p><code>PS1</code>：定义系统提示符的变量</p><p><code>$</code>：分别表示用户，主机，路径，普通用户，可自定义格式</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$PS1</span></span></span><br><span class="line">\[\e]0;\u@\h: \w\a\]$&#123;debian_chroot:+($debian_chroot)&#125;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">PS1=<span class="string">&#x27;\u@\t \# \h &#x27;</span></span></span><br><span class="line">aohui@15:13:51 4 lah-PC</span><br></pre></td></tr></table></figure><h3 id="位置参数变量">位置参数变量</h3><table><thead><tr><th>变量</th><th>作用</th></tr></thead><tbody><tr><td><code>$n</code></td><td><code>$0</code> 表示命令本身，<code>$1-9</code> 表示第 1-9 个参数，10 以上要括起来，<code>$&#123;10&#125;</code></td></tr><tr><td><code>$*</code></td><td>代表命令中的所有参数，看成一个整体</td></tr><tr><td><code>$@</code></td><td>代表命令中的所有参数，参数间独立</td></tr><tr><td><code>$#</code></td><td>命令中参数个数</td></tr></tbody></table><p>例：<code>$n</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg1.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo $0</span><br><span class="line">echo $1</span><br><span class="line">echo $2</span><br><span class="line">echo $3</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg1.sh</span></span><br><span class="line">./arg1.sh # $0 是命令本身</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg1.sh 1 2 3 4</span></span><br><span class="line">./arg1.sh</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg2.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo $(($1+$2)) # 数值运算要用 $(()) 括起来</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg2.sh 1 2</span></span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>例：<code>$* $@ $#</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg3.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo $#</span><br><span class="line">echo $*</span><br><span class="line">echo $@</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg3.sh 1 2 3 4 5 6</span></span><br><span class="line">6</span><br><span class="line">1 2 3 4 5 6</span><br><span class="line">1 2 3 4 5 6</span><br></pre></td></tr></table></figure><p><code>$*</code> 和 <code>$@</code> 的区别：<code>$*</code> 把所有参数看成一个整体，<code>$@</code> 每个参数单独区别</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg4.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">for i in &quot;$*&quot;</span><br><span class="line">        do</span><br><span class="line">                echo $i</span><br><span class="line">        done</span><br><span class="line">for j in &quot;$@&quot;</span><br><span class="line">        do</span><br><span class="line">                echo $j</span><br><span class="line">        done</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg4.sh 1 2 3 4</span></span><br><span class="line">1 2 3 4</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure><h3 id="预定义变量">预定义变量</h3><p>位置参数变量是预定义变量的一种。</p><table><thead><tr><th>变量</th><th>作用</th></tr></thead><tbody><tr><td><code>&amp;?</code></td><td>上一条命令的执行情况，0：正确执行，不同错误返回不同值</td></tr><tr><td><code>$$</code></td><td>当前进程的 PID 号</td></tr><tr><td><code>$!</code></td><td>后台运行的最后一个进程的 PID 号</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg5.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo $$</span><br><span class="line">find hello.sh &amp;</span><br><span class="line">echo $!</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg5.sh</span></span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find: ‘hello.sh’: No such file or directory</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">130</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">arg1.sh  arg2.sh  arg3.sh  arg4.sh  arg5.sh  linux_learn  testfile</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">0</span><br></pre></td></tr></table></figure><h3 id="键盘输入">键盘输入</h3><p>比用</p><p>位置参数变量接收输入信息更加直观。</p><p><code>read [选项] 变量</code></p><p><code>-t</code>：时间限制，秒</p><p><code>-p</code>：输入提示</p><p><code>-s</code>：隐藏输入信息</p><p><code>-n</code>：限制输入字符数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> arg5.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -t 30 -p &quot;Input your name: &quot; name</span><br><span class="line">echo $name</span><br><span class="line"></span><br><span class="line">read -t 30 -s -p &quot;Input your age: &quot; age</span><br><span class="line">echo -e &quot;\n&quot;</span><br><span class="line">echo $age</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./arg5.sh</span></span><br><span class="line">Input your name: nb</span><br><span class="line">nb</span><br><span class="line">Input your age:</span><br><span class="line"></span><br><span class="line">25</span><br></pre></td></tr></table></figure><h2 id="数值运算与运算符">数值运算与运算符</h2><h3 id="数值运算">数值运算</h3><p>Bash 中默认变量为字符串型，不能进行数值运算</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">a=1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">b=2</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$a</span>+<span class="variable">$b</span></span></span><br><span class="line">1+2</span><br></pre></td></tr></table></figure><h4 id="方法-1">方法 1</h4><p><code>declare</code>：声明变量的类型</p><p><code>-</code>：给变量设定类型属性</p><p><code>+</code>：取消变量的类型属性</p><p><code>-i</code>：将变量声明为整数型</p><p><code>-x</code>：将变量声明为环境变量</p><p><code>-p</code>：显示变量被声明的类型</p><p><code>declare -i c=$a+$b</code> 即可。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -p a</span></span><br><span class="line">declare -- a=&quot;1&quot;</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -i a</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -p a</span></span><br><span class="line">declare -i a=&quot;1&quot;</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -x a</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -p a</span></span><br><span class="line">declare -ix a=&quot;1&quot;</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">declare</span> -i c=<span class="variable">$a</span>+<span class="variable">$b</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$c</span></span></span><br><span class="line">3</span><br></pre></td></tr></table></figure><h4 id="方法-2">方法 2</h4><p><code>expr</code> 或 <code>let</code>（不常用）</p><p><code>+</code> 号左右空格不能省略</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">d=$(<span class="built_in">expr</span> <span class="variable">$a</span> + <span class="variable">$b</span>)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$d</span></span></span><br><span class="line">3</span><br></pre></td></tr></table></figure><h4 id="方法-3">方法 3</h4><p><code>$(())</code> 或 <code>$[]</code>（常用）</p><p>总结：<code>$</code>，表示变量值；<code>$()</code>，表示系统命令；<code>$(())</code>，表示数值运算</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">f=$((<span class="variable">$a</span>+<span class="variable">$b</span>))</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$f</span></span></span><br><span class="line">3</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">g=$[<span class="variable">$a</span>+<span class="variable">$b</span>]</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$d</span></span></span><br><span class="line">3</span><br></pre></td></tr></table></figure><h3 id="运算符">运算符</h3><p><code>$(())</code> 包起来即可，里面正常写算式，通用优先级。</p><h3 id="变量测试与内容替换">变量测试与内容替换</h3><table><thead><tr><th>变量置换方式</th><th><code>y</code> 不存在</th><th><code>y</code> 为空</th><th><code>y</code> 不为空</th></tr></thead><tbody><tr><td><code>x=$&#123;y-new&#125;</code></td><td><code>x=new</code></td><td><code>x</code>  为空</td><td><code>x=$y</code></td></tr><tr><td>…</td><td></td><td></td><td></td></tr></tbody></table><p>内容太多，容易记混，遇到查表即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">unset</span> y</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">x=<span class="variable">$&#123;y-new&#125;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$x</span></span></span><br><span class="line">new</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">y=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">x=<span class="variable">$&#123;y-new&#125;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$x</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">y=<span class="string">&quot;old&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">x=<span class="variable">$&#123;y-new&#125;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$x</span></span></span><br><span class="line">old</span><br></pre></td></tr></table></figure><h2 id="环境变量配置文件">环境变量配置文件</h2><p>将环境变量写入相应配置文件中，便于在所有 shell 中生效。</p><p>修改环境变量后，<code>source 配置文件</code> 或 <code>. 配置文件</code>，不用重新登录即可使配置文件生效。</p><p>默认的系统环境变量主要有：<code>PATH</code>、<code>HISTSIZE</code>、<code>PS1</code>、<code>HOSTNAME</code>等。</p><p>环境变量配置文件类型：</p><ul><li><code>/etc/profile</code></li><li><code>/etc/profile.d/*.sh</code></li><li><code>/etc/bashrc</code></li><li><code>~/.bash_profile</code></li><li><code>~/.bashrc</code></li></ul><p>前三个对所有用户均生效，后两个只对当前用户生效。</p><h3 id="配置文件作用">配置文件作用</h3><p>配置文件的调用顺序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[&quot;/etc/profile&quot;] --&gt;B[&quot;~/.bash_profile&quot;]</span><br><span class="line">    B --&gt; C[&quot;~/.bashrc&quot;]</span><br><span class="line">    C --&gt; D[&quot;/etc/bashrc&quot;]</span><br><span class="line">    D --&gt; E[命令提示符]</span><br><span class="line">    A --&gt; F[&quot;/etc/profile.d/*.sh&quot;]</span><br><span class="line">    D --&gt; F</span><br><span class="line">    F --&gt; G[&quot;/etc/profile.d/lang.sh&quot;]</span><br><span class="line">    G --&gt; H[&quot;/etc/sysc config/i18n&quot;]</span><br></pre></td></tr></table></figure><p><code>/etc/profile</code>：shell 登录即读取，作用如下：</p><ul><li><p>定义 USER 变量</p></li><li><p>LOGNAME</p></li><li><p>MAIL</p></li><li><p>PATH</p></li><li><p>HOSTNAME</p></li><li><p>HISTSIZE</p></li><li><p>unmask</p></li><li><p>调用 <code>/etc/profile.d/*.sh</code> 中的所有文件</p></li></ul><p><code>~/.bash_profile</code> 作用：</p><ul><li><p>调用 <code>~/.bashrc</code></p></li><li><p>在 <code>PATH</code> 变量后加入了 <code>$HOME/bin</code> 目录</p></li></ul><p><code>~/.bashrc</code> 作用：</p><ul><li><p>定义别名</p></li><li><p>调用 <code>/etc/bashrc</code></p></li></ul><p><code>/etc/bashrc</code>：无 login 的 shell 读取（子 shell）</p><ul><li>PS1</li><li>umask</li><li>PATH</li><li>调用 <code>/etc/profile.d/*.sh</code> 中的所有文件</li></ul><p>越往后的配置文件优先级越高</p><h3 id="其他环境配置文件">其他环境配置文件</h3><p>注销生效的配置文件 ：<code>~/.bash_logout</code>，如注销后清空历史即可将命令写入该文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> ~/.bash_logout</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">~/.bash_logout: executed by bash(1) when login shell exits.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">when leaving the console clear the screen to increase privacy</span></span><br><span class="line"></span><br><span class="line">if [ &quot;$SHLVL&quot; = 1 ]; then</span><br><span class="line">    [ -x /usr/bin/clear_console ] &amp;&amp; /usr/bin/clear_console -q</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>历史命令：<code>~/.bash_history</code>，排错时使用。</p><p>终端登录信息</p><p>本地终端：<code>/etc/issue</code>，远程登录无效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/issue</span></span><br><span class="line">Ubuntu 22.04 LTS \n \l</span><br></pre></td></tr></table></figure><p>远程登录：<code>/etc/issue.net</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/issue.net</span></span><br><span class="line">Ubuntu 22.04 LTS</span><br></pre></td></tr></table></figure><p>登录后欢迎信息：<code>/etc/motd</code></p><h2 id="正则表达式">正则表达式</h2><p>正则表达式与通配符（<code>* ? []</code>）的区别</p><ul><li><p>正则表达式用于匹配文件中的字符串，<code>grep</code>、<code>awk</code>、<code>sed</code> 等命令支持，包含匹配</p></li><li><p>通配符用来匹配文件名，<code>ls</code>、<code>find</code>、<code>cp</code> 支持，且不支持正则，完全匹配</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">touch</span> aa aabb</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> aa</span></span><br><span class="line">aa</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> aa*</span></span><br><span class="line">aa  aabb</span><br></pre></td></tr></table></figure></li></ul><h3 id="语法">语法</h3><p>基础正则表达式</p><table><thead><tr><th>操作符</th><th>说明</th><th>例子</th></tr></thead><tbody><tr><td><code>.</code></td><td>表示任何单个字符（除换行符，即空行）</td><td></td></tr><tr><td><code>[]</code></td><td>给出单个字符的取值范围</td><td><code>[abc]</code>：a 或 b 或 c，<code>[a-z]</code>：a-z 单个字母</td></tr><tr><td><code>[^]</code></td><td>排除此取值范围</td><td><code>[^abc]</code>：非 a 或 b 或 c</td></tr><tr><td><code>*</code></td><td>前一个字符出现 <code>&gt;=0</code> 次</td><td><code>abc*</code>：ab、abc、abcc、abccc 等</td></tr><tr><td><code>\&#123;m\&#125;</code></td><td>前一个字符出现 <code>m</code> 次</td><td><code>ab&#123;2&#125;c</code>：abbc</td></tr><tr><td><code>\&#123;n,\&#125;</code></td><td>前一个字符出现 <code>&gt;=n</code> 次</td><td><code>ab&#123;2,&#125;c</code>：abbc、abbbc、abbbbc 等</td></tr><tr><td><code>\&#123;m,n\&#125;</code></td><td>前一个字符出现 <code>m-n</code> 次（含 <code>n</code>）</td><td><code>ab&#123;1,3&#125;c</code>：abc、abbc、abbbc</td></tr><tr><td><code>^</code></td><td>匹配字符串的开头</td><td><code>^123</code>：字符串以 123 开头</td></tr><tr><td><code>$</code></td><td>匹配字符串的结尾</td><td><code>123$</code>：字符串以 123 结尾</td></tr><tr><td><code>\</code></td><td>转义字符</td><td><code>\.</code>：普通的 .</td></tr></tbody></table><p>拓展正则表达式（使用较少）</p><table><thead><tr><th>操作符</th><th>说明</th><th>例子</th></tr></thead><tbody><tr><td><code>+</code></td><td>前一个字符出现 <code>&gt;=1</code> 次</td><td><code>abc+</code>：abc、abcc、abccc 等</td></tr><tr><td><code>?</code></td><td>前一个字符出现 <code>0</code> 或 <code>1</code> 次</td><td><code>abc?</code>：ab、abc</td></tr><tr><td>`</td><td>`</td><td>左右表达式中的一个</td></tr><tr><td><code>()</code></td><td>分组标记，内部只能使用 <code>\</code></td><td><code>(abc)</code>：abc，`(abc</td></tr></tbody></table><p>注意，Linux 系统下，文本每行均以 <code>$</code> 结尾，所以，匹配空行可以用 <code>^$</code>。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> -en ~/Desktop/sort_file_name.sh <span class="comment"># 显示所有字符，包括非打印字符</span></span></span><br><span class="line">     1#!/bin/bash$</span><br><span class="line">     2if [ -d $1 ];then$</span><br><span class="line">     3cd $1$</span><br><span class="line">     4pwd$</span><br><span class="line">     5$</span><br><span class="line">     6i=1$</span><br></pre></td></tr></table></figure><h2 id="字符串处理">字符串处理</h2><h3 id="字符串截取命令">字符串截取命令</h3><h4 id="cut-提取列"><code>cut</code> 提取列</h4><p><code>cut [选项] 文件名</code></p><p><code>-f</code>：列号，提取第几列</p><p><code>-d</code>：分隔符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Mark</span><br><span class="line">1       Liming  M       86</span><br><span class="line">2       Sc      M       90</span><br><span class="line">3       Gao     M       83</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cut</span> -f 1,2 student.txt</span></span><br><span class="line">ID      Name</span><br><span class="line">1       Liming</span><br><span class="line">2       Sc</span><br><span class="line">3       Gao</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$PATH</span></span></span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib:/mnt/c/Program Files (x86)/Common Files/Intel/Shared Libraries/redist/intel64/compiler:/mnt/c/WINDOWS/system32:/mnt/c/WINDOWS:/mnt/c/WINDOWS/System32/Wbem:/mnt/c/WINDOWS/System32/WindowsPowerShell/v1.0/:/mnt/c/WINDOWS/System32/OpenSSH/:/mnt/c/Users/liuao/AppData/Roaming/nvm:/mnt/c/Program Files/nodejs:/mnt/c/Program Files/Git/cmd:/mnt/c/Program Files/dotnet/:/mnt/c/R/Java/jre1.8.0_333/bin:/mnt/c/Users/liuao/AppData/Local/Programs/Python/Python310/Scripts/:/mnt/c/Users/liuao/AppData/Local/Programs/Python/Python310/:/mnt/c/Users/liuao/AppData/Local/Microsoft/WindowsApps:/mnt/c/Users/liuao/AppData/Local/Programs/Microsoft VS Code/bin:/mnt/c/Program Files/Bandizip/:/mnt/c/Users/liuao/AppData/Local/GitHubDesktop/bin:/snap/bin</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$PATH</span> | <span class="built_in">cut</span> -d : -f 5</span></span><br><span class="line">/sbin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">提取普通用户名</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/passwd | grep /bin/bash</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">aohui:x:1000:1000:aohui:/home/aohui:/bin/bash</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/passwd | grep /bin/bash | grep -v root</span></span><br><span class="line">aohui:x:1000:1000:aohui:/home/aohui:/bin/bash</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /etc/passwd | grep /bin/bash | grep -v root | <span class="built_in">cut</span> -d : -f 1</span></span><br><span class="line">aohui</span><br></pre></td></tr></table></figure><p>局限：无法提取以多个空格分割的列，单个可以</p><p>需要用 <code>awk</code> 命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sdb        251G  1.5G  237G   1% /</span><br><span class="line">none            3.9G  4.0K  3.9G   1% /mnt/wsl</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h | grep /dev/sdb</span></span><br><span class="line">/dev/sdb        251G  1.5G  237G   1% /</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h | grep /dev/sdb | <span class="built_in">cut</span> -f 5</span></span><br><span class="line">/dev/sdb        251G  1.5G  237G   1% /</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h | grep /dev/sdb | <span class="built_in">cut</span> -d <span class="string">&#x27; &#x27;</span> -f 5</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&#x27;a b c d&#x27;</span> | <span class="built_in">cut</span> -d <span class="string">&#x27; &#x27;</span> -f 2,4</span></span><br><span class="line">b d</span><br></pre></td></tr></table></figure><h4 id="printf-格式化打印"><code>printf</code> 格式化打印</h4><p><code>printf '输出格式' 输出内容</code></p><p><code>%s</code>：输出 n 个字符串</p><p><code>%i</code>：输出 n 个数字的整数</p><p><code>%.nf</code>：输出 n 位小数的浮点数</p><p>常用输出格式：</p><p><code>\r</code>：回车</p><p><code>\n</code>：换行符</p><p><code>\t</code>：制表符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ printf &#x27;%s\n&#x27; hello world</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">$ printf &#x27;%s\n&#x27; &#x27;hello world&#x27;</span><br><span class="line">hello world</span><br><span class="line">$ printf &#x27;%i\n&#x27; 100</span><br><span class="line">100</span><br><span class="line">$ printf &#x27;%.3f\n&#x27; 100.23355</span><br><span class="line">100.234</span><br></pre></td></tr></table></figure><h4 id="awk-提取列"><code>awk</code> 提取列</h4><p><code>awk '条件1&#123;动作1&#125; 条件2&#123;动作2&#125;…' 文件名</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Mark</span><br><span class="line">1       Liming  M       86</span><br><span class="line">2       Sc      M       90</span><br><span class="line">3       Gao     M       83</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">awk <span class="string">&#x27;&#123;printf $2 &quot;\t&quot; $4 &quot;\n&quot;&#125;&#x27;</span> student.txt</span></span><br><span class="line">Name    Mark</span><br><span class="line">Liming  86</span><br><span class="line">Sc      90</span><br><span class="line">Gao     83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sdb        251G  1.5G  237G   1% /</span><br><span class="line">none            3.9G  4.0K  3.9G   1% /mnt/wsl</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h | awk <span class="string">&#x27;&#123;printf $1 &quot;\t&quot; $5 &quot;\n&quot;&#125;&#x27;</span></span></span><br><span class="line">Filesystem      Use%</span><br><span class="line">/dev/sdb        1%</span><br><span class="line">none    1%</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h | grep /dev/sdb | awk <span class="string">&#x27;&#123;printf $5 &quot;\n&quot;&#125;&#x27;</span> | <span class="built_in">cut</span> -d <span class="string">&#x27;%&#x27;</span> -f 1</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure><p><code>BEGIN</code>：在读取数据之前执行命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">awk <span class="string">&#x27;BEGIN&#123;printf &quot;Printing!!!\n&quot;&#125; &#123;printf $2 &quot;\t&quot; $4 &quot;\n&quot;&#125;&#x27;</span> student.txt</span></span><br><span class="line">Printing!!!</span><br><span class="line">Name    Mark</span><br><span class="line">Liming  86</span><br><span class="line">Sc      90</span><br><span class="line">Gao     83</span><br></pre></td></tr></table></figure><p><code>FS</code>：指定分隔符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">awk <span class="string">&#x27;&#123;FS=&quot;:&quot;&#125; &#123;print $1 &quot;\t&quot; $6&#125;&#x27;</span> /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash # 第一条数据读入后才开始执行动作</span><br><span class="line">daemon  /usr/sbin</span><br><span class="line">bin     /bin</span><br><span class="line">sys     /dev</span><br><span class="line">sync    /bin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">awk <span class="string">&#x27;BEGIN&#123;FS=&quot;:&quot;&#125; &#123;print $1 &quot;\t&quot; $6&#125;&#x27;</span> /etc/passwd</span></span><br><span class="line">root    /root</span><br><span class="line">daemon  /usr/sbin</span><br><span class="line">bin     /bin</span><br><span class="line">sys     /dev</span><br><span class="line">sync    /bin</span><br></pre></td></tr></table></figure><p><code>END</code>：最后执行动作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">awk <span class="string">&#x27;BEGIN&#123;printf &quot;Printing!!!\n&quot;&#125; &#123;printf $2 &quot;\t&quot; $4 &quot;\n&quot;&#125; END&#123;printf &quot;Done!!!\n&quot;&#125;&#x27;</span> student.txt</span></span><br><span class="line">Printing!!!</span><br><span class="line">Name    Mark</span><br><span class="line">Liming  86</span><br><span class="line">Sc      90</span><br><span class="line">Gao     83</span><br><span class="line">Done!!!</span><br></pre></td></tr></table></figure><p>条件判断</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> student.txt | grep -v Name</span></span><br><span class="line">1       Liming  M       86</span><br><span class="line">2       Sc      M       90</span><br><span class="line">3       Gao     M       83</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> student.txt | grep -v Name | awk <span class="string">&#x27;$4&gt;85&#123;print $2 &quot;\t&quot; $4&#125;&#x27;</span></span></span><br><span class="line">Liming  86</span><br><span class="line">Sc      90</span><br></pre></td></tr></table></figure><h4 id="sed-编辑操作"><code>sed</code> 编辑操作</h4><p>轻量级流编辑器，主要用来将数据进行选取、替换、删除、新增。</p><p><code>sed [选项] '[动作]' 文件名</code></p><p>选项</p><ul><li><p><code>-n</code>：只输出经过 sed 命令处理的行</p></li><li><p><code>-e</code>：允许对输入数据应用多条 sed 命令编辑，多条件 <code>;</code> 号分割</p></li><li><p><code>-i</code>：数据修改后不光输出数据，也更改文件的原数据</p></li></ul><p>动作</p><ul><li><code>a\</code>：追加，添加多行时，除最后一行，每行要用 <code>\</code> 表示数据未完结</li><li><code>c\</code>：替换，替换多行时，除最后一行，每行要用 <code>\</code> 表示数据未完结</li><li><code>i\</code>：插入，插入多行时，除最后一行，每行要用 <code>\</code> 表示数据未完结</li><li><code>d</code>：删除，删除指定行</li><li><code>p</code>：打印，输出指定行</li><li><code>s</code>：字符串替换，格式：<code>行范围s/old/new/g</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;2p&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Mark</span><br><span class="line">1       Liming  M       86</span><br><span class="line">1       Liming  M       86</span><br><span class="line">2       Sc      M       90</span><br><span class="line">3       Gao     M       83</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed -n <span class="string">&#x27;2p&#x27;</span> student.txt <span class="comment"># 加 -n 才会只输出经过处理后的，一般 p 与 -n 配合</span></span></span><br><span class="line">1       Liming  M       86</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;2,3d&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Mark</span><br><span class="line">3       Gao     M       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;s/M/W/g&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Wark</span><br><span class="line">1       Liming  W       86</span><br><span class="line">2       Sc      W       90</span><br><span class="line">3       Gao     W       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;3s/W/M/g&#x27;</span> student.txt <span class="comment"># 可只替换某一行</span></span></span><br><span class="line">ID      Name    Gender  Wark</span><br><span class="line">1       Liming  W       86</span><br><span class="line">2       Sc      M       90</span><br><span class="line">3       Gao     W       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;2a hello\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">&gt; world&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Wark</span><br><span class="line">1       Liming  W       86</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">2       Sc      W       90</span><br><span class="line">3       Gao     W       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;2i hello\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">world&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Wark</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">1       Liming  W       86</span><br><span class="line">2       Sc      W       90</span><br><span class="line">3       Gao     W       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed <span class="string">&#x27;2,3c hello\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">world&#x27;</span> student.txt</span></span><br><span class="line">ID      Name    Gender  Wark</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">3       Gao     W       83</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">多命令同时执行</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sed -e <span class="string">&#x27;4s/W/M/g;1d&#x27;</span> student.txt</span></span><br><span class="line">1       Liming  W       86</span><br><span class="line">2       Sc      W       90</span><br><span class="line">3       Gao     M       83</span><br></pre></td></tr></table></figure><h3 id="字符串处理命令">字符串处理命令</h3><h4 id="sort-排序"><code>sort</code> 排序</h4><p><code>sort [选项] 文件名</code></p><p><code>-f</code>：忽略大小写</p><p><code>-n</code>：以数值型排序，默认是字符串</p><p><code>-r</code>：反向排序</p><p><code>-t</code>：指定分隔符，默认制表符</p><p><code>-k n[,m]</code>：按照指定字段范围排序。从第 n 字段开始，m 字段结束（默认到行尾）。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sort</span> /etc/passwd</span></span><br><span class="line">aohui:x:1000:1000:aohui:/home/aohui:/bin/bash</span><br><span class="line">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sort</span> -r /etc/passwd</span></span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">uuidd:x:107:113::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sort</span> -t <span class="string">&quot;:&quot;</span> -k 3,3 /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sort</span> -t <span class="string">&quot;:&quot;</span> -n -k 3,3 /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><h4 id="wc-统计"><code>wc</code> 统计</h4><p><code>wc [选项] 文件名</code></p><p><code>-l</code>：行数</p><p><code>-w</code>：单词数</p><p><code>-m</code>：字数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> /etc/passwd</span></span><br><span class="line">  31   43 1635 /etc/passwd</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> -l /etc/passwd</span></span><br><span class="line">31 /etc/passwd</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> -w /etc/passwd</span></span><br><span class="line">43 /etc/passwd</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">wc</span> -m /etc/passwd</span></span><br><span class="line">1635 /etc/passwd</span><br></pre></td></tr></table></figure><h2 id="条件判断和流程控制">条件判断和流程控制</h2><h3 id="条件判断">条件判断</h3><h4 id="按文件类型判断">按文件类型判断</h4><p>常用的有 4 个</p><ul><li><code>-d 文件</code>：文件是否存在，且为目录</li><li><code>-e 文件</code>：文件是否存在</li><li><code>-f 文件</code>：文件是否存在，且为普通文件</li><li><code>-L 文件</code>：文件是否存在，且为符号链接文件</li></ul><p><code>test [选项] 文件</code> 或 <code>[ [选项] 文件 ]</code>（两端有空格）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">test</span> -d /etc/passwd</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">1</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">test</span> -f /etc/passwd</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">0</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">test</span> -e /etc/passwd</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">0</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -e /etc/passwd ]</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -e /etc/passwd ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -d /etc/passwd ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="按文件权限判断">按文件权限判断</h4><p>常用 3 个</p><p><code>-r 文件</code>：文件是否存在，且有读权限</p><p><code>-w 文件</code>：文件是否存在，且有写权限</p><p><code>-x 文件</code>：文件是否存在，且有执行权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -l /etc/passwd</span></span><br><span class="line">-rw-r--r-- 1 root root 1635 Jul  2 19:52 /etc/passwd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">只要一个有即为真，不管是所有者、所属组还是其他人，不能判断身份</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -r /etc/passwd ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -w /etc/passwd ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -x /etc/passwd ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -w student.txt ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br></pre></td></tr></table></figure><h4 id="比较两个文件">比较两个文件</h4><p><code>文件1 -nt 文件2</code>：文件 1 是否比文件 2 新</p><p><code>文件1 -ot 文件2</code>：文件 1 是否比文件 2 旧</p><p><code>文件1 -ef 文件2</code>：两个文件的 <code>inode</code> 是否一致，可以用来判断硬链接</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -l</span></span><br><span class="line">-rw-r--r-- 1 aohui aohui   55 Jul  5 09:30 student2.txt</span><br><span class="line">-rw-r--r-- 1 aohui aohui   55 Jul  4 19:55 student.txt</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ student.txt -nt student2.txt ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ student.txt -ot student2.txt ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ln</span> student.txt stu.txt</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -li</span></span><br><span class="line">6348 -rw-r--r-- 1 aohui aohui   55 Jul  5 09:30 student2.txt</span><br><span class="line">3616 -rw-r--r-- 2 aohui aohui   55 Jul  4 19:55 student.txt</span><br><span class="line">3616 -rw-r--r-- 2 aohui aohui   55 Jul  4 19:55 stu.txt</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ student.txt -ef stu.txt ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ student.txt -ef student2.txt ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="比较两个整数">比较两个整数</h4><p><code>整数1 -eq 整数2</code>：整数1 = 整数2 ?</p><p><code>整数1 -ne 整数2</code>：整数1 != 整数2 ?</p><p><code>整数1 -gt 整数2</code>：整数1 &gt; 整数2 ?</p><p><code>整数1 -lt 整数2</code>：整数1 &lt; 整数2 ?</p><p><code>整数1 -ge 整数2</code>：整数1 &gt;= 整数2 ?</p><p><code>整数1 -le 整数2</code>：整数1 &lt;= 整数2 ?</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 1 -lt 2 ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -lt 2 ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -ge 2 ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -le 2 ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -eq 2 ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br></pre></td></tr></table></figure><h4 id="比较两个字符串">比较两个字符串</h4><p><code>-z 字符串</code>：是否为空</p><p><code>-n 字符串</code>：是否非空</p><p><code>字符串1 == 字符串2</code>：两个字符串是否相等</p><p><code>字符串1 != 字符串2</code>：两个字符串是否不相等</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -z <span class="string">&#x27;&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ -z <span class="string">&#x27;111&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ <span class="string">&#x27;11&#x27;</span> == <span class="string">&#x27;2&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="多重条件判断">多重条件判断</h4><p><code>判断1 -a 判断2</code>：AND</p><p><code>判断1 -o 判断2</code>：OR</p><p><code>!判断</code>：逻辑非</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -gt 1 -a <span class="string">&#x27;11&#x27;</span> == <span class="string">&#x27;2&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">[ 2 -gt 1 -a <span class="string">&#x27;11&#x27;</span> == <span class="string">&#x27;11&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">! [ <span class="string">&#x27;1&#x27;</span> == <span class="string">&#x27;1&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">no</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">! [ <span class="string">&#x27;1&#x27;</span> != <span class="string">&#x27;1&#x27;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">yes</span> || <span class="built_in">echo</span> no</span></span><br><span class="line">yes</span><br></pre></td></tr></table></figure><h3 id="流程控制">流程控制</h3><h4 id="if"><code>if</code></h4><p>单分支写法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if [];then</span><br><span class="line">do something</span><br><span class="line">fi</span><br><span class="line">或</span><br><span class="line">if []</span><br><span class="line">then</span><br><span class="line">do something</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>例：判断根分区占用率</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> script.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">rate=$(df -h | grep &#x27;/$&#x27; | awk &#x27;&#123;print $5&#125;&#x27; | cut -d &#x27;%&#x27; -f 1)</span><br><span class="line">if [ $rate -lt 50 ];then</span><br><span class="line">        echo OK!!</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./script.sh</span></span><br><span class="line">OK!!</span><br></pre></td></tr></table></figure><p>双分支写法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if []</span><br><span class="line">then</span><br><span class="line">do something</span><br><span class="line">else</span><br><span class="line">do something</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>例：备份文件夹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">date=$(date +%y%m%d)</span><br><span class="line">size=$(du -sh /etc)</span><br><span class="line"></span><br><span class="line">if [ -d /tmp/backup ]</span><br><span class="line">        then</span><br><span class="line">                cd /tmp/backup</span><br><span class="line">                echo &quot;Date: $date&quot; &gt; backinfo.txt</span><br><span class="line">                echo &quot;Data size: $size&quot; &gt;&gt; backinfo.txt</span><br><span class="line">                tar -zcf etc_$date.tar.gz /etc backinfo.txt &amp;&gt; /dev/null</span><br><span class="line">                rm backinfo.txt</span><br><span class="line">        else</span><br><span class="line">                mkdir /tmp/backup</span><br><span class="line">                cd /tmp/backup</span><br><span class="line">                echo &quot;Date: $date&quot; &gt; backinfo.txt</span><br><span class="line">                echo &quot;Data size: $size&quot; &gt;&gt; backinfo.txt</span><br><span class="line">                tar -zcf etc_$date.tar.gz /etc backinfo.txt &amp;&gt; /dev/null</span><br><span class="line">                rm backinfo.txt</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>多分支写法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if []</span><br><span class="line">then</span><br><span class="line">do something</span><br><span class="line">elif []</span><br><span class="line">then</span><br><span class="line">do something</span><br><span class="line">...</span><br><span class="line">else</span><br><span class="line">do something</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>例：判断用户输入文件的类型</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -p &quot;Input a file or dir: &quot; file</span><br><span class="line"></span><br><span class="line">if [ -z $file ] # 先判断是否非空</span><br><span class="line">        then</span><br><span class="line">                echo &quot;ERROR, reinput&quot;</span><br><span class="line">                exit 69 # 以错误1退出</span><br><span class="line">elif [ ! -e $file ] # 判断文件是否存在</span><br><span class="line">        then</span><br><span class="line">                echo &quot;File not exist&quot;</span><br><span class="line">                exit 2</span><br><span class="line">elif [ -f $file ]</span><br><span class="line">        then</span><br><span class="line">                echo &quot;A normal file&quot;</span><br><span class="line">elif [ -d $file ]</span><br><span class="line">        then</span><br><span class="line">                echo &quot;A dir&quot;</span><br><span class="line">else</span><br><span class="line">        echo &quot;Other file&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./file.sh</span></span><br><span class="line">Input a file or dir: /etc</span><br><span class="line">A dir</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./file.sh</span></span><br><span class="line">Input a file or dir: /etc/passwd</span><br><span class="line">A normal file</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./file.sh</span></span><br><span class="line">Input a file or dir: sasasa</span><br><span class="line">File not exist</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./file.sh</span></span><br><span class="line">Input a file or dir:</span><br><span class="line">ERROR, reinput</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> $?</span></span><br><span class="line">69</span><br></pre></td></tr></table></figure><h4 id="case"><code>case</code></h4><p>语法</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">case $v in</span><br><span class="line">case1)</span><br><span class="line">do something</span><br><span class="line">;;</span><br><span class="line">case2)</span><br><span class="line">do something</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">do something</span><br><span class="line">;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>例</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -p &quot;Inpuy yes/no: &quot; -t 30 a</span><br><span class="line">case $a in</span><br><span class="line">        &quot;yes&quot;)</span><br><span class="line">                echo yes!</span><br><span class="line">                ;;</span><br><span class="line">        &quot;no&quot;)</span><br><span class="line">                echo no!</span><br><span class="line">                ;;</span><br><span class="line">        *)</span><br><span class="line">                echo error!</span><br><span class="line">                ;;</span><br><span class="line">esac</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./case.sh</span></span><br><span class="line">Inpuy yes/no: no</span><br><span class="line">no!</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./case.sh</span></span><br><span class="line">Inpuy yes/no: yes</span><br><span class="line">yes!</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./case.sh</span></span><br><span class="line">Inpuy yes/no: 11</span><br><span class="line">error!</span><br></pre></td></tr></table></figure><h4 id="for"><code>for</code></h4><p>格式 1</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in a b c d...</span><br><span class="line">do</span><br><span class="line">do something</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>格式 2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for ((i=1;i&lt;=100;i=i+1))</span><br><span class="line">do</span><br><span class="line">do something</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>例：批量压缩文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for file in $(ls ~)</span><br><span class="line">        do</span><br><span class="line">                tar -cf $file.tar $file</span><br><span class="line">        done</span><br></pre></td></tr></table></figure><p>例：指定循环次数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> for1.sh</span></span><br><span class="line">s=0</span><br><span class="line">for ((i=1;i&lt;=100;i++))</span><br><span class="line">        do</span><br><span class="line">                s=$(($s+$i))</span><br><span class="line">        done</span><br><span class="line">echo &quot;s=$s&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./for1.sh</span></span><br><span class="line">s=5050</span><br></pre></td></tr></table></figure><h4 id="while"><code>while</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while []</span><br><span class="line">do</span><br><span class="line">dosomething</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>例：求和</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">i=1</span><br><span class="line">s=0</span><br><span class="line"></span><br><span class="line">while [ $i -le 100 ]</span><br><span class="line">        do</span><br><span class="line">                s=$(($s+$i))</span><br><span class="line">                i=$(($i+1))</span><br><span class="line">        done</span><br><span class="line">echo &quot;sum = $s&quot;</span><br></pre></td></tr></table></figure><h4 id="until"><code>until</code></h4><p>只要循环判断不成立就一直循环</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">until []</span><br><span class="line">do</span><br><span class="line">do something</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>例：求和</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">i=1</span><br><span class="line">s=0</span><br><span class="line"></span><br><span class="line">until [ $i -gt 100 ] # i &gt; 100 时，循环终止</span><br><span class="line">        do</span><br><span class="line">                s=$(($s+$i))</span><br><span class="line">                i=$(($i+1))</span><br><span class="line">        done</span><br><span class="line">echo &quot;sum = $s&quot;</span><br></pre></td></tr></table></figure><h3 id="的用法总结"><code>$</code>  的用法总结</h3><p>常见用法</p><ol><li>引用 <code>echo $x</code></li><li>位置参数变量 <code>$0 $1-9 $&#123;10&#125;... $* $@ $# </code></li><li>预定义变量 <code>$? $$ $!</code></li><li>数值运算 <code>$&#123;&#123;&#125;&#125; $[]</code></li><li>引用系统命令 <code>echo $(date)</code></li><li>数组索引 <code>$&#123;arr[1]&#125;</code></li></ol><h4 id="shell-数组">shell 数组</h4><p>bash 支持一维数组（不支持多维数组），并且没有限定数组的大小。</p><p>括号表示数组，数值之间用空格分隔：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">arr=(1 2 3 4)</span><br><span class="line">arr=(</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>或者单独定义：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[1]=10</span><br><span class="line">arr[2]=20</span><br></pre></td></tr></table></figure><p>使用 <code>$&#123;arr[]&#125;</code> 形式索引，下标从 0 开始：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$&#123;arr[1]&#125;</span></span></span><br><span class="line">20</span><br></pre></td></tr></table></figure><p>获取数组所有元素：<code>$&#123;arr[@]&#125;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$&#123;arr[@]&#125;</span></span></span><br><span class="line">2 10 20 5 6</span><br></pre></td></tr></table></figure><p>获取数组长度：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;#arr[@]&#125;</span><br><span class="line">echo $&#123;#arr[*]&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">某个元素长度</span></span><br><span class="line">echo $&#123;#arr[n]&#125;</span><br></pre></td></tr></table></figure><h2 id="Vim-常用操作">Vim 常用操作</h2><p>vim 的三种模式</p><ul><li>命令模式：进入 Vim 后的默认模式</li><li>插入模式：<code>aio</code> 后进入</li><li>编辑模式：命令模式下按 <code>:</code></li></ul><h3 id="插入命令-2">插入命令</h3><p><code>A</code>：行尾插入</p><p><code>I</code>：行首插入</p><p><code>i</code>：光标当前位置插入</p><p><code>o</code>：向下插入一行</p><p><code>O</code>：向上插入一行</p><h3 id="定位命令-2">定位命令</h3><p><code>:set nu</code>：设置行号</p><p><code>:set nonu</code>：取消行号</p><p><code>gg</code>：到第一行</p><p><code>G</code>：到最后一行</p><p><code>nG</code>：到第 n 行</p><p><code>:n</code>：到第 n 行（用得更多）</p><p><code>$</code>：移至行尾</p><p><code>0</code>：移至行首</p><h3 id="删除命令-2">删除命令</h3><p><code>x</code>：删除光标后字符</p><p><code>nx</code>：删除 n 个</p><p><code>dd</code>：删除此行</p><p><code>ndd</code>：删除 n 行</p><p><code>dG</code>：删除光标后所有文字</p><p><code>D</code>：删除光标后到行尾文字</p><p><code>:n1,n2d</code>：删除指定行</p><h3 id="复制剪切命令">复制剪切命令</h3><p><code>yy</code>：复制此行</p><p><code>nyy</code>：复制此行以下 n 行</p><p><code>dd</code>：剪切此行</p><p><code>ndd</code>：剪切此行以下 n 行</p><p><code>p</code>：粘贴至下一行</p><p><code>P</code>：粘贴至上一行</p><h3 id="替换取消命令">替换取消命令</h3><p><code>r</code>：取代光标所在处字符</p><p><code>R</code>：一直替换，ESC 退出</p><p><code>u</code>：撤销上一步</p><h3 id="搜索命令">搜索命令</h3><p><code>/string</code>：搜索关键词</p><p><code>set ic</code>：忽略大小写</p><p><code>set noic</code></p><p><code>n</code>：找下一个</p><p><code>%s/old/new/g</code>：全文替换（<code>c</code>：询问确认）</p><p><code>:n1,n2s/old/new/g</code>：指定行替换</p><h3 id="保存退出命令">保存退出命令</h3><p><code>:w</code>：保存修改</p><p><code>:w newfile</code>：另存为</p><p><code>:wq</code>：保存修改并退出</p><p><code>ZZ</code>：保存修改并退出，快捷键</p><p><code>:q!</code>：不保存修改退出</p><p><code>:wq!</code>：保存修改并退出（root 及所有者可用）</p><h2 id="Vim-使用技巧">Vim 使用技巧</h2><p><code>:r !命令</code>：导入命令的执行结果</p><p><code>:r 文件</code>：导入文件内容</p><p><code>:!命令</code>：暂时退出 vim 执行命令</p><p><code>:map 快捷键 操作</code>：自定义快捷键，如 <code>Cril+/</code> 注释一行：<code>:map ^_ I# &lt;ESC&gt;</code></p><p><code>:n1,n2s/^/# /g</code>：连续注释行</p><p><code>:n1,n2s/# //g</code>：取消注释行</p><p><code>:n1,n2s/^# //g</code>：只取消行首的 <code>#</code></p><p><code>:1,5s/^/\/\//g</code>：<code>//</code> 注释</p><p><code>:1,5s/^\/\///g</code>：取消行首 <code>//</code> 注释</p><p><code>:ab mymail 10001@qq.com</code>：替换字符，输入 <code>mymail</code> 即可替换</p><h2 id="Vim-配置文件">Vim 配置文件</h2><p>配置文件：<code>~/.vimrc</code></p><p>编写时前面不用加 <code>:</code> 号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 学习笔记 </tag>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ggplot 中的字体大小、圆点大小和线条粗细探究</title>
      <link href="/posts/44687/"/>
      <url>/posts/44687/</url>
      
        <content type="html"><![CDATA[<p>ggplot，R 中的可视化神器。ggplot 的出图美观漂亮、简约大气，自定义程度极高，图中的所有元素均可以修改，没错，是所有元素。</p><p>但是在使用过程中，有个问题一直困扰着我，输出的图分辨率多大合适？字体多大比较合适？还有一点比较疑惑的，ggplot 里面的字体大小不知道用的什么单位，px？pt？或者是其他？好像还存在着某种换算关系，比如设置 <code>size=20</code>，输出 PDF 查看字体大小并不是 20 磅，要大一些。</p><h2 id="问题描述-2">问题描述</h2><p>画个图，字体：20，横线宽度：3，点大小：3</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>women<span class="punctuation">,</span> aes<span class="punctuation">(</span>height<span class="punctuation">,</span>y<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;Font Size=20&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">64</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">160</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">20</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">140</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span>annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;size=3&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">142</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span> x<span class="operator">=</span><span class="number">60</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">150</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;1.pdf&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>用 Ai 打开看字体大小和线条粗细</p><p>字体：57pt，线条描边：6.4pt，点：7.11pt + 0.71pt/2 = 7.465pt（总大小），跟设置值好像毫无关联啊……</p><img src="https://s2.loli.net/2022/06/17/ylN3SXmWJKTAx7Q.png" alt="image-20220617140424633" style="zoom:80%;" /><p>再看<a href="https://ggplot2.tidyverse.org/reference/element.html">官网</a>对 <code>element_blank()</code> <code>element_rect()</code> <code>element_line()</code> <code>element_text()</code> 的 <code>size</code> 参数的描述</p><blockquote><p><strong>size</strong></p><p>Line/border size in mm; text size in pts.</p></blockquote><p>线/描边单位是毫米，文本是点</p><p>试一下看看，把坐标轴文本大小设置为 20</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>women<span class="punctuation">,</span> aes<span class="punctuation">(</span>height<span class="punctuation">,</span>y<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;Font Size=20&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">64</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">160</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">20</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">140</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span>annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;size=3&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">142</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span> x<span class="operator">=</span><span class="number">60</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">150</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>Ai 里面显示文本确实是 20pt，看来在 ggplot 中单位并不都是 pt，不使用 <code>element_xxx()</code> 类型设置的元素存在一个换算关系。</p><img src="https://s2.loli.net/2022/06/17/JFujX312WdfbTe8.png" alt="image-20220617141503261" style="zoom:80%;" /><h2 id="解决方法-2">解决方法</h2><h3 id="文本和线宽">文本和线宽</h3><p>简书上有<a href="https://www.jianshu.com/p/054107c7aac3">一个帖子</a>的方法挺有用的，简单来说就是不用 <code>element_xxx()</code> 设置元素时，<code>size</code> 参数都要除以某个比例才能转换成熟悉的 pt。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot2<span class="operator">::</span>.pt</span><br><span class="line"><span class="comment"># [1] 2.845276</span></span><br><span class="line">f.pt <span class="operator">&lt;-</span> .pt</span><br><span class="line">l.pt <span class="operator">&lt;-</span> .pt<span class="operator">*</span><span class="number">72.27</span><span class="operator">/</span><span class="number">96</span></span><br><span class="line">l.pt</span><br><span class="line"><span class="comment"># [1] 2.141959</span></span><br></pre></td></tr></table></figure><p>文本的 <code>size</code> 参数要 ÷ <code>f.pt</code>，线的 <code>size</code> 参数要 ÷ <code>l.pt</code>，就可以把各种大小都换算成 pt 单位了。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>women<span class="punctuation">,</span> aes<span class="punctuation">(</span>height<span class="punctuation">,</span>y<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;Font Size=20&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">64</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">160</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">20</span><span class="operator">/</span>f.pt<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">140</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="operator">/</span>l.pt<span class="punctuation">)</span><span class="operator">+</span>annotate<span class="punctuation">(</span>label<span class="operator">=</span><span class="string">&#x27;size=3&#x27;</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">142</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>非常完美！</p><img src="https://s2.loli.net/2022/06/17/ETJV7nKSIWLMy3B.png" alt="image-20220617143109076" style="zoom:70%;" /><h3 id="点">点</h3><p>关于点的大小，比较复杂，因为点有不同的形状，通过 <code>shape</code> 参数控制。</p><p><img src="https://r-graphics.org/R-Graphics-Cookbook-2e_files/figure-html/FIG-SCATTER-SHAPES-CHART-1.png" alt="ggplot 中不同点的形状"></p><p>形状 21-24 含有描边，这时候点的大小由两个参数控制， <code>size</code> 参数控制填充大小，<code>stroke</code> 参数控制描边大小，单位均为<strong>毫米</strong>。</p><p><img src="https://ggplot2.tidyverse.org/articles/ggplot2-specs_files/figure-html/unnamed-chunk-9-1.png" alt="描边和填充大小"></p><h2 id="输出-PDF-大小">输出 PDF 大小</h2><p>具体还是要根据期刊的要求来，毕业论文里面我的设置是图 <code>10cm×8cm</code> 左右，文字大小 <code>9pt</code> 左右，线宽 <code>0.75pt</code> 左右，打印出来清晰美观，比较合适。</p><p>代码如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mytheme <span class="operator">&lt;-</span> theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.75</span><span class="operator">/</span>l.pt<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>lineend <span class="operator">=</span> <span class="string">&quot;square&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.75</span><span class="operator">/</span>l.pt<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;1.pdf&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>绘图的时候直接 <code>+mytheme</code> 就可以了。</p><p>最后贴一张效果图</p><img src="https://s2.loli.net/2022/06/17/XbmS3w8GHxQz1YI.png" alt="效果图" style="zoom:50%;" /><p>参考</p><blockquote><p><a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#font-size">Aesthetic specifications • ggplot2 (tidyverse.org)</a></p><p><a href="https://www.jianshu.com/p/054107c7aac3">R语言学习笔记 – ggplot2 绘图指定字体大小与线宽 - 简书 (jianshu.com)</a></p><p><a href="https://r-graphics.org/recipe-scatter-shapes#RECIPE-SCATTER-SHAPES">5.3 Using Different Point Shapes | R Graphics Cookbook, 2nd edition (r-graphics.org)</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R 软件安装避坑</title>
      <link href="/posts/37975/"/>
      <url>/posts/37975/</url>
      
        <content type="html"><![CDATA[<p>学校图书馆机房用的电脑带有硬盘保护卡，每次重启都会恢复到初始状态。就这样我去一次图书馆用电脑就要装一次 R，都装出经验来了。</p><h2 id="安装路径">安装路径</h2><p>不要保持默认的 <code>C:\Program Files (x86)</code> 或 <code>C:\Program Files</code>，之后装 R 包可能会出现权限问题，每次还得管理员模式运行，很麻烦。建议改成下面的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">总目录：C:\R</span><br><span class="line">R：C:\R\R-x.x.x</span><br><span class="line">RStudio：C:\R\RStudio</span><br><span class="line">Rtools：C:\R\rtoolsxx</span><br><span class="line">Java：C:\R\Java</span><br><span class="line">………</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2022/08/02/MvPwp4FDYuSgkan.png" alt="软件安装路径" style="zoom:80%;" /><h2 id="控制台输出英文">控制台输出英文</h2><p>这样报错就会变成英文，相对来说，英文更好搜索解决方法。</p><p>安装 R 的时候取消勾选 Message Translation 即可。</p><h2 id="快速恢复设置">快速恢复设置</h2><p>RStudio 升级后，设置就没了，就没了！所以，升级之前先备份一下设置，菜单栏找到 <code>Help→Diagnostics→Edit User Prefs File</code>，复制即可，恢复设置同理。</p><p><img src="https://s2.loli.net/2022/08/02/eiXIhjngPLDGtfk.png" alt="设置"></p><p>我的设置（RStudio 版本：2022.02.2 Build 485）</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;editor_theme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rscodeio&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;help_font_size_points&quot;</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;initial_working_directory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;~&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;graphics_backend&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cairo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;font_size_points&quot;</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;windows_terminal_shell&quot;</span><span class="punctuation">:</span> <span class="string">&quot;win-git-bash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;global_theme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;alternate&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;highlight_selected_line&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scroll_past_end_of_document&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;highlight_r_function_calls&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;syntax_color_console&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;console_double_click_select&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;panes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;quadrants&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;Source&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Console&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;TabSet1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;TabSet2&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;tabSet1&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;Environment&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;History&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Connections&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Build&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;VCS&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Tutorial&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Presentation&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;tabSet2&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;Files&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Plots&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Packages&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Help&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Viewer&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;Presentations&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hiddenTabSet&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;console_left_on_top&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;console_right_on_top&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;additional_source_columns&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;default_encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jobs_tab_visibility&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shown&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;default_project_location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:/Users/liuao/R_Project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rainbow_parentheses&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="定制主题">定制主题</h2><p>根据 <a href="https://github.com/anthonynorth/rscodeio">Github</a> 项目修改的主题，一体黑配色，统一编辑器和帮助界面字体，代码高亮主题是熟悉的 Atom One Dark，表格显示优化等，配合 JetBrains Mono 字体最佳。</p><p><img src="https://s2.loli.net/2022/08/02/G4z8WVPUHj5wmLl.png" alt="界面"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;remotes&#x27;</span><span class="punctuation">)</span> <span class="comment"># 没有的话先安装</span></span><br><span class="line">remotes<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&#x27;janedut/rtheme&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>PS：欢迎提交 <a href="https://github.com/janedut/rtheme">Bug</a></p>]]></content>
      
      
      <categories>
          
          <category> 经验分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【魔改】去除标签和分类页子页面的侧边栏</title>
      <link href="/posts/29090/"/>
      <url>/posts/29090/</url>
      
        <content type="html"><![CDATA[<h2 id="Butterfly-主题-Bug">Butterfly 主题 Bug</h2><p>当你想隐藏侧边栏时，可以在设置 <code>aside=false</code>，但这个选项似乎对标签和分类的子页面没有效果，比如 <code>/tags/日记</code>。全局隐藏侧边栏后虽然可以解决，但是主页的侧边栏又没有了……</p><p>店长评论区有用 JS 解决的方法，但是我不喜欢，因为要额外引入。今天查看源码解决了，增加几个判断代码就行。</p><img src="https://s2.loli.net/2022/08/02/8CEoTBPmKQn7ceg.png" alt="子页面侧边栏仍然存在" style="zoom:80%;" /><h2 id="解决方法-3">解决方法</h2><p>Hexo 自带判断页面类型的函数，详见<a href="https://hexo.io/zh-cn/docs/helpers.html#%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0">条件函数</a>。</p><p>要用到这两个：</p><p><code>is_tag</code>：检查当前页面是否为标签归档页面</p><p><code>is_category</code>：检查当前页面是否为分类归档页面</p><p>打开文件 <code>&quot;\hexo-theme-butterfly\layout\includes\layout.pug&quot;</code>，找到第 3 行</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- - var hideAside = !theme.aside.enable || page.aside === false ? &#x27;hide-aside&#x27; : &#x27;&#x27;</span></span><br><span class="line"><span class="addition">+ - var hideAside = !theme.aside.enable || is_tag() || is_category() || page.aside === false ? &#x27;hide-aside&#x27; : &#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>判断页面是标签或者分类页时，使 <code>hideAside='hide-aside'</code>。</p><p>再找到第 28 行</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- if theme.aside.enable &amp;&amp; page.aside !== false</span></span><br><span class="line"><span class="addition">+ if theme.aside.enable &amp;&amp; page.aside !== false &amp;&amp; !is_tag() &amp;&amp; !is_category()</span></span><br></pre></td></tr></table></figure><p>判断页面为标签或者分类页时，不引入侧边栏。</p><p>Hexo 三连即可看见效果，子页面的侧边栏成功去除，<a href="https://aohuiliu.fun/tags/R/">点击查看</a>。</p><img src="https://s2.loli.net/2022/08/02/DWtjBg1OipUYGoa.png" style="zoom:80%;" /><p>但是往下滑动页面，这个按钮出来了，还是有 bug。</p><p><img src="https://s2.loli.net/2022/08/02/RWv1cOJebX8uGpS.png" alt=""></p><p>打开文件 <code>&quot;\hexo-theme-butterfly\layout\includes\rightside.pug&quot;</code></p><p>找到 <code>when 'hideAside'</code> 下一行</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- if aside.enable &amp;&amp; aside.button &amp;&amp; page.aside !== false</span></span><br><span class="line"><span class="addition">+ if aside.enable &amp;&amp; aside.button &amp;&amp; !is_tag() &amp;&amp; !is_category() &amp;&amp; page.aside !== false</span></span><br></pre></td></tr></table></figure><p>大功告成！</p>]]></content>
      
      
      <categories>
          
          <category> 博客魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>24 个 R 的高效操作</title>
      <link href="/posts/27153/"/>
      <url>/posts/27153/</url>
      
        <content type="html"><![CDATA[<h2 id="修改默认提示语言">修改默认提示语言</h2><p>R 默认提示的语言有的人是英文，有的人是中文，这是因为每个人系统默认语言不同，可以通过下面方式进行修改<br>（装 R 的时候不勾选 message transition 选项也可以）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sys.getlocale<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment"># 显示系统语言</span></span><br><span class="line">Sys.setenv<span class="punctuation">(</span>LANG<span class="operator">=</span><span class="string">&quot;en&quot;</span><span class="punctuation">)</span> <span class="comment"># 更换默认语言为英文</span></span><br></pre></td></tr></table></figure><h2 id="查看-R-占用内存">查看 R 占用内存</h2><p>可以使用 <code>memory.size()</code> 获取内存大小，不过该函数仅限 Windows 系统。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">memory.size<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment"># 获取内存大小</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">341</span></span><br></pre></td></tr></table></figure><h2 id="查看数据集内存占用">查看数据集内存占用</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> object.size<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="number">7208</span> bytes</span><br><span class="line"><span class="operator">&gt;</span> object.size<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="operator">/</span><span class="number">1024</span> <span class="comment"># 以kb显示</span></span><br><span class="line"><span class="number">7</span> bytes  </span><br></pre></td></tr></table></figure><h2 id="代码中换行">代码中换行</h2><p>默认回车是运行代码，在 Rstudio 中有自动补齐，比如定义一个函数，直接自动补齐了 <code>&#123;&#125;</code>，回车就运行了，可以使用 shift+enter 换行</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="边赋值边显示">边赋值边显示</h2><p>默认赋值完，直接敲变量名就打印数据，可以利用下面方式一步完成两个操作。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>x <span class="operator">&lt;-</span> runif<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">0.5795985</span> <span class="number">0.4661326</span> <span class="number">0.9730974</span> <span class="number">0.6697417</span> <span class="number">0.2431985</span> <span class="number">0.3988545</span> <span class="number">0.4064351</span> <span class="number">0.8403910</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">9</span><span class="punctuation">]</span> <span class="number">0.3136191</span> <span class="number">0.9979925</span></span><br></pre></td></tr></table></figure><h2 id="查看源代码">查看源代码</h2><p>如果想查看 R 函数的源代码，直接输入函数名，不加括号即可。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> mean</span><br><span class="line"><span class="keyword">function</span> <span class="punctuation">(</span>x<span class="punctuation">,</span> ...<span class="punctuation">)</span> </span><br><span class="line"><span class="built_in">UseMethod</span><span class="punctuation">(</span><span class="string">&quot;mean&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&lt;</span>bytecode<span class="operator">:</span> <span class="number">0x0000023e3b8db998</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>environment<span class="operator">:</span> namespace<span class="operator">:</span>base<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><h2 id="利用函数修改镜像">利用函数修改镜像</h2><p>如果不设置 R 镜像，每次安装 R 包是都会弹出选择框，可以在安装之前通过函数进行设置，使用 <code>chooseCRANmirror()</code> 函数，给定 <code>ind</code> 选项一个数值即可。数值代表镜像编号。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> chooseCRANmirror<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">Secure CRAN mirrors </span><br><span class="line"></span><br><span class="line"> <span class="number">1</span><span class="operator">:</span> <span class="number">0</span><span class="operator">-</span>Cloud <span class="punctuation">[</span>https<span class="punctuation">]</span>                       <span class="number">2</span><span class="operator">:</span> Australia <span class="punctuation">(</span>Canberra<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>       </span><br><span class="line"> <span class="number">3</span><span class="operator">:</span> Australia <span class="punctuation">(</span>Melbourne <span class="number">1</span><span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>       <span class="number">4</span><span class="operator">:</span> Australia <span class="punctuation">(</span>Melbourne <span class="number">2</span><span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>    </span><br><span class="line"> <span class="number">5</span><span class="operator">:</span> Australia <span class="punctuation">(</span>Perth<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>             <span class="number">6</span><span class="operator">:</span> Austria <span class="punctuation">[</span>https<span class="punctuation">]</span>                    </span><br><span class="line"> <span class="number">7</span><span class="operator">:</span> Brazil <span class="punctuation">(</span>BA<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>                   <span class="number">8</span><span class="operator">:</span> Brazil <span class="punctuation">(</span>PR<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>                </span><br><span class="line"> <span class="number">9</span><span class="operator">:</span> Brazil <span class="punctuation">(</span>RJ<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>                  <span class="number">10</span><span class="operator">:</span> Brazil <span class="punctuation">(</span>SP <span class="number">1</span><span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>              </span><br><span class="line"><span class="number">11</span><span class="operator">:</span> Brazil <span class="punctuation">(</span>SP <span class="number">2</span><span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>                <span class="number">12</span><span class="operator">:</span> Bulgaria <span class="punctuation">[</span>https<span class="punctuation">]</span>                   </span><br><span class="line"><span class="number">13</span><span class="operator">:</span> Canada <span class="punctuation">(</span>MB<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>                  <span class="number">14</span><span class="operator">:</span> Chile <span class="punctuation">(</span>Santiago<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>           </span><br><span class="line"><span class="number">15</span><span class="operator">:</span> China <span class="punctuation">(</span>Beijing <span class="number">2</span><span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>            <span class="number">16</span><span class="operator">:</span> China <span class="punctuation">(</span>Hefei<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>              </span><br><span class="line"><span class="number">17</span><span class="operator">:</span> China <span class="punctuation">(</span>Hong Kong<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span>            <span class="number">18</span><span class="operator">:</span> China <span class="punctuation">(</span>Guangzhou<span class="punctuation">)</span> <span class="punctuation">[</span>https<span class="punctuation">]</span> </span><br><span class="line"><span class="operator">&gt;</span> chooseCRANmirror<span class="punctuation">(</span>ind <span class="operator">=</span> <span class="number">18</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="显示更多数据">显示更多数据</h2><p>默认 R 显示 1000 行数据，如果想显示更多，可以通过设置 <code>max.print</code> 选项。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;max.print&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>max.print</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;max.print&#x27;</span><span class="operator">=</span><span class="number">2000</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;max.print&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>max.print</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2000</span></span><br></pre></td></tr></table></figure><h2 id="默认保留小数点">默认保留小数点</h2><p>默认 R 显示 7 为小数，如果想默认保留两位小数，可以通过设置 <code>digits</code> 选项。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;digits&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>digits</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;digits&#x27;</span><span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> options<span class="punctuation">(</span><span class="string">&#x27;digits&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">$</span>digits</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="管道">管道</h2><p>使用管道让代码更加简洁，无需定义过多中间变量。R中的管道符号为 <code>%&gt;%</code> 如果要使用管道，需要加载 <code>magrittr</code> 包。其实 Rstudio 出的各种包都默认支持管道，如果加载了 <code>tidyverse</code> 包也是可以。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>magrittr<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars <span class="operator">%&gt;%</span> ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>cyl<span class="punctuation">,</span>y<span class="operator">=</span>mpg<span class="punctuation">,</span>group<span class="operator">=</span>cyl<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="拆分列数据">拆分列数据</h2><p>有些时候记不住列名，或者容易拼错，想要列名也能够自动补齐，可以使用 <code>attach</code> 函数，这样每一列就变成一个独立的变量。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">attach<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> cyl</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">8</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">8</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span></span><br><span class="line"><span class="operator">&gt;</span> mpg</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">21.0</span> <span class="number">21.0</span> <span class="number">22.8</span> <span class="number">21.4</span> <span class="number">18.7</span> <span class="number">18.1</span> <span class="number">14.3</span> <span class="number">24.4</span> <span class="number">22.8</span> <span class="number">19.2</span> <span class="number">17.8</span> <span class="number">16.4</span> <span class="number">17.3</span> <span class="number">15.2</span> <span class="number">10.4</span> <span class="number">10.4</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">17</span><span class="punctuation">]</span> <span class="number">14.7</span> <span class="number">32.4</span> <span class="number">30.4</span> <span class="number">33.9</span> <span class="number">21.5</span> <span class="number">15.5</span> <span class="number">15.2</span> <span class="number">13.3</span> <span class="number">19.2</span> <span class="number">27.3</span> <span class="number">26.0</span> <span class="number">30.4</span> <span class="number">15.8</span> <span class="number">19.7</span> <span class="number">15.0</span> <span class="number">21.4</span></span><br></pre></td></tr></table></figure><h2 id="默认加载包">默认加载包</h2><p>如果一些包经常使用，想要启动R之后自动加载，可以在配置文件中进行设置，例如每期启动 R，自动加载 <code>ggplot2</code> 包。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">file.edit<span class="punctuation">(</span><span class="string">&quot;~/.Rprofile&quot;</span><span class="punctuation">)</span></span><br><span class="line">.First <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="为R添加额外扩展包加载路径">为R添加额外扩展包加载路径</h2><p>默认 R 包的加载目录在 <code>.libPaths()</code> 目录中，当然可以为其添加更多的路径。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> .libPaths<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;C:/Users/genom/Documents/R/win-library/4.0&quot;</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="string">&quot;C:/Program Files/R/R-4.0.3/library&quot;</span>        </span><br><span class="line"><span class="operator">&gt;</span> .libPaths<span class="punctuation">(</span>new <span class="operator">=</span> <span class="string">&quot;C:/Users/genom/Desktop/nparFiles/&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> .libPaths<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;C:/Users/genom/Desktop/nparFiles&quot;</span>   <span class="string">&quot;C:/Program Files/R/R-4.0.3/library&quot;</span></span><br></pre></td></tr></table></figure><h2 id="迁移-R-包">迁移 R 包</h2><p>如果需要将一台设备安装的 R 包，在另外一台设备上安装，首先保存 A 设备上的 R 包名字列表，在另外一台设备上写一个循环进行安装。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 A 设备上保存名字列表</span></span><br><span class="line">oldip <span class="operator">&lt;-</span> installed.packages<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">save<span class="punctuation">(</span>oldip<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;installedPacckages.Rdata&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 B 设备上进行安装；</span></span><br><span class="line">load<span class="punctuation">(</span><span class="string">&quot;installedPacckages.Rdata&quot;</span><span class="punctuation">)</span></span><br><span class="line">newip <span class="operator">&lt;-</span> installed.packages<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"> <span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> setdiff<span class="punctuation">(</span>oldip<span class="punctuation">,</span>newip<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  install.packages<span class="punctuation">(</span>i<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="列出-R-包中的函数">列出 R 包中的函数</h2><p>如果想查看一个 R 包中全部函数，可以使用下面的语句。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls<span class="punctuation">(</span>package<span class="operator">:</span>base<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="不加载包使用其中函数">不加载包使用其中函数</h2><p>如果加载 R 包，还想使用其中的函数，需要使用 <code>包名::函数</code> 的方式。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dplyr<span class="operator">::</span>filter<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="快速获取颜色">快速获取颜色</h2><p>在绘图的时候，想要快速设置几个不同的颜色，又嫌生成颜色比较麻烦。可以使用 <code>rainbow()</code> 函数，给定一个数据，快速生成颜色。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> rainbow<span class="punctuation">(</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;#FF0000&quot;</span> <span class="string">&quot;#FFFF00&quot;</span> <span class="string">&quot;#00FF00&quot;</span> <span class="string">&quot;#00FFFF&quot;</span> <span class="string">&quot;#0000FF&quot;</span> <span class="string">&quot;#FF00FF&quot;</span></span><br></pre></td></tr></table></figure><h2 id="炸开数据"><strong>炸开数据</strong></h2><p>前面介绍了 <code>attach()</code> 函数可以将每一列变成一个单独变量，但这种方式并不推荐，因为会让变量环境很混乱。可以使用一个特殊管道符 <code>%$%</code> 实现同样的效果，我称之为把数据“炸开”</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>magrittr<span class="punctuation">)</span></span><br><span class="line">Warning message<span class="operator">:</span></span><br><span class="line">程辑包‘magrittr’是用R版本<span class="number">3.6</span>.3来建造的 </span><br><span class="line"><span class="operator">&gt;</span> women <span class="operator">%$%</span> plot<span class="punctuation">(</span>weight<span class="punctuation">,</span>height<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="巧用-example-函数学习绘图">巧用 <code>example()</code> 函数学习绘图</h2><p><code>example()</code> 函数会帮助运行 R 帮助文档中的代码，有时候想看一个函数如何使用，可以直接运行这个函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> example<span class="punctuation">(</span><span class="string">&quot;pheatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> <span class="comment"># Create test matrix</span></span><br><span class="line">phetmp<span class="operator">&gt;</span> test <span class="operator">=</span> matrix<span class="punctuation">(</span>rnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> test<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> test<span class="punctuation">[</span><span class="number">11</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">11</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> test<span class="punctuation">[</span><span class="number">15</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">15</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> colnames<span class="punctuation">(</span>test<span class="punctuation">)</span> <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;Test&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> rownames<span class="punctuation">(</span>test<span class="punctuation">)</span> <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;Gene&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phetmp<span class="operator">&gt;</span> <span class="comment"># Draw heatmaps</span></span><br><span class="line">phetmp<span class="operator">&gt;</span> pheatmap<span class="punctuation">(</span>test<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="统计计算时间">统计计算时间</h2><p>想统计一条代码运行时间，可以使用 <code>system.time()</code> 函数</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> system.time<span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">100000000</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">用户 系统 流逝 </span><br><span class="line"><span class="number">2.75</span> <span class="number">0.08</span> <span class="number">2.83</span> </span><br></pre></td></tr></table></figure><h2 id="释放内存">释放内存</h2><p>R 有一套自己的内存回收机制，因此，即使删除了变量，内存不会立即变化，可以使用 <code>gc()</code> 函数释放内存。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> memory.size<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">297.56</span></span><br><span class="line"><span class="operator">&gt;</span> rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> memory.size<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">298.54</span></span><br><span class="line"><span class="operator">&gt;</span> gc<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">          used <span class="punctuation">(</span>Mb<span class="punctuation">)</span> gc trigger  <span class="punctuation">(</span>Mb<span class="punctuation">)</span> <span class="built_in">max</span> used  <span class="punctuation">(</span>Mb<span class="punctuation">)</span></span><br><span class="line">Ncells <span class="number">1384255</span> <span class="number">74.0</span>    <span class="number">4046672</span> <span class="number">216.2</span>  <span class="number">4046672</span> <span class="number">216.2</span></span><br><span class="line">Vcells <span class="number">4288164</span> <span class="number">32.8</span>   <span class="number">27057220</span> <span class="number">206.5</span> <span class="number">33821525</span> <span class="number">258.1</span></span><br><span class="line"><span class="operator">&gt;</span> memory.size<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">255.5</span></span><br></pre></td></tr></table></figure><h2 id="删除全部变量">删除全部变量</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示全部变量内容</span></span><br><span class="line"><span class="operator">&gt;</span> ls<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line"><span class="operator">&gt;</span> rm<span class="punctuation">(</span><span class="built_in">list</span><span class="operator">=</span>ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 释放内存</span></span><br><span class="line"><span class="operator">&gt;</span> gc<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="恢复默认数据集">恢复默认数据集</h2><p>如果不小心将内置数据集删除了，或者新定义同名变量，就会替换原有数据集。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> head<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars<span class="operator">=</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> mtcars</span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span><span class="string">&quot;mtcars&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">                   mpg cyl disp  hp drat    wt  qsec vs am gear carb</span><br><span class="line">Mazda RX4         <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.620</span> <span class="number">16.46</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Mazda RX4 Wag     <span class="number">21.0</span>   <span class="number">6</span>  <span class="number">160</span> <span class="number">110</span> <span class="number">3.90</span> <span class="number">2.875</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line">Datsun <span class="number">710</span>        <span class="number">22.8</span>   <span class="number">4</span>  <span class="number">108</span>  <span class="number">93</span> <span class="number">3.85</span> <span class="number">2.320</span> <span class="number">18.61</span>  <span class="number">1</span>  <span class="number">1</span>    <span class="number">4</span>    <span class="number">1</span></span><br><span class="line">Hornet <span class="number">4</span> Drive    <span class="number">21.4</span>   <span class="number">6</span>  <span class="number">258</span> <span class="number">110</span> <span class="number">3.08</span> <span class="number">3.215</span> <span class="number">19.44</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">Hornet Sportabout <span class="number">18.7</span>   <span class="number">8</span>  <span class="number">360</span> <span class="number">175</span> <span class="number">3.15</span> <span class="number">3.440</span> <span class="number">17.02</span>  <span class="number">0</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line">Valiant           <span class="number">18.1</span>   <span class="number">6</span>  <span class="number">225</span> <span class="number">105</span> <span class="number">2.76</span> <span class="number">3.460</span> <span class="number">20.22</span>  <span class="number">1</span>  <span class="number">0</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="operator">&gt;</span> </span><br></pre></td></tr></table></figure><h2 id="快速获取函数选项参数">快速获取函数选项参数</h2><p>R 函数的选项参数非常多，如果每次都调出帮助文档很麻烦，可以使用 <code>args()</code> 函数，快速打印出函数的选项参数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> args<span class="punctuation">(</span>heatmap<span class="punctuation">)</span></span><br><span class="line"><span class="keyword">function</span> <span class="punctuation">(</span>x<span class="punctuation">,</span> Rowv <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> Colv <span class="operator">=</span> <span class="keyword">if</span> <span class="punctuation">(</span>symm<span class="punctuation">)</span> <span class="string">&quot;Rowv&quot;</span> <span class="keyword">else</span> <span class="literal">NULL</span><span class="punctuation">,</span> </span><br><span class="line">    distfun <span class="operator">=</span> dist<span class="punctuation">,</span> hclustfun <span class="operator">=</span> hclust<span class="punctuation">,</span> reorderfun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>d<span class="punctuation">,</span> </span><br><span class="line">        w<span class="punctuation">)</span> reorder<span class="punctuation">(</span>d<span class="punctuation">,</span> w<span class="punctuation">)</span><span class="punctuation">,</span> add.expr<span class="punctuation">,</span> symm <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> revC <span class="operator">=</span> identical<span class="punctuation">(</span>Colv<span class="punctuation">,</span> </span><br><span class="line">        <span class="string">&quot;Rowv&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> <span class="string">&quot;column&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="string">&quot;none&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> margins <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> ColSideColors<span class="punctuation">,</span> </span><br><span class="line">    RowSideColors<span class="punctuation">,</span> cexRow <span class="operator">=</span> <span class="number">0.2</span> <span class="operator">+</span> <span class="number">1</span><span class="operator">/</span>log10<span class="punctuation">(</span>nr<span class="punctuation">)</span><span class="punctuation">,</span> cexCol <span class="operator">=</span> <span class="number">0.2</span> <span class="operator">+</span> </span><br><span class="line">        <span class="number">1</span><span class="operator">/</span>log10<span class="punctuation">(</span>nc<span class="punctuation">)</span><span class="punctuation">,</span> labRow <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> labCol <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> </span><br><span class="line">    xlab <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> keep.dendro <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> verbose <span class="operator">=</span> getOption<span class="punctuation">(</span><span class="string">&quot;verbose&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">    ...<span class="punctuation">)</span> </span><br><span class="line"><span class="literal">NULL</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
            <tag> 效率 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>成为会使用面向对象编程的程序员吧</title>
      <link href="/posts/25672/"/>
      <url>/posts/25672/</url>
      
        <content type="html"><![CDATA[<p>From: 《计算机是怎样跑起来的》【日】矢泽久雄</p><hr><h2 id="读书笔记-2">读书笔记</h2><h3 id="面向对象编程（OOP，Object-Oriented-Programming）">面向对象编程（OOP，Object Oriented Programming）</h3><p>旨在提升开发大型程序的效率，使程序易于维护。</p><h3 id="对-OOP-的多种理解方法">对 OOP 的多种理解方法</h3><blockquote><p>将关注点置于对象（Object）本身，对象的构成要素包含对象的行为及操作，以此为基础编程。</p></blockquote><h4 id="观点-1：面向对象编程通过把组件拼装到一起构建程序">观点 1：面向对象编程通过把组件拼装到一起构建程序</h4><p>大型程序中需要用到大量的函数和变量。为使代码简洁，将有关的函数和变量汇集到一起。</p><p><strong>类</strong>：把程序中有关联的函数和变量汇集到一起编成的组</p><h4 id="观点-2：面向对象编程能够提升程序的开发效率和可维护性。">观点 2：面向对象编程能够提升程序的开发效率和可维护性。</h4><ul><li>大部分的类都已内置于面向对象编程语言中了，将类组合在一起形成<strong>类库</strong>，类库可以为来自各个领域的程序员使用。</li><li>企业级的程序，需要高可维护性，如果程序使用一组类组装起来的话，就会使维护工作轻松。</li><li>创造类需要考虑程序的开发效率和可维护性，并决定将什么抽象为类，如果一个类的修改导致其他的类也要跟着修改就不行。</li><li>功能升级后，就组件能够被新组件所替换的设计也必不可少，由此对于类的使用者来说，要事先与类的创造者商定类的使用规范，这种规范描述叫做<strong>接口（interface）</strong>。面向对象的语言中提供了关于定义接口的语法。</li></ul><h4 id="观点-3：面向对象编程是适用于大型程序的开发方法">观点 3：面向对象编程是适用于大型程序的开发方法</h4><ul><li>面向对象编程的方法是一种顺应人类思维习惯的方法，拉近了计算机与人的距离。因为在人的直觉中，大件物品都是由组件组装起来的。</li></ul><h4 id="观点-4：面向对象编程就是在为现实世界建模">观点 4：面向对象编程就是在为现实世界建模</h4><ul><li>程序可以在计算机上实现现实世界中的业务和娱乐活动。在 OOP 中，通过思考现实世界是由什么样的对象构成来分析并编写相应的程序，称为建模。</li><li>建模要进行“组件化”和“省略化”两步。</li></ul><h4 id="观点-5：面向对象编程可以借助-UML-设计程序">观点 5：面向对象编程可以借助 UML 设计程序</h4><ul><li>UML：Unified Modeling Language，统一建模语言。</li><li>要一边观察作为程序参照物的现实世界， 一边思考解决的问题是由哪些事物(类)构成的。正因设计时要关注对象，这种方法才被称为面向对象编程。</li><li>在传统开发方法上，首先要考虑程序应该由什么样的功能和数据构成，然后立即确定与之相应的函数和变量。相对地，在面向对象编程的设计中，因为一上来就要确定有哪些类，从而构成程序的函数和变量就必然会被组织到类中。</li></ul><h4 id="观点-6：面向对象编程通过在对象间传递消息驱动程序">观点 6：面向对象编程通过在对象间传递消息驱动程序</h4><ul><li>在面向对象语言中所说的消息传递指的是调用某个对象拥有的函数。</li><li>这符合人对现实世界的认知，在现实世界中，我们也是通过对象间的消息传递来开展业务或度过余暇的。</li><li>在面向对象编程中可以对对象间的消息传递建立模型。</li></ul><h4 id="观点-7：在面向对象编程中使用继承、封装和多态">观点 7：在面向对象编程中使用继承、封装和多态</h4><ul><li>继承（Inheritance）、封装（Encapsulation）和多态（Polymorphism）被称为面向对象编程的三个特性。</li><li>继承：通过继承已存在的类所拥有的成员而生成新的类。如果一个类被多个类所继承，那么修正了这个类，就相当于把继承了这个类的所有类都修正了。可以通过继承高效生成类。</li><li>封装：在类所拥有的成员中，隐藏掉没有必要展现给类调用者的成员。从而将类变为黑盒，易于使用便于维护。</li><li>多态：生成对同一个消息执行多种操作的一组类。减少需要记忆的东西。</li></ul><h3 id="类和对象的区别">类和对象的区别</h3><ul><li>类是对象的定义，而对象是类的实例（Instance）</li><li>在实际编程中，想使用类必须在内存上生成该类的副本，这个副本就是对象。</li><li>类是做饼干的磨具，用模具做出来的饼干是对象。</li></ul><h3 id="类的三种使用方法">类的三种使用方法</h3><ol><li>仅调用类所持有的个别成员（函数和变量）</li><li>在类的定义中包含其他的类（组合）</li><li>通过继承已存在的类定义新的类。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 读书笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>与数据结构成为好朋友的七个要点</title>
      <link href="/posts/64250/"/>
      <url>/posts/64250/</url>
      
        <content type="html"><![CDATA[<p>From: 《计算机是怎样跑起来的》【日】矢泽久雄</p><hr><h2 id="读书笔记">读书笔记</h2><h3 id="变量与内存的关系">变量与内存的关系</h3><p>计算机所处里的数据都存储在了叫内存的 IC 中，内存分割为若干个数据存储单元，每个数据单元可以储存 8 bit（1 字节）的数据，并被分配一个编号，即“地址”。内存的大小为地址的个数。</p><p>变量是数据的容器，是程序中数据存储的最小单位，每个变量都对应着物理上的内存空间。<br>定义变量后，内存上就为该变量预留了一块空间，并以变量名字命名。</p><p>离散的变量有局限性，比如处理多个数据排序时，使用离散的变量很麻烦。</p><h3 id="了解作为数据结构基础的数组">了解作为数据结构基础的数组</h3><p>数组可以存储多个数据，定义数组后操作系统集中分配出一块内存空间，并将空间整体赋予数组名称。</p><p>数组可以通过索引访问。</p><p>数组反映了内存的物理结构本身，内存中存储数据的空间是连续分布的。</p><h3 id="数组的应用">数组的应用</h3><p>将数组的索引与循环计数器（Loop counter）对应使用，如线性搜索算法和冒泡排序算法。</p><h3 id="典型数据结构的类型和概念">典型数据结构的类型和概念</h3><p>数据结构本质上是<em>通过程序从逻辑上改变了内存的物理结构</em>，即数据在内存上呈现出的连续分布状态。</p><p><strong>栈（stack）</strong>：LIFO（Last in first out，后进先出）<br>干草堆，数据像干草一样堆起来，取出干草时是从上往下的顺序，即数据使用的顺序与堆积顺序是相反的，最后被存入的数据是最先被处理的。</p><p><strong>队列（queue）</strong>：FIFO（fist in first out，先进先出）<br>可以想象购票窗口前买票的乘客，与栈相反，排在队头的乘客最先买到车票。即最先被存入的数据是最先被处理的。当无法一下子处理完数据的时候，就可以暂且先把数据排成队。</p><p><strong>链表</strong>：<br>几人手拉手拍成一排，某个人只要松开拉住的那只手，再去拉住另一只手，这一排人的票唉咧顺序就改变了。先松开拉住的手，再让新人加入进来拉住他的手，就完成了数据的插入操作。</p><p><strong>二杈树</strong>：<br>一棵树的每次都分为两杈，每个节点相当于一个数据，是链表的特殊形态。</p><h3 id="实现栈和队列">实现栈和队列</h3><ol><li>实现栈：Python<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">stack = [] <span class="comment">#建立空列表（数组）：元素个数为栈大小</span></span><br><span class="line">stackpointer = <span class="number">0</span> <span class="comment">#栈顶指针：指向栈中最顶端的数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">data</span>): <span class="comment">#入栈函数</span></span><br><span class="line">    stack[stackpointer] = data <span class="comment">#数据存储在栈顶指针所指的位置上</span></span><br><span class="line">    stackpointer += <span class="number">1</span> <span class="comment">#更新栈顶指针的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pop</span>(): <span class="comment">#出栈函数</span></span><br><span class="line">    stackpointer -= <span class="number">1</span> <span class="comment">#更新栈顶指针的值</span></span><br><span class="line"><span class="keyword">return</span> stack[stackpointer] <span class="comment">#把数据从栈顶指针的位置中取出来</span></span><br></pre></td></tr></table></figure></li><li>实现队列：Python <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">queue = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>): </span><br><span class="line">    queue.append() = <span class="string">&#x27;&#x27;</span> <span class="comment">#建立含 100 个元素的空列表</span></span><br><span class="line">setindex = <span class="number">0</span> <span class="comment">#数据存储位置的索引</span></span><br><span class="line">getindex = <span class="number">0</span> <span class="comment">#数据读取位置的索引</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">data</span>): <span class="comment">#存储函数</span></span><br><span class="line">    queue[setindex] = data <span class="comment">#存入数据</span></span><br><span class="line">    setindex += <span class="number">1</span> <span class="comment">#更新标识数据存储位置的索引</span></span><br><span class="line">    <span class="keyword">if</span> setindex &gt;= <span class="number">100</span>: <span class="comment">#如果已经达到数组的末尾则折回开头</span></span><br><span class="line">        setinidex = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get</span>(): <span class="comment">#读取函数</span></span><br><span class="line">    data = queue[getindex] <span class="comment">#读取数据</span></span><br><span class="line">    getindex += <span class="number">1</span> <span class="comment">#更新表示数据读取位置的索引</span></span><br><span class="line">    <span class="keyword">if</span> getindex &gt;= <span class="number">100</span>: <span class="comment">#如果已达末尾则折回开头</span></span><br><span class="line">        getindex = <span class="number">0</span></span><br><span class="line"><span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>可以发现，如果数据一直存放到了数组的末尾，下一个存储位置就折回到数组的开头，相当于数组末尾和开头连接上了，即<em>虽然数组的物理结构是直线，但其逻辑结构已经变成圆环了</em>。</li></ol><h3 id="了解结构体的组成">了解结构体的组成</h3><ul><li>定义：结构体是指把若干个数据项汇集到一处并赋予其名字后所形成的整体。</li><li>一旦定义完结构体，就可以把结构体当工作室一种数据类型，来定义变量。</li><li>被汇集到结构体中的每个数据项都可以被称作结构体的成员（Member）。<br>例：一个存储考试成绩的结构体（C，Python 不知道咋写哈哈）</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TestResult</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> Chinese;</span><br><span class="line">    <span class="type">char</span> Math;</span><br><span class="line">    <span class="type">char</span> English;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="了解链表和二叉树的实现方法">了解链表和二叉树的实现方法</h3><ol><li>链表：类似数组，元素手拉手<ul><li>实现方法:在结构体中添加一个指针类型的变量成员，存储数组中另一个元素的地址，这种结构体称为<strong>自我引用的结构体</strong>，即引用了与自身相同的数据类型。<br>例：将上述结构体改为链表  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Testresult</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> Chinese;</span><br><span class="line">    <span class="type">char</span> Math;</span><br><span class="line">    <span class="type">char</span> English;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TestResult</span>* <span class="title">Ptr</span>;</span> <span class="comment">/*指向其他元素的指针*/</span></span><br><span class="line">&#125;;   </span><br></pre></td></tr></table></figure></li><li><strong>只要更换了 Ptr 值就可以实现不同于内存上的物理排列顺序。</strong></li><li>方便之处在于改变数据顺序不需要改变数据在内存上的位置，程序处理时间会缩短。这个特性也适用于对元素进行删除和插入。</li></ul></li><li>二叉树：同样是自我引用的结构体，只不过改成带有两个连接信息的成员的自我引用结构体。 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Testresult</span>&#123;</span></span><br><span class="line">        <span class="type">char</span> Chinese;</span><br><span class="line">        <span class="type">char</span> Math;</span><br><span class="line">        <span class="type">char</span> English;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">TestResult</span>* <span class="title">Ptr1</span>;</span> <span class="comment">/*指向其他元素的指针1*/</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">TestResult</span>* <span class="title">Ptr2</span>;</span> <span class="comment">/*指向其他元素的指针2*/</span></span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure><ul><li>适用于搜索算法，如“二分查找法”</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 读书笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>洗澡随想</title>
      <link href="/posts/46595/"/>
      <url>/posts/46595/</url>
      
        <content type="html"><![CDATA[<p>想快点把数据处理完，把论文弄完，这样就可以回家了。最近开始想用 R 把图画了，但是我的 R 水平就可以说是约等于没有。然后就陷入了一个思维陷阱，越着急就越学不会，感到焦虑，不能冷静思考。然后跟 aohuiliu 发了点牢骚之后就去洗澡了。</p><p>洗了个澡冷静下来了（不知道为什么，洗澡的时候特别容易思考人生，经常有一些很精彩的想法，然后一出浴室就忘）。觉得反正自己只是喜欢 R 画图的效果，那么从我数据处理的需求来看，只需要会画散点图就能应付毕业论文的图了，最多再加一个曲线拟合。至于相对标准差，建立、处理 data frame，那些暂时都可以用 Excel 代劳，何况还有一些不能说的部分，需要一些所见即所得东西来帮忙。</p><p>吹头发的时候，觉得最近的状态虽然比以前是提高很多了，但是在一些特定的时段还是有些散漫，比如说刚起床、吃完饭、从外面回到宿舍，或者洗澡之后，进入一个专注的状态很难，很多时间就这样飞走了。一个精确到小时的计划是管不住我的这种散漫的，我非常清楚，总而言之不现实。</p><p>晚上这段时间我已想办法利用起来，具体措施就是在 18:30-21:30 限制 iPad 的屏幕使用时间，只允许使用 goodnote，和一些背单词的辅助软件，我发现自己背完单词之后就会变得专注，而从一个散漫的状态进入背单词的状态是对于我来说比较熟悉的转换，这样就可以比较自然地进入心流的状态。最近有的时候体会到了心流是什么感觉，但是这种状态从来没有延续到我写论文、学一些编程语言这种功利性很强的项目中。</p><p>我所说的功利性，也只不过是为了我未来的至少五年能少一点煎熬，属于是一些预判避险罢了。人不能事事顺心，也不能一直都处在舒适圈。或者二者叠加，总会迎来一些命运强加于自己的挑战。平时如果没有预见的能力也就算了，这个时候再不预见并未雨绸缪就属于是自寻死路了。</p><p>然后就是对自己的道德谴责。我知道，我早晚有一天会每天工作 13 小时以上的，或者说，我不得不。如果不这样，我就不能毕业。我也知道，我必须精进自己 coding，scientific writing 的能力，这也都是为了我能毕业。我必须成为一个会利用时间的、掌握这些必需技能的人，我掌握得越多，像开头所描述的那种窘境就越少。而我现在甚至还没有踏上正轨。计划、执行和专注是我现在所需要的，然而我几乎都没有，真是让人焦虑。</p><p>不过好在我现在多了一些观察自己的能力，也学会了一些反省自己的手段，进步的速度也是在一个合适的范围内。我不会追求一朝一夕的反转，我只希望我能每天都成熟一点点、沉稳一点点，最好每天都能聪明一点点，嘿嘿。</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随想 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 笔记：正则表达式</title>
      <link href="/posts/38705/"/>
      <url>/posts/38705/</url>
      
        <content type="html"><![CDATA[<p>正则表达式（regular expression，regex，RE）可以用来匹配、检索、分割和替换具有某种特征的字符串，如邮箱、IP 地址、电话号码等，使用方便，效率很高。</p><p>特点</p><ol><li>正则表达式能够凝练字符串的特征</li><li>是通用的字符串表达框架</li><li>是简洁表达一组字符串的表达式</li><li>可以判断某个字符串的特征归属，是否具有这个特征</li></ol><p>作用</p><ol><li><p>表达文本类型的特征</p></li><li><p>同时查找或替换一组字符串</p></li><li><p>匹配字符串的全部或部分</p></li></ol><p>正则表达式由字符和操作符构成，基本和常用的正则表达式操作符如下：</p><table><thead><tr><th>操作符</th><th>说明</th><th>例子</th></tr></thead><tbody><tr><td><code>.</code></td><td>表示任何单个字符</td><td></td></tr><tr><td><code>[]</code></td><td>给出单个字符的取值范围</td><td><code>[abc]</code>：a 或 b 或 c，<code>[a-z]</code>：a-z 单个字母</td></tr><tr><td><code>[^]</code></td><td>排除此取值范围</td><td><code>[^abc]</code>：非 a 或 b 或 c</td></tr><tr><td><code>*</code></td><td>前一个字符出现 <code>&gt;=0</code> 次</td><td><code>abc*</code>：ab、abc、abcc、abccc 等</td></tr><tr><td><code>+</code></td><td>前一个字符出现 <code>&gt;=1</code> 次</td><td><code>abc+</code>：abc、abcc、abccc 等</td></tr><tr><td><code>?</code></td><td>前一个字符出现 <code>0</code> 或 <code>1</code> 次</td><td><code>abc?</code>：ab、abc</td></tr><tr><td><code>|</code></td><td>左右表达式中的一个</td><td><code>abc|def</code>：abc、def</td></tr><tr><td><code>&#123;m&#125;</code></td><td>前一个字符出现 <code>m</code> 次</td><td><code>ab&#123;2&#125;c</code>：abbc</td></tr><tr><td><code>&#123;n,&#125;</code></td><td>前一个字符出现 <code>&gt;=n</code> 次</td><td><code>ab&#123;2,&#125;c</code>：abbc、abbbc、abbbbc 等</td></tr><tr><td><code>&#123;m,n&#125;</code></td><td>前一个字符出现 <code>m-n</code> 次（含 <code>n</code>）</td><td><code>ab&#123;1,3&#125;c</code>：abc、abbc、abbbc</td></tr><tr><td><code>^</code></td><td>匹配字符串的开头</td><td><code>^123</code>：字符串以 123 开头</td></tr><tr><td><code>$</code></td><td>匹配字符串的结尾</td><td><code>123$</code>：字符串以 123 结尾</td></tr><tr><td><code>()</code></td><td>分组标记，内部只能使用 <code>|</code></td><td><code>(abc)</code>：abc，<code>(abc|def)</code>：abc、def</td></tr><tr><td><code>\d</code></td><td>数字，等价于 <code>[0-9]</code></td><td></td></tr><tr><td><code>\w</code></td><td>单词字符，等价于 <code>[A-Za-z0-9_]</code></td><td></td></tr><tr><td><code>\D</code></td><td>数字除外</td><td></td></tr><tr><td><code>\W</code></td><td>数字字母下划线除外</td><td></td></tr><tr><td><code>\s</code></td><td>任何空白字符，空格、制表符、换页符等。</td><td>等价于 <code>[\f\n\r\t\v]</code></td></tr><tr><td><code>\S</code></td><td>任何非空白字符</td><td>等价于 <code>[^\f\n\r\t\v]</code></td></tr><tr><td><code>\</code></td><td>转义字符</td><td><code>\.</code>：普通的 .</td></tr><tr><td><code>*?</code></td><td>惰性匹配上一个</td><td><code>'AbcE123'</code>, <code>'[0-9]*?'</code>：<code>''</code></td></tr><tr><td><code>+?</code></td><td>惰性匹配上一个</td><td><code>'AbcE123'</code>, <code>'[0-9]+?'</code>：<code>'1'</code></td></tr></tbody></table><p>经典实例</p><p><code>^[A-Za-z]+$</code>：由字母组成的字符串</p><p><code>^[A-Za-z]+$</code>：由字母和数字组成的字符串</p><p><code>^-?[1-9]\d*$</code>：整数</p><p><code>^[1-9]\d*$</code>：正整数</p><p><code>[\u4e00-\u9fa5]</code>：匹配中文字符</p><h2 id="re-compile-函数"><code>re.compile()</code> 函数</h2><p><code>re.compile(pattern, flags=0)</code></p><p><code>flags</code>：可选，表示匹配模式</p><ul><li><code>re.I</code>：忽略大小写</li><li><code>re.L</code>：表示特殊字符集 <code>\w, \W, \b, \B, \s, \S</code> 依赖于当前环境</li><li><code>re.M</code>：多行模式</li><li><code>re.S</code>：使得 <code>.</code> 包括换行符在内的任意字符（<code>.</code> 默认不包括换行符）</li><li><code>re.U</code>：表示特殊字符集 <code>\w, \W, \b, \B, \d, \D, \s, \S</code> 依赖于 Unicode  字符属性数据库</li><li><code>re.X</code>：为了增加可读性，忽略空格和 # 后面的注释</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">string = <span class="string">&#x27;112AbCdEf122&#x27;</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">&#x27;[a-z]+&#x27;</span>, re.I)</span><br><span class="line">re.search(pattern, string)</span><br><span class="line">&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">3</span>, <span class="number">9</span>), match=<span class="string">&#x27;AbCdEf&#x27;</span>&gt;</span><br></pre></td></tr></table></figure><p><code>re.I</code> 和 <code>re.M</code> 使用较多。</p><h2 id="re-match-函数"><code>re.match()</code> 函数</h2><p><code>re.match(pattern, string, flags=0)</code></p><p>只匹配字符串的<strong>开始</strong>，如果字符串开始不符合正则表达式，则匹配失败，函数返回 <code>None</code>，匹配成功时返回 <code>match</code> 对象。</p><p><code>match</code> 对象常用方法：</p><ul><li><code>group()</code>：返回匹配的字符串</li><li><code>start()</code>：返回匹配字符串开始的位置</li><li><code>end()</code>：返回匹配字符串结束的位置</li><li><code>span ()</code>：返回开始和结束位置</li><li><code>groups()</code>：返回所有匹配的子串</li></ul><p>前 4 个方法默认参数值为 0，可以手动设置为 1、2 等，对应选择出子表达式的内容。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;abcFGc123&#x27;</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">&#x27;[a-z]+&#x27;</span>, re.I)</span><br><span class="line">match = re.match(pattern, string)</span><br><span class="line">match.group()</span><br><span class="line"><span class="string">&#x27;abcFGc&#x27;</span></span><br><span class="line">match.start()</span><br><span class="line"><span class="number">0</span></span><br><span class="line">match.end()</span><br><span class="line"><span class="number">6</span></span><br><span class="line">match.span()</span><br><span class="line">(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;11abcFGc123&#x27;</span></span><br><span class="line">match = re.match(pattern, string)</span><br><span class="line"><span class="built_in">type</span>(match)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;NoneType&#x27;</span>&gt; 只匹配字符串开始</span><br></pre></td></tr></table></figure><h2 id="re-search-函数"><code>re.search()</code> 函数</h2><p><code>re.search(pattern, string, flags=0)</code></p><p>与 <code>re.match()</code> 不同的是，<code>re.search()</code> 匹配<strong>整个字符串</strong>，直到找到一个匹配。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&#x27;11abcFGc123&#x27;</span></span><br><span class="line">match = re.search(pattern, string)</span><br><span class="line"><span class="built_in">type</span>(match)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;re.Match&#x27;</span>&gt;</span><br><span class="line">match.group()</span><br><span class="line"><span class="comment"># &#x27;abcFGc&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="re-findall-函数"><code>re.findall()</code> 函数</h2><p><code>re.findall(pattern, string, flags=0)</code></p><ul><li><code>string</code>: 待匹配的字符串</li><li><code>pos</code>：可选参数，指定字符串的起始位置，默认为 0</li><li><code>endpos</code>：可选参数，指定字符串的结束位置，默认为字符串的长度</li></ul><p>以列表形式返回所有匹配的字符串：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re.findall(<span class="string">r&#x27;[0-9]+&#x27;</span>, <span class="string">&#x27;2022年05月05日，阴&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;2022&#x27;</span>, <span class="string">&#x27;05&#x27;</span>, <span class="string">&#x27;05&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="re-finditer-函数"><code>re.finditer()</code> 函数</h2><p><code>re.finditer(pattern, string, flags=0)</code></p><p>返回含有所有 <code>match</code> 对象的可迭代对象：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">temp = <span class="string">&#x27;2022年05月05日，阴&#x27;</span></span><br><span class="line">it = re.finditer(<span class="string">r&#x27;\d+&#x27;</span>, temp)</span><br><span class="line"><span class="keyword">for</span> match <span class="keyword">in</span> it:</span><br><span class="line">    <span class="built_in">print</span>(match, <span class="built_in">type</span>(match), match.group())</span><br><span class="line">&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">4</span>), match=<span class="string">&#x27;2022&#x27;</span>&gt; &lt;<span class="keyword">class</span> <span class="string">&#x27;re.Match&#x27;</span>&gt; <span class="number">2022</span></span><br><span class="line">&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">5</span>, <span class="number">7</span>), match=<span class="string">&#x27;05&#x27;</span>&gt; &lt;<span class="keyword">class</span> <span class="string">&#x27;re.Match&#x27;</span>&gt; 05</span><br><span class="line">&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">8</span>, <span class="number">10</span>), match=<span class="string">&#x27;05&#x27;</span>&gt; &lt;<span class="keyword">class</span> <span class="string">&#x27;re.Match&#x27;</span>&gt; 05</span><br></pre></td></tr></table></figure><h2 id="re-sub-函数"><code>re.sub()</code> 函数</h2><p><code>re.sub(pattern, repl, string, count=0, flags=0)</code></p><ul><li><code>pattern</code>：正则中的模式字符串。</li><li><code>repl</code>：替换的字符串，也可为一个函数。</li><li><code>string</code>：要被查找替换的原始字符串。</li><li><code>count</code>：模式匹配后替换的最大次数，默认0 表示替换所有的匹配</li></ul><p>匹配字符串并替换：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re.sub(<span class="string">r&#x27;\d+&#x27;</span>, <span class="string">&#x27;某&#x27;</span>, <span class="string">&#x27;2022年05月05日，阴&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;某年某月某日，阴&#x27;</span></span><br></pre></td></tr></table></figure><p>练习</p><ol><li><p><code>&quot;2004-959-559 # 这是一个国外电话号码&quot;</code>（1）去掉#和它之后的内容，（2）只保留数字</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">re.sub(<span class="string">r&#x27;#+.+&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;2004-959-559 # 这是一个国外电话号码&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;2004-959-559 &#x27;</span></span><br><span class="line">re.sub(<span class="string">r&#x27;[^\d]+&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;2004-959-559 # 这是一个国外电话号码&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;2004959559&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>将 <code>&quot;aabccaaadaaaa&quot;</code> 中连续的 a 替换成 b，替换后结果为 <code>bbccbdb</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re.sub(<span class="string">r&#x27;a+&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;aabccaaadaaaa&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;bbccbdb&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p><code>&quot;A23G4HFD567&quot;</code>，将匹配的数字乘以 2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">   </span><br></pre></td></tr></table></figure></li></ol><h2 id="re-split-函数"><code>re.split()</code> 函数</h2><p><code>re.split(pattern, string, maxsplit=0, flags=0)</code></p><ul><li><code>pattern</code>：正则中的模式字符串</li><li><code>string</code>：要分割的字符串</li><li><code>maxsplit</code>：可选，分隔次数，<code>maxsplit=1</code> 分隔一次，默认为 0，不限制次数</li><li><code>flags</code>：可选，表示匹配模式</li></ul><p>匹配后分割字符串：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">re.split(<span class="string">r&#x27;\d+&#x27;</span>, <span class="string">&#x27;2022年05月05日，阴&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;年&#x27;</span>, <span class="string">&#x27;月&#x27;</span>, <span class="string">&#x27;日，阴&#x27;</span>]</span><br><span class="line">re.split(<span class="string">r&#x27;\d+&#x27;</span>, <span class="string">&#x27;2022年05月05日，阴&#x27;</span>, maxsplit=<span class="number">1</span>)</span><br><span class="line">[<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;年05月05日，阴&#x27;</span>]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记：认真颓废的一天</title>
      <link href="/posts/63842/"/>
      <url>/posts/63842/</url>
      
        <content type="html"><![CDATA[<p>从来没有如此专注地颓废了。</p><p>核酸打破了我已设定好的日程，加上昨晚睡的并不好，早上没能去运动。背单词只背了 15 分钟，就下去吃早饭了。回来之后看 b 站，看 met gala，看女明星争奇斗艳，麻辣鸡太搞笑了，哈哈哈哈哈哈，Queen S 一如既往完美。让我惊艳的是 Alicia keys 那套把纽约夜景穿上身的 look。</p><img src="https://s2.loli.net/2022/06/14/YSVTkzBP6G5ZFdq.png" style="zoom:80%;" /><p>中午吃撑，回来睡 2 小时半梦半醒的午觉，起来根本没想着去上班，没啥好上的。找 @aohuiliu 去散步，很开心，在丁香树下接了吻，玩了双杠和跳绳，情人坡很适合野餐。</p><img src="https://s2.loli.net/2022/06/14/6HdAx8ZSb1O4LRV.png" style="zoom:80%;" /><p>早早吃了晚饭，回来写日记。<br>唉，一会儿写写论文吧。好烦啊，我恨 pms！</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typora 自用主题修改 CSS</title>
      <link href="/posts/34995/"/>
      <url>/posts/34995/</url>
      
        <content type="html"><![CDATA[<h2 id="主题">主题</h2><p>主题是 Github 上的 <a href="https://github.com/liangjingkanji/DrakeTyporaTheme">Drake</a>，默认就很好看，根据自己的需求做了一些修改。</p><img src="https://s2.loli.net/2022/08/06/U3RABbLj81lQxaW.png" style="zoom:80%;" /><h2 id="自定义修改-CSS">自定义修改 CSS</h2><p>在 Typora 的主题文件夹下新建一个 <code>base.user.css</code> 文件，Typora 每次启动都会加载这个文件。</p><p>修改内容如下：</p><ul><li>H1 左对齐</li><li>去除 H2 底部横线</li><li>代码块增加圆角和描边</li><li>文档宽度减小</li><li>公式大小缩小</li><li>段落改为两端对齐</li><li>行内代码增加背景</li><li>图片加上圆角</li><li>滚动条圆角和颜色修改</li></ul><p>CSS 源代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">h2</span> <span class="selector-class">.md-plain</span> &#123;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.md-fences</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--md-char-color);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#write</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">850px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.MathJax</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: justify;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">code</span>, tt &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--blockquote-bg-color);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">3px</span> <span class="number">2.5px</span> <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">::-webkit-scrollbar-thumb &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--md-char-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="自动编号">自动编号</h2><p>标题自动编号，代码来自 <a href="mailto:lpzmail@163.com">LPZ</a>。</p><img src="https://s2.loli.net/2022/06/14/1bYXNkLmCApsIZR.png" style="zoom:80%;" /><p>完整代码如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 添加自动序号样式 */</span></span><br><span class="line"><span class="selector-id">#write</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h2</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h3</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h4</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h5</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: h6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">h2</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: h2;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(h2) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">h3</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h3</span><span class="selector-class">.md-focus</span><span class="selector-class">.md-heading</span><span class="selector-pseudo">:before</span> &#123; <span class="comment">/** override the default style for focused headings */</span></span><br><span class="line">  <span class="attribute">counter-increment</span>: h3;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h3) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">h4</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h4</span><span class="selector-class">.md-focus</span><span class="selector-class">.md-heading</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: h4;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h4) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">h5</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h5</span><span class="selector-class">.md-focus</span><span class="selector-class">.md-heading</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: h5;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h5) <span class="string">&quot;  &quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#write</span> <span class="selector-tag">h6</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h6</span><span class="selector-class">.md-focus</span><span class="selector-class">.md-heading</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: h6;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h5) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(h6) <span class="string">&quot;  &quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** override the default style for focused headings */</span></span><br><span class="line"><span class="selector-id">#write</span>&gt;<span class="selector-tag">h3</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-id">#write</span>&gt;<span class="selector-tag">h4</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-id">#write</span>&gt;<span class="selector-tag">h5</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-id">#write</span>&gt;<span class="selector-tag">h6</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h3</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h4</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h5</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-tag">h6</span><span class="selector-class">.md-focus</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: inherit;</span><br><span class="line">  <span class="attribute">border</span>: inherit;</span><br><span class="line">  <span class="attribute">border-radius</span>: inherit;</span><br><span class="line">  <span class="attribute">position</span>: inherit;</span><br><span class="line">  <span class="attribute">left</span>: initial;</span><br><span class="line">  <span class="attribute">float</span>: none;</span><br><span class="line">  <span class="attribute">top</span>: initial;</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">  <span class="attribute">padding-left</span>: inherit;</span><br><span class="line">  <span class="attribute">padding-right</span>: inherit;</span><br><span class="line">  <span class="attribute">vertical-align</span>: inherit;</span><br><span class="line">  <span class="attribute">font-weight</span>: inherit;</span><br><span class="line">  <span class="attribute">line-height</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 自定义强制换号符，使得在导出PDF 或打印时强制换行 */</span></span><br><span class="line"><span class="keyword">@media</span> print &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 这是自定义标签, 在需要换行的地方插入：&lt;pb&gt; */</span></span><br><span class="line">  pb &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">page-break-after</span>: always;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span> &#123;</span><br><span class="line">    <span class="attribute">page-break-before</span>: always;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span><span class="selector-pseudo">:first</span>-of-type &#123;</span><br><span class="line">    <span class="attribute">page-break-before</span>: avoid;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 完成的 Task 添加删除线 */</span></span><br><span class="line"><span class="selector-class">.task-list-done</span> &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: line-through;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#777</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.task-list-not-done</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 添加键盘样式 */</span></span><br><span class="line"><span class="selector-tag">kbd</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> -<span class="number">2px</span> <span class="number">0</span> <span class="number">#c6cbd1</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* TOC 中隐藏 H1 和 H6 */</span></span><br><span class="line"><span class="selector-class">.md-toc-h1</span>, <span class="selector-class">.md-toc-h6</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 添加 TOC 自动序号样式 */</span></span><br><span class="line"><span class="selector-class">.md-toc-content</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-h1</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-h2</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-h3</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-h4</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-h5</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: toc-h6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-content</span> <span class="selector-class">.md-toc-h2</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: toc-h2;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(toc-h2) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-content</span> <span class="selector-class">.md-toc-h3</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: toc-h3;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(toc-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h3) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-content</span> <span class="selector-class">.md-toc-h4</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: toc-h4;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(toc-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h4) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-content</span> <span class="selector-class">.md-toc-h5</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: toc-h5;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(toc-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h5) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.md-toc-content</span> <span class="selector-class">.md-toc-h6</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: toc-h6;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(toc-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h5) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(toc-h6) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 侧边栏自动编号 */</span></span><br><span class="line"><span class="selector-class">.outline-content</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-h1</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-h2</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-h3</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-h4</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-h5</span> &#123;</span><br><span class="line">  <span class="attribute">counter-reset</span>: outline-h6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-content</span> <span class="selector-class">.outline-h2</span> <span class="selector-class">.outline-label</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: outline-h2;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(outline-h2) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-content</span> <span class="selector-class">.outline-h3</span> <span class="selector-class">.outline-label</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: outline-h3;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(outline-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h3) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-content</span> <span class="selector-class">.outline-h4</span> <span class="selector-class">.outline-label</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: outline-h4;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(outline-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h4) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-content</span> <span class="selector-class">.outline-h5</span> <span class="selector-class">.outline-label</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: outline-h5;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(outline-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h5) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outline-content</span> <span class="selector-class">.outline-h6</span> <span class="selector-class">.outline-label</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">counter-increment</span>: outline-h6;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(outline-h2) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h3) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h4) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h5) <span class="string">&quot;.&quot;</span><span class="built_in">counter</span>(outline-h6) <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客魔改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我真的想毕业</title>
      <link href="/posts/42986/"/>
      <url>/posts/42986/</url>
      
        <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s/oWh3NQJhlwsvBJBwQ3lFDw">Origin</a></p><h2 id="实验设计——“不战而屈人之兵”">实验设计——“不战而屈人之兵”</h2><ol><li>积累点子：读文献将“思想火花”记在本子上，多收集几个，以备后续和老师讨论排除。</li><li>排除：标准是这个点子做完实验后能否形成论文（无论成败与否），重点考察其创新性和所需时间（最好一年之内能做完）。可以选择和老师讨论，或者先用<strong>少量时间</strong>对几个点进行测试，然后选一个点。</li><li>实验设计：标准是一组数据能否形成一张图。</li></ol><h2 id="不要只研究参数对结果的影响">不要只研究参数对结果的影响</h2><p>科研是设定<strong>模型体系</strong>，用<strong>有限实验</strong>，说明现象和规律，探讨现象背后的原因。</p><h2 id="做实验——“活要见人，死要见尸”">做实验——“活要见人，死要见尸”</h2><ol><li>及时分析数据，处理数据，与老师讨论。<strong>实验要做对，确保数据重复性和可靠性</strong></li><li>对于“负面实验结果”：不要着急弃掉样品/数据，分析原因/合理解释也能发论文，如果不能，也可以为新的实验设计提供信息。</li><li>及时处理数据，才能及时补充实验</li></ol><h2 id="时间管理">时间管理</h2><ol><li>文献在实验过程中穿插读，不用读完 1000 篇才开始实验，在不同阶段阅读重点不同。</li><li>不要同时做几个课题</li><li>不要只测数据，而不整理论文，阶段性论文用来证明自己的进度。</li><li>合理安排：等数据时可以思考如何解释数据也思考后续实验的推进，也可以写论文或者做别的实验。</li></ol><h2 id="与导师">与导师</h2><ol><li>论文整体完成后，再交老师修改</li><li><strong>开学一定要先问清博士毕业要求</strong></li></ol>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随想 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R 笔记：主成分和因子分析</title>
      <link href="/posts/18522/"/>
      <url>/posts/18522/</url>
      
        <content type="html"><![CDATA[<p>若数据集变量过多，其中的交互关系可能很复杂。主成分分析和因子分析是两种用来探索和简化多变量复杂关系的常用方法，它们之间有联系也有区别。</p><img src="https://s2.loli.net/2022/06/14/EujDqxowgNRvyJY.png" alt="image-20220504155047610" style="zoom:50%;" /><p>主成分分析（Principal Component Analysis，PCA），是一种数据降维技巧，能够将大量的相关变量转化为一组很少的不相关变量，即主成分。例如，使用 PCA 将 30 个相关的环境变量（可能冗余）转化为 5 个无关的成分变量，并且尽可能地保留原始数据集的信息。</p><p>主成分是对原始变量重新进行线性组合，将原先众多的，具有一定相关性的指标，重新组合为一组新的，相互独立的综合指标。PCA 的目标是用一组较少的独立变量代替大量相关变量，同时尽可能保留初始变量的信息，这些推到所得的变量称主成分，它们是观测变量的线性组合。如第一主成分为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mi>k</mi></msub><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">PC_1=a_1X_1=a_2X_2+...+a_kX_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">PC_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个观测变量的加权组合，对初始变量集的方差解释性最大。同理第二组成份 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">PC_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 也是初始变量的线性组合，但对方差的解释性排第二，同时与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">PC_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <strong>不相关</strong>。变量线性组合的权重由最大化各主成分的方差解释度来确定。其余的主成分以此类推，每一个主成分都最大化它对方差的解释程度，同时与其他所有主成分都不相关。因此理论上，可以选择和初始变量数相同的主成分，但并不实用。</p><p>R 中自带 <code>princomp()</code> 和 <code>factanal()</code> 函数可以进行 PCA 和 EFA，但功能比较简单。一般使用 <code>psych</code> 包中的函数代替。</p><img src="https://s2.loli.net/2022/08/02/59ITZXM1kChsWfy.png" alt="image-20220504155902402" style="zoom:80%;" /><h2 id="主成分分析流程">主成分分析流程</h2><p>主成分分析和因子分析的流程类似：</p><ol><li>数据预处理：可以输入原始数据或相关系数矩阵，若输入初始数据，函数会自动计算相关系数矩阵</li><li>选择分析模型：判断是 PCA（数据降维）还是 EFA（潜在结构），若选择 EFA，还需要选择一种估计因子模型的方法</li><li>判断主成分/因子个数</li><li>选择主成分/因子</li><li>旋转主成分/因子</li><li>解释结果</li><li>计算主成分/因子得分</li></ol><h3 id="判断主成分个数">判断主成分个数</h3><p>如何判断 PCA 中需要多少个主成分？以下是一些准则：</p><ul><li>根据先验经验和理论知识判断个数</li><li>根据要解释变量方差的积累值的阈值来判断个数</li><li>通过检查变量间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k × k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 的相关系数矩阵来判断个数</li></ul><p>最常见的是基于特征值的方法。每个主成分都与相关系数矩阵的特征值相关联，第一主成分与最大的特征值相关联，第二主成分与第二大的特征值相关联，以此类推。Kaiser-harris 准则建议保留特征值大于 1 的主成分，特征值小于1的成分所解释的方差比包含在单个变量中的方差更少。Cattell 碎石检验则绘制了特征值与主成分数的图形。这类图形可以清晰地展示图形弯曲状况，在图形变化最大处之上的主成分都可保留。最后，还可以进行模拟，依据与初始矩阵相同大小的随机数据矩阵来判断要提取的特征值。若基于真实数据的某个特征值大于一组随机数据矩阵相应的平均特征值，那么该主成分可以保留。该方法称作平行分析。</p><p>利用 <code>fa.parallel()</code> 函数，可以同时对三种特征值判别准则进行评价，即 Kaiser-harris 准则、Cattell 碎石检验和平行分析。函数用法如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa.parallel<span class="punctuation">(</span>x<span class="punctuation">,</span> n.obs<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&quot;minres&quot;</span><span class="punctuation">,</span> fa<span class="operator">=</span><span class="string">&quot;both&quot;</span><span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> n.iter<span class="operator">=</span><span class="number">20</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="提取主成分">提取主成分</h3><p>使用 <code>principal()</code> 函数可以根据原始数据矩阵或相关系数矩阵做主成分分析。函数用法如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">principal<span class="punctuation">(</span>r<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="punctuation">,</span> scores<span class="operator">=</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>其中：</p><ul><li>r：相关系数矩阵或原始数据矩阵</li><li>nfactors：设定主成分数（默认为 1 ）</li><li>rotate：指定旋转的方法（默认 varimax 最大方差旋转）</li><li>scores：设定是否需要计算主成分得分（默认不需要）</li></ul><h3 id="主成分旋转">主成分旋转</h3><p>旋转是一系列将成分载荷阵变得更容易解释的数学方法，它们尽可能地对成分<strong>去噪</strong>。旋转方法有两种：</p><ol><li>正交旋转：使选择的成分保持不相关</li><li>斜交旋转：使选择的成分变得相关</li></ol><p>旋转方法也会依据去噪定义的不同而不同。最流行的正交旋转是方差极大旋转，它试图对载荷阵的列进行去噪，使得每个成分只是由一组<strong>有限</strong>的变量来解释（即载荷阵每列只有少数几个很大的载荷，其他都是很小的载荷）。</p><h3 id="获得主成分得分">获得主成分得分</h3><p>我们的最终目标是用一组较少的变量替换一组较多的相关变量，因此，还需要获取每个观测在成分上的得分。</p><h2 id="实例-2">实例</h2><h3 id="例-1：USJudgeRatings">例 1：<code>USJudgeRatings</code></h3><p><code>psych</code> 包中的 <code>USAJudgeRatings</code> 数据集包含了律师对美国高等法院法官的评分，包含 43 个观测，12 个变量。就可以使用 PCA 对这 12 个变量进行分析，提取出主成分。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;psych&#x27;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span> n<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#                CONT INTG DMNR DILG CFMG DECI PREP FAMI ORAL WRIT PHYS RTEN</span></span><br><span class="line"><span class="comment"># AARONSON,L.H.   5.7  7.9  7.7  7.3  7.1  7.4  7.1  7.1  7.1  7.0  8.3  7.8</span></span><br><span class="line"><span class="comment"># ALEXANDER,J.M.  6.8  8.9  8.8  8.5  7.8  8.1  8.0  8.0  7.8  7.9  8.5  8.7</span></span><br><span class="line"><span class="comment"># ARMENTANO,A.J.  7.2  8.1  7.8  7.8  7.5  7.6  7.5  7.5  7.3  7.4  7.9  7.8</span></span><br></pre></td></tr></table></figure><p><strong>确定主成分个数</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fa.parallel<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span> fa<span class="operator">=</span><span class="string">&#x27;pc&#x27;</span><span class="punctuation">,</span> n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">principal<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">,</span> scores <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>结果如下</p><img src="https://s2.loli.net/2022/08/02/dWAvg4FoHqKO6iy.png" alt="平行分析结果" style="zoom:80%;" /><p>线段为基于观测特征值的碎石检验，虚线为根据 100 个随机数矩阵推导出来的特征值均值。三者均表明，只需保留一个主成分即可。</p><p><strong>提取主成分</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">pc</span><br><span class="line"><span class="comment"># Principal Components Analysis</span></span><br><span class="line"><span class="comment"># Call: principal(r = USJudgeRatings, nfactors = 1)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#        PC1      h2     u2 com</span></span><br><span class="line"><span class="comment"># CONT -0.01 9.6e-05 0.9999   1</span></span><br><span class="line"><span class="comment"># INTG  0.92 8.4e-01 0.1563   1</span></span><br><span class="line"><span class="comment"># DMNR  0.91 8.3e-01 0.1660   1</span></span><br><span class="line"><span class="comment"># DILG  0.97 9.4e-01 0.0613   1</span></span><br><span class="line"><span class="comment"># CFMG  0.96 9.3e-01 0.0723   1</span></span><br><span class="line"><span class="comment"># DECI  0.96 9.2e-01 0.0764   1</span></span><br><span class="line"><span class="comment"># PREP  0.98 9.7e-01 0.0299   1</span></span><br><span class="line"><span class="comment"># FAMI  0.98 9.5e-01 0.0469   1</span></span><br><span class="line"><span class="comment"># ORAL  1.00 9.9e-01 0.0091   1</span></span><br><span class="line"><span class="comment"># WRIT  0.99 9.8e-01 0.0195   1</span></span><br><span class="line"><span class="comment"># PHYS  0.89 8.0e-01 0.2014   1</span></span><br><span class="line"><span class="comment"># RTEN  0.99 9.7e-01 0.0275   1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                  PC1</span></span><br><span class="line"><span class="comment"># SS loadings    10.13</span></span><br><span class="line"><span class="comment"># Proportion Var  0.84</span></span><br></pre></td></tr></table></figure><p>此处，获取一个未旋转的主成分。由于PCA只对<strong>相关系数矩阵</strong>进行分析，在获取主成分前，原始数据将会被自动转换为相关系数矩阵。</p><p>PC1 栏包含了成分载荷，指观测变量与主成分的相关系数。如果提取不止一个主成分，那么还将会有 PC2、PC3 等栏。成分载荷（component loadings）可用来解释主成分的含义。第一主成分（PC1）与每个变量都高度相关（除了第一个），也就是说，它是一个可用来进行一般性评价的维度。</p><p>h2 栏指成分公因子方差——主成分对每个变量的方差解释度。u2 栏指成分唯一性——方差无法被主成分解释的比例（即 1-h2）。例如，体能（PHYS）80% 的方差都可用第一主成分来解释，20% 不能。第一主成分对 ORAL 变量的解释性最好，对 CONT 变量的解释性则最差。</p><p>SS loadings 行包含了与主成分相关联的特征值，指的是与特定主成分相关联的标准化后的方差值（本例中，第一主成分的值为 10）。最后，Proportion Var 行表示的是每个主成分对整个数据集的解释程度。此处可以看到，第一主成分解释了 12 个变量 84% 的方差。</p><p><strong>获得主成分得分</strong></p><p>只需加上参数 <code>score=T</code> 即可获得评分。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>USJudgeRatings<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> scores <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>pc<span class="operator">$</span>scores<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#                        PC1</span></span><br><span class="line"><span class="comment"># AARONSON,L.H.  -0.18400648</span></span><br><span class="line"><span class="comment"># ALEXANDER,J.M.  0.74765156</span></span><br><span class="line"><span class="comment"># ARMENTANO,A.J.  0.07072468</span></span><br><span class="line"><span class="comment"># BERDON,R.I.     1.13651889</span></span><br><span class="line"><span class="comment"># BRACKEN,J.J.   -2.15848207</span></span><br><span class="line"><span class="comment"># BURNS,E.B.      0.76821742</span></span><br></pre></td></tr></table></figure><h3 id="例-2：Harman23-cor">例 2：<code>Harman23.cor</code></h3><p>该数据集包含 305 个女孩的 8 个身体测量指标的<strong>相关系数</strong>，利用 <code>pheatmap()</code> 函数可视化如下：</p><img src="https://s2.loli.net/2022/08/02/cyi3zSdwZEljhgm.png" alt="harman23.cor 数据可视化" style="zoom: 67%;" /><p>同样，希望用较少的变量替换这些原始身体指标。</p><p><strong>确定主成分个数</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fa.parallel<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span> n.obs <span class="operator">=</span> <span class="number">302</span><span class="punctuation">,</span> fa<span class="operator">=</span><span class="string">&#x27;pc&#x27;</span><span class="punctuation">,</span> n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Parallel analysis suggests that the number of factors =  NA  and the number of components =  2 </span></span><br><span class="line">abline<span class="punctuation">(</span>h<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2022/08/02/yDGnIPmN4rhHgQc.png" alt="例2" style="zoom:80%;" /><p>三种准则均显示保留两个主成分，但要注意三个准则并不总是相同，需要根据实际情况提取不同数目的主成分，选择最优解。</p><p><strong>提取主成分</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line">pc</span><br><span class="line"><span class="comment"># Principal Components Analysis</span></span><br><span class="line"><span class="comment"># Call: principal(r = Harman23.cor$cov, nfactors = 2, rotate = &quot;none&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#                 PC1   PC2   h2    u2 com</span></span><br><span class="line"><span class="comment"># height         0.86 -0.37 0.88 0.123 1.4</span></span><br><span class="line"><span class="comment"># arm.span       0.84 -0.44 0.90 0.097 1.5</span></span><br><span class="line"><span class="comment"># forearm        0.81 -0.46 0.87 0.128 1.6</span></span><br><span class="line"><span class="comment"># lower.leg      0.84 -0.40 0.86 0.139 1.4</span></span><br><span class="line"><span class="comment"># weight         0.76  0.52 0.85 0.150 1.8</span></span><br><span class="line"><span class="comment"># bitro.diameter 0.67  0.53 0.74 0.261 1.9</span></span><br><span class="line"><span class="comment"># chest.girth    0.62  0.58 0.72 0.283 2.0</span></span><br><span class="line"><span class="comment"># chest.width    0.67  0.42 0.62 0.375 1.7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        PC1  PC2</span></span><br><span class="line"><span class="comment"># SS loadings           4.67 1.77</span></span><br><span class="line"><span class="comment"># Proportion Var        0.58 0.22</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.58 0.81</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.73 0.27</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.73 1.00</span></span><br></pre></td></tr></table></figure><p>可见，第一主成分解释了身体测量指标 58% 的方差，第二主成分解释了 22% 的方差，二者一共解释了 81% 的方差。对于 height 变量，二者一共解释了 88% 的方差。</p><p>成分载荷显示，PC1 与所有变量都正相关，PC2 与前 4 个变量负相关，与其他变量正相关。当提取多个成分时，对其进行旋转可时结果更有解释性。</p><p><strong>主成分旋转</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">rc <span class="operator">&lt;-</span> principal<span class="punctuation">(</span>Harman23.cor<span class="operator">$</span>cov<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;varimax&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rc</span><br><span class="line"><span class="comment"># Principal Components Analysis</span></span><br><span class="line"><span class="comment"># Call: principal(r = Harman23.cor$cov, nfactors = 2, rotate = &quot;varimax&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#                 RC1  RC2   h2    u2 com</span></span><br><span class="line"><span class="comment"># height         0.90 0.25 0.88 0.123 1.2</span></span><br><span class="line"><span class="comment"># arm.span       0.93 0.19 0.90 0.097 1.1</span></span><br><span class="line"><span class="comment"># forearm        0.92 0.16 0.87 0.128 1.1</span></span><br><span class="line"><span class="comment"># lower.leg      0.90 0.22 0.86 0.139 1.1</span></span><br><span class="line"><span class="comment"># weight         0.26 0.88 0.85 0.150 1.2</span></span><br><span class="line"><span class="comment"># bitro.diameter 0.19 0.84 0.74 0.261 1.1</span></span><br><span class="line"><span class="comment"># chest.girth    0.11 0.84 0.72 0.283 1.0</span></span><br><span class="line"><span class="comment"># chest.width    0.26 0.75 0.62 0.375 1.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        RC1  RC2</span></span><br><span class="line"><span class="comment"># SS loadings           3.52 2.92</span></span><br><span class="line"><span class="comment"># Proportion Var        0.44 0.37</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.44 0.81</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.55 0.45</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.55 1.00</span></span><br></pre></td></tr></table></figure><p>旋转后变为 RC，RC1 主要由前四个变量来解释，主要与高度相关；RC2 主要由后四个变量来解释，主要与容量相关。两个主成分<strong>仍不相关</strong>，对变量的解释性不变，这是因为变量的群组没有发生变化。另外，两个主成分旋转后的累积方差解释性没有变化（81%），变的只是各个主成分对方差的解释度（成分 1 从 58% 变为 44%，成分 2 从 22% 变为 37%）。各成分的方差解释度趋同，准确来说，此时应该称它们为<strong>成分</strong>而不是主成分（因为单个主成分<strong>方差最大化性质</strong>没有保留）。</p><p><strong>获得主成分得分系数</strong></p><p>当主成分分析基于相关系数矩阵时，不能获取每个观测的主成分得分，只能得到得分系数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">round</span><span class="punctuation">(</span><span class="built_in">unclass</span><span class="punctuation">(</span>rc<span class="operator">$</span>weights<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#                  RC1   RC2</span></span><br><span class="line"><span class="comment"># height          0.28 -0.05</span></span><br><span class="line"><span class="comment"># arm.span        0.30 -0.08</span></span><br><span class="line"><span class="comment"># forearm         0.30 -0.09</span></span><br><span class="line"><span class="comment"># lower.leg       0.28 -0.06</span></span><br><span class="line"><span class="comment"># weight         -0.06  0.33</span></span><br><span class="line"><span class="comment"># bitro.diameter -0.08  0.32</span></span><br><span class="line"><span class="comment"># chest.girth    -0.10  0.34</span></span><br><span class="line"><span class="comment"># chest.width    -0.04  0.27</span></span><br></pre></td></tr></table></figure><p>主成分得分可以由下式计算：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><mo>∑</mo><mi>v</mi><mi>a</mi><mi>r</mi><mo>×</mo><mi>R</mi><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">PC_i = \sum var×RC_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">var</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> 是 height、arm.span 等变量</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">RC_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是对应变量的值</li></ul><p>上式都假定身体测量指标都已标准化（mean = 0， sd = 1）。注意，体重在 PC1 上的系数约为 0.3 或 0，对于 PC2 也是一样。从实际角度考虑，你可以进一步简化方法，将第一主成分看做是前四个变量标准化得分的均值，类似地，将第二主成分看做是后四个变量标准化得分的均值，这正是我通常在实际中采用的方法。</p><p>探索性因子分析（exploration factor analysis，EFA）的是一系列用来发现一组变量潜在结构的方法。目标是通过寻找一组更小的、潜在的活隐藏的结构来解释已知的观测变量。如高中的几门学科，用因子分析就是：语言能力（语、外）、逻辑推理（数、理、化、生）、逻辑分析（史、地、政）。重点在于如何解释观测变量，探索观测变量的结构和原因。模型形式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>F</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msub><mi>F</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mi>p</mi></msub><msub><mi>F</mi><mi>p</mi></msub><mo>+</mo><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i=a_1F_1+a_2F_2+...+a_pF_p+U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个可观测变量（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1...</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1...k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">1...</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>）；</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">F_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>：公共因子（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1...</mn><mi>p</mi></mrow><annotation encoding="application/x-tex">j=1...p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1...</span><span class="mord mathnormal">p</span></span></span></span>），且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">p&lt;k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>；</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 变量独有的部分（无法被公共因子解释）；</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：可以认为是每个因子对复合而成的可观测变量的贡献度。</li></ul><p>如 <code>Harman74.cor</code> 数据集包含 24 个心理测验间的相关系数，若用 EFA 分析，就是要找到能够解释这些变量的潜在因子。</p><h2 id="二者的异同">二者的异同</h2><p>相同点：</p><ul><li>都对原始数据进行降维处理</li><li>都消除了原始指标的相关性对综合评价所造成的信息重复的影响</li><li>构造综合评价时涉及的权数具有客观性</li><li>在信息损失不大的前提下，减少了评价的工作量</li></ul><p>不同点：</p><table><thead><tr><th style="text-align:left">PCA</th><th>EFA</th></tr></thead><tbody><tr><td style="text-align:left">用较少变量表示原来的样本</td><td>用较少的因子表示原来的变量</td></tr><tr><td style="text-align:left">目的：样本数据损失最小时，对原数据进行变量降维</td><td>目的：尽可能保持原变量相互关系，寻找变量的公共因子</td></tr><tr><td style="text-align:left">参数估计，一般是求相关矩阵的特征值和相应的特征向量，取前几个计算主成分</td><td>参数估计，指定几个公共因子，将其还原成相关数据矩阵，在和原样本相关矩阵最相似度原则下，估计各个公共因子的估计值</td></tr><tr><td style="text-align:left">举例：语、数、英、文科、理科（变量降维）</td><td>举例：语言能力（语、外）、逻辑推理（数、理、化、生）、逻辑分析（史、地、政）（公共因子）</td></tr></tbody></table><h2 id="实例-3">实例</h2><h3 id="例-1：ability-cov">例 1：<code>ability.cov</code></h3><p>该数据集为 112 个参与者在 6 个测验（智力、画图、积木、迷津、阅读、词汇）得分的协方差矩阵。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ability.cov</span><br><span class="line"><span class="comment"># $cov</span></span><br><span class="line"><span class="comment">#         general picture  blocks   maze reading   vocab</span></span><br><span class="line"><span class="comment"># general  24.641   5.991  33.520  6.023  20.755  29.701</span></span><br><span class="line"><span class="comment"># picture   5.991   6.700  18.137  1.782   4.936   7.204</span></span><br><span class="line"><span class="comment"># blocks   33.520  18.137 149.831 19.424  31.430  50.753</span></span><br><span class="line"><span class="comment"># maze      6.023   1.782  19.424 12.711   4.757   9.075</span></span><br><span class="line"><span class="comment"># reading  20.755   4.936  31.430  4.757  52.604  66.762</span></span><br><span class="line"><span class="comment"># vocab    29.701   7.204  50.753  9.075  66.762 135.292</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $center</span></span><br><span class="line"><span class="comment"># [1] 0 0 0 0 0 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $n.obs</span></span><br><span class="line"><span class="comment"># [1] 112</span></span><br></pre></td></tr></table></figure><p><strong>将协方差矩阵转换为相关系数矩阵</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">options<span class="punctuation">(</span>digits <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">covr <span class="operator">&lt;-</span> ability.cov<span class="operator">$</span>cov</span><br><span class="line">corr <span class="operator">&lt;-</span> cov2cor<span class="punctuation">(</span>covr<span class="punctuation">)</span></span><br><span class="line">corr</span><br><span class="line"><span class="comment">#         general picture blocks maze reading vocab</span></span><br><span class="line"><span class="comment"># general    1.00    0.47   0.55 0.34    0.58  0.51</span></span><br><span class="line"><span class="comment"># picture    0.47    1.00   0.57 0.19    0.26  0.24</span></span><br><span class="line"><span class="comment"># blocks     0.55    0.57   1.00 0.45    0.35  0.36</span></span><br><span class="line"><span class="comment"># maze       0.34    0.19   0.45 1.00    0.18  0.22</span></span><br><span class="line"><span class="comment"># reading    0.58    0.26   0.35 0.18    1.00  0.79</span></span><br><span class="line"><span class="comment"># vocab      0.51    0.24   0.36 0.22    0.79  1.00</span></span><br></pre></td></tr></table></figure><p><strong>确定公共因子个数</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 选择 both，以示 PCA 和 EFA 差别</span><br><span class="line">fa.parallel(corr, fa=&#x27;both&#x27;, n.obs = 112, n.iter = 100)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/08/02/NwfR3KzpDGFHkQE.png" alt="平行分析结果"></p><p>× 是 PCA，显示保留 1 个（碎石检验和平行分析）或 2 个（特征值大于 1）主成分。这时候，通常高估因子比低估因子结果要好，因为高估因子数一般较少曲解“真实”情况。</p><p>△ 是 EFA，显示保留 2 个因子，前两个特征值都在拐角之上，且大于 100 次随机数矩阵的特征值均值。对于 EFA，Kaiser-Harris 准则的<mark class="hl-label red">特征值大于 0</mark> ，而不是 1，因此也符合。</p><p><strong>提取公共因子</strong></p><p>可以用 <code>fa()</code> 函数处理：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="punctuation">,</span> nfactors<span class="operator">=</span><span class="punctuation">,</span> n.obs <span class="operator">=</span><span class="punctuation">,</span> rotate<span class="operator">=</span><span class="punctuation">,</span> scores<span class="operator">=</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>其中：</p><ul><li>r：相关系数矩阵或者原始数据矩阵</li><li>nfactors：设定提取的因子数（默认为1）</li><li>n.obs：是观测数（输入相关系数矩阵时需要填写）</li><li>rotate：设定旋转的方法（默认互变异数最小法）</li><li>scores：设定是否计算因子得分（默认不计算）</li><li>fm：设定因子化方法（默认极小残差法）</li></ul><p>提取公共因子的方法有很多，包括最大似然法（ml）、主轴迭代法（pa）、加权最小二乘法（wls）、广义加权最小二乘法（gls）和最小残差法（minres）。统计学家青睐使用最大似然法，因为它有良好的统计性质。不过有时候最大似然法不会收敛，此时使用主轴迭代法效果会很好。</p><p>主轴迭代法示例（不旋转）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;pa&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Factor Analysis using method =  pa</span></span><br><span class="line"><span class="comment"># Call: fa(r = corr, nfactors = 2, rotate = &quot;none&quot;, fm = &quot;pa&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#          PA1   PA2   h2    u2 com</span></span><br><span class="line"><span class="comment"># general 0.75  0.07 0.57 0.432 1.0</span></span><br><span class="line"><span class="comment"># picture 0.52  0.32 0.38 0.623 1.7</span></span><br><span class="line"><span class="comment"># blocks  0.75  0.52 0.83 0.166 1.8</span></span><br><span class="line"><span class="comment"># maze    0.39  0.22 0.20 0.798 1.6</span></span><br><span class="line"><span class="comment"># reading 0.81 -0.51 0.91 0.089 1.7</span></span><br><span class="line"><span class="comment"># vocab   0.73 -0.39 0.69 0.313 1.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        PA1  PA2</span></span><br><span class="line"><span class="comment"># SS loadings           2.75 0.83</span></span><br><span class="line"><span class="comment"># Proportion Var        0.46 0.14</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.46 0.60</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.77 0.23</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.77 1.00</span></span><br></pre></td></tr></table></figure><p>可见，两个因子解释了 6 个心理学测验 60% 的方差，但因子载荷的意义不太好解释，需要对因子进行旋转。</p><p>最大似然法示例（不旋转）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;ml&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Factor Analysis using method =  ml</span></span><br><span class="line"><span class="comment"># Call: fa(r = corr, nfactors = 2, rotate = &quot;none&quot;, fm = &quot;ml&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#          ML1   ML2   h2    u2 com</span></span><br><span class="line"><span class="comment"># general 0.65  0.35 0.54 0.455 1.5</span></span><br><span class="line"><span class="comment"># picture 0.35  0.54 0.41 0.589 1.7</span></span><br><span class="line"><span class="comment"># blocks  0.47  0.75 0.78 0.218 1.7</span></span><br><span class="line"><span class="comment"># maze    0.25  0.41 0.23 0.769 1.7</span></span><br><span class="line"><span class="comment"># reading 0.96 -0.13 0.95 0.052 1.0</span></span><br><span class="line"><span class="comment"># vocab   0.82 -0.04 0.67 0.334 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        ML1  ML2</span></span><br><span class="line"><span class="comment"># SS loadings           2.42 1.16</span></span><br><span class="line"><span class="comment"># Proportion Var        0.40 0.19</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.40 0.60</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.68 0.32</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.68 1.00</span></span><br></pre></td></tr></table></figure><p>与上类似。</p><p><strong>因子旋转</strong></p><p>主轴迭代法 + 正交旋转</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;varimax&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;pa&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Factor Analysis using method =  pa</span></span><br><span class="line"><span class="comment"># Call: fa(r = corr, nfactors = 2, rotate = &quot;varimax&quot;, fm = &quot;pa&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#          PA1  PA2   h2    u2 com</span></span><br><span class="line"><span class="comment"># general 0.49 0.57 0.57 0.432 2.0</span></span><br><span class="line"><span class="comment"># picture 0.16 0.59 0.38 0.623 1.1</span></span><br><span class="line"><span class="comment"># blocks  0.18 0.89 0.83 0.166 1.1</span></span><br><span class="line"><span class="comment"># maze    0.13 0.43 0.20 0.798 1.2</span></span><br><span class="line"><span class="comment"># reading 0.93 0.20 0.91 0.089 1.1</span></span><br><span class="line"><span class="comment"># vocab   0.80 0.23 0.69 0.313 1.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        PA1  PA2</span></span><br><span class="line"><span class="comment"># SS loadings           1.83 1.75</span></span><br><span class="line"><span class="comment"># Proportion Var        0.30 0.29</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.30 0.60</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.51 0.49</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.51 1.00</span></span><br></pre></td></tr></table></figure><p>此时因子更好解释，reading 和 vocab 在 PA1 的载荷较大，picture、blocks 和 maze 在 PA2 上载荷较大，而 general 智力测试在两个因子上的载荷较为平均。说明，存在一个语言的智力因子和非语言的智力因子。</p><p>最大似然法 + 正交旋转</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;varimax&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;ml&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Factor Analysis using method =  ml</span></span><br><span class="line"><span class="comment"># Call: fa(r = corr, nfactors = 2, rotate = &quot;varimax&quot;, fm = &quot;ml&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#          ML1  ML2   h2    u2 com</span></span><br><span class="line"><span class="comment"># general 0.50 0.54 0.54 0.455 2.0</span></span><br><span class="line"><span class="comment"># picture 0.16 0.62 0.41 0.589 1.1</span></span><br><span class="line"><span class="comment"># blocks  0.21 0.86 0.78 0.218 1.1</span></span><br><span class="line"><span class="comment"># maze    0.11 0.47 0.23 0.769 1.1</span></span><br><span class="line"><span class="comment"># reading 0.96 0.18 0.95 0.052 1.1</span></span><br><span class="line"><span class="comment"># vocab   0.78 0.22 0.67 0.334 1.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        ML1  ML2</span></span><br><span class="line"><span class="comment"># SS loadings           1.86 1.72</span></span><br><span class="line"><span class="comment"># Proportion Var        0.31 0.29</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.31 0.60</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.52 0.48</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.52 1.00</span></span><br></pre></td></tr></table></figure><p>结果类似。</p><p>使用正交旋转将使两个因子不相关。如果允许两个因子相关呢？</p><p>主轴迭代法 + 斜交旋转</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 斜交旋转需要 GPArotation 包</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;GPArotation&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;promax&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;pa&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Loading required namespace: GPArotation</span></span><br><span class="line"><span class="comment"># Factor Analysis using method =  pa</span></span><br><span class="line"><span class="comment"># Call: fa(r = corr, nfactors = 2, rotate = &quot;promax&quot;, fm = &quot;pa&quot;)</span></span><br><span class="line"><span class="comment"># Standardized loadings (pattern matrix) based upon correlation matrix</span></span><br><span class="line"><span class="comment">#           PA1   PA2   h2    u2 com</span></span><br><span class="line"><span class="comment"># general  0.37  0.48 0.57 0.432 1.9</span></span><br><span class="line"><span class="comment"># picture -0.03  0.63 0.38 0.623 1.0</span></span><br><span class="line"><span class="comment"># blocks  -0.10  0.97 0.83 0.166 1.0</span></span><br><span class="line"><span class="comment"># maze     0.00  0.45 0.20 0.798 1.0</span></span><br><span class="line"><span class="comment"># reading  1.00 -0.09 0.91 0.089 1.0</span></span><br><span class="line"><span class="comment"># vocab    0.84 -0.01 0.69 0.313 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                        PA1  PA2</span></span><br><span class="line"><span class="comment"># SS loadings           1.83 1.75</span></span><br><span class="line"><span class="comment"># Proportion Var        0.30 0.29</span></span><br><span class="line"><span class="comment"># Cumulative Var        0.30 0.60</span></span><br><span class="line"><span class="comment"># Proportion Explained  0.51 0.49</span></span><br><span class="line"><span class="comment"># Cumulative Proportion 0.51 1.00</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  With factor correlations of </span></span><br><span class="line"><span class="comment">#      PA1  PA2</span></span><br><span class="line"><span class="comment"># PA1 1.00 0.55</span></span><br><span class="line"><span class="comment"># PA2 0.55 1.00</span></span><br></pre></td></tr></table></figure><p>正交旋转侧重于<strong>因子结构矩阵</strong>（变量与因子的相关系数），而斜交旋转会考虑三个矩阵：<strong>因子结构矩阵</strong>、<strong>因子模式矩阵</strong>和<strong>因子关联矩阵</strong>。</p><p>因子模式矩阵即标准化的回归系数矩阵。它列出了因子预测变量的权重。因子关联矩阵即因子相关系数矩阵。PA1 和 PA2 栏即<mark class="hl-label red">因子模式矩阵</mark> （不是正交旋转中的因子结构矩阵），它们是标准化的回归系数，而不是相关系数。同样可以得到一个语言因子和一个非语言因子。</p><p>最下方的因子关联矩阵显示两个因子的相关系数为 0.55，相关性很大。如果因子间的关联性很低，可能需要重新使用正交旋转来简化问题。</p><p>因子结构矩阵（或称因子载荷阵）没有被列出来，可以使用公式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>P</mi><mo>∗</mo><mi>P</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">F = P*Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">hi</span></span></span></span> 计算，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 是因子载荷阵，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 为因子模式矩阵，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">hi</span></span></span></span> 为因子关联矩阵。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">fa.promax <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>r<span class="operator">=</span>corr<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;promax&#x27;</span><span class="punctuation">,</span> fm<span class="operator">=</span><span class="string">&#x27;pa&#x27;</span><span class="punctuation">)</span></span><br><span class="line">fa.promax<span class="operator">$</span>loadings</span><br><span class="line"><span class="comment"># Loadings:</span></span><br><span class="line"><span class="comment">#         PA1    PA2   </span></span><br><span class="line"><span class="comment"># general  0.369  0.484</span></span><br><span class="line"><span class="comment"># picture         0.628</span></span><br><span class="line"><span class="comment"># blocks  -0.104  0.966</span></span><br><span class="line"><span class="comment"># maze            0.449</span></span><br><span class="line"><span class="comment"># reading  1.003       </span></span><br><span class="line"><span class="comment"># vocab    0.836       </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#                 PA1 PA2</span></span><br><span class="line"><span class="comment"># SS loadings    1.85 1.8</span></span><br><span class="line"><span class="comment"># Proportion Var 0.31 0.3</span></span><br><span class="line"><span class="comment"># Cumulative Var 0.31 0.6</span></span><br><span class="line"></span><br><span class="line">P <span class="operator">&lt;-</span> <span class="built_in">unclass</span><span class="punctuation">(</span>fa.promax<span class="operator">$</span>loadings<span class="punctuation">)</span></span><br><span class="line">P</span><br><span class="line"><span class="comment">#             PA1    PA2</span></span><br><span class="line"><span class="comment"># general  0.3691  0.484</span></span><br><span class="line"><span class="comment"># picture -0.0262  0.628</span></span><br><span class="line"><span class="comment"># blocks  -0.1036  0.966</span></span><br><span class="line"><span class="comment"># maze     0.0017  0.449</span></span><br><span class="line"><span class="comment"># reading  1.0033 -0.095</span></span><br><span class="line"><span class="comment"># vocab    0.8362 -0.014</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">F</span> <span class="operator">&lt;-</span> P <span class="operator">%*%</span> fa.promax<span class="operator">$</span>Phi</span><br><span class="line"><span class="built_in">F</span></span><br><span class="line"><span class="comment">#          PA1  PA2</span></span><br><span class="line"><span class="comment"># general 0.64 0.69</span></span><br><span class="line"><span class="comment"># picture 0.32 0.61</span></span><br><span class="line"><span class="comment"># blocks  0.43 0.91</span></span><br><span class="line"><span class="comment"># maze    0.25 0.45</span></span><br><span class="line"><span class="comment"># reading 0.95 0.46</span></span><br><span class="line"><span class="comment"># vocab   0.83 0.45</span></span><br></pre></td></tr></table></figure><p>现在你可以看到变量与因子间的相关系数。将它们与正交旋转所得因子载荷阵相比，会发现该载荷阵列的噪音比较大，这是因为之前你允许潜在因子相关。虽然斜交方法更为复杂，但模型将更符合真实数据。</p><p>使用 <code>factor.plot()</code> 或 <code>fa.diagram()</code> 函数，可以绘制正交或者斜交结果的图形。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">factor.plot<span class="punctuation">(</span>fa.promax<span class="punctuation">,</span> labels <span class="operator">=</span> row.names<span class="punctuation">(</span>fa.promax<span class="operator">$</span>loadings<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2022/08/02/JCfIiRxze7mjugw.png" style="zoom:80%;" /><p>可见，词汇和阅读在 PA1 上载荷较大，而积木图案、画图和迷宫在 PA2 上载荷较大。普通智力测验在两个因子上较为平均。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa.diagram<span class="punctuation">(</span>fa.promax<span class="punctuation">,</span> simple<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2022/08/02/ZSQHaB6ox3Uw2TX.png" style="zoom:80%;" /><p>若使 <code>simple = T</code>，那么将仅显示每个因子下最大的载荷，以及因子间的相关系数。这类图形在有多个因子时十分实用。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa.diagram<span class="punctuation">(</span>fa.promax<span class="punctuation">,</span> simple<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h3 id="例-2：Harman74-cov">例 2：<code>Harman74.cov</code></h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fa.parallel<span class="punctuation">(</span>Harman74.cor<span class="operator">$</span>cov<span class="punctuation">,</span> n.obs <span class="operator">=</span> <span class="number">145</span><span class="punctuation">,</span> fa<span class="operator">=</span><span class="string">&#x27;both&#x27;</span><span class="punctuation">,</span> n.iter <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">Parallel analysis suggests that the number of factors <span class="operator">=</span>  <span class="number">4</span>  and the number of components <span class="operator">=</span>  <span class="number">3</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2022/08/02/gSOrMNktf8qvX5Y.png" style="zoom:80%;" /><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fa.24 <span class="operator">&lt;-</span> fa<span class="punctuation">(</span>Harman74.cor<span class="operator">$</span>cov<span class="punctuation">,</span> nfactors <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> rotate <span class="operator">=</span> <span class="string">&#x27;promax&#x27;</span><span class="punctuation">)</span></span><br><span class="line">fa.diagram<span class="punctuation">(</span>fa.24<span class="punctuation">,</span> simple <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">factor.plot<span class="punctuation">(</span>fa.24<span class="punctuation">,</span> labels <span class="operator">=</span> row.names<span class="punctuation">(</span>fa.24<span class="operator">$</span>loadings<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/08/02/g2ZPirxaFXA7Wlv.png" alt="fa.diagram"></p><p><img src="https://s2.loli.net/2022/08/02/xbuclMHwsLziCd3.png" alt="factor.plot"></p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo deploy shell script</title>
      <link href="/posts/43603/"/>
      <url>/posts/43603/</url>
      
        <content type="html"><![CDATA[<h2 id="安装-Node-js">安装 Node.js</h2><p>使用 nvm 安装，<a href="https://github.com/coreybutler/nvm-windows/releases">Github 链接</a>。</p><p>最好装一个 Windows Terminal，安装完后输入 <code>nvm version</code> 查看是否安装成功。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm version</span><br><span class="line"><span class="comment"># 1.1.9</span></span><br></pre></td></tr></table></figure><p>安装 Node.js 并选择需要的版本。若报错，以管理员身份运行。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm install 16.15.0</span><br><span class="line">nvm use 16.15.0</span><br></pre></td></tr></table></figure><h2 id="安装-Git">安装 Git</h2><p>直接去 <a href="https://git-scm.com/">Git 官网</a>下载，全部默认安装就行。</p><h2 id="安装-Hexo">安装 Hexo</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>查看是否安装成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>如果以下错误</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo : 无法加载文件 C:\Program Files\nodejs\hexo.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 https:/go.micros</span><br><span class="line">oft.com/fwlink/?LinkID=135170 中的 about_Execution_Policies。</span><br><span class="line">所在位置 行:1 字符: 1</span><br><span class="line">+ hexo -v</span><br><span class="line">+ ~~~~</span><br><span class="line">    + CategoryInfo          : SecurityError: (:) []，PSSecurityException</span><br><span class="line">    + FullyQualifiedErrorId : UnauthorizedAccess</span><br></pre></td></tr></table></figure><p>执行</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set-executionpolicy</span> remotesigned</span><br></pre></td></tr></table></figure><p>再查看版本即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br><span class="line"><span class="comment"># hexo-cli: 4.3.0</span></span><br></pre></td></tr></table></figure><p>新建博客文件夹，切换到此路径，执行 Hexo 初始化。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure><p>本地运行，此时可以看见博客界面了</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><h2 id="安装-Butterfly-主题">安装 Butterfly 主题</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装渲染插件</span></span><br><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>安装其他所需插件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># katex 插件</span></span><br><span class="line">npm un hexo-renderer-marked --save <span class="comment"># 如果有安装这个的话，卸载</span></span><br><span class="line">npm un hexo-renderer-kramed --save <span class="comment"># 如果有安装这个的话，卸载</span></span><br><span class="line">npm install hexo-renderer-markdown-it --save <span class="comment"># 需要安装这个渲染插件</span></span><br><span class="line">npm install @neilsustc/markdown-it-katex --save <span class="comment">#需要安装这个 katex 插件</span></span><br><span class="line">npm install markdown-it-task-checkbox --save <span class="comment"># 任务列表插件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 并开启插件</span></span><br><span class="line"><span class="comment"># markdown:</span></span><br><span class="line"><span class="comment">#   plugins:</span></span><br><span class="line"><span class="comment">#     - plugin:</span></span><br><span class="line"><span class="comment">#       name: &#x27;@neilsustc/markdown-it-katex&#x27;</span></span><br><span class="line"><span class="comment">#       options:</span></span><br><span class="line"><span class="comment">#         strict: false</span></span><br><span class="line"><span class="comment">#     - markdown-it-emoji</span></span><br><span class="line"><span class="comment">#     - markdown-it-task-checkbox</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文章字数统计插件</span></span><br><span class="line">npm install hexo-wordcount --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># git 部署插件</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浏览器自动同步插件</span></span><br><span class="line">npm install hexo-browsersync --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># 短链生成插件</span></span><br><span class="line">npm install hexo-abbrlink --save</span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地搜索插件</span></span><br><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><h2 id="部署到-Github">部署到 Github</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>若报以下错误，是因为没有配置 git。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Initialized empty Git repository in C:/Users/USER/Desktop/blog_source/.deploy_git/.git/</span><br><span class="line">Author identity unknown</span><br><span class="line">*** Please tell me who you are.</span><br><span class="line">Run</span><br><span class="line"></span><br><span class="line">  git config --global user.email &quot;you@example.com&quot;</span><br><span class="line">  git config --global user.name &quot;Your Name&quot;</span><br><span class="line"></span><br><span class="line">to set your account&#x27;s default identity.</span><br><span class="line">Omit --global to set the identity only in this repository.</span><br><span class="line">fatal: unable to auto-detect email address (got &#x27;USER@202-030.(none)&#x27;)</span><br></pre></td></tr></table></figure><p>执行</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email <span class="string">&quot;you@example.com&quot;</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 比如</span></span><br><span class="line">git config --global user.email 10001@qq.com</span><br><span class="line">git config --global user.name xiaomage</span><br></pre></td></tr></table></figure><p>再次执行 <code>hexo d</code> 时，会弹出 Github 登录窗口，登录即可部署。</p><p>将 rsa 添加到 Github</p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记：4.28</title>
      <link href="/posts/10574/"/>
      <url>/posts/10574/</url>
      
        <content type="html"><![CDATA[<h2 id="纸化与纸质笔记">纸化与纸质笔记</h2><p>记了将近 4 个月的电子 planner 了，但是还是觉得没有作为习惯融入进生活，我感觉原因一方面是电子 planner 设置的条条框框太多，每周就只有一页日历，和一个 traker，像我这种话很多的人，一些随想都只能记在边边角角，而且大面的 to do list 对我这种预见性和控制性都不强的人来说简直是雪上加霜，每周都几乎重复着这种循环：</p><ol><li>新的一页开始了，然而并没有任何计划，空的to do list随便填</li><li>立满 flag</li><li>变化太多，不能完成，最开始焦虑，后来逐渐不在乎</li><li>下一周空空的 list 随便填；</li></ol><p>另一方面，感觉电子 planner 翻页还是太不方便了，而且没有翻页的感觉，总觉得少点什么（you know what I mean），就像无纸化虽然是我理想总的境界，但是对于漂亮文具还是有不可抑制的购买欲。在纸上写字的踏实的感觉，是 Apple Pencil 无法给予的；同时在纸上自由涂写的感觉，也是电子 planner 无法满足的（不知道为什么，有了自动修正这个功能之后感觉对格式有了更严重的强迫症）。</p><p>无纸化自然也有他的好处，目前我摸索下来最适宜的场景就是阅读大部头教材和课程 PPT，总之就是<strong>勾画文字</strong>用；课堂笔记感觉也不是很适合无纸化，作为一个不太（擅长）做笔记，也没有耐心做很完整的笔记的人，电子笔记对我来说只会让我更注意“形式”，最后笔记变成了办手抄报。</p><p>我觉得之后我只会做纸质笔记了，to be more specific，我做的纸质笔记只会有两种：</p><ul><li>闪卡类：纸张对折就是闪卡，我写下的都是我要背的，而且格式的标准有且只有：我这样写可以用来自测。</li><li>思维导图类：不是 Xmind 做出来的精美的那种，就是边读书边乱七八糟勾画出来的那种。</li></ul><h2 id="减肥观念">减肥观念</h2><p>今天看到一个关于减肥的观念：应该把减肥看作是一个改变生活习惯的过程，或者说，减少不良生活习惯的过程。在减肥的过程中，你应该确立的目标是我改掉了多少不良的生活习惯：是否按时作息，是否懒惰而没去运动，是否真正按照自己的需求吃饭（是否真的渴望吃一些高热量的食品，还是没做任何抵抗就屈服了），而不是这个月减了多少斤，如后者一样设立目标，最后还会回到导致肥胖的生活轨道上，从而必然会反弹。</p><p>由此我又想起之前看到的一个管理生活的方法，就是比起简历式的“成功清单”，建立一个“失败清单”，是否更有助于反省自己。从不同的时间尺度上记录自己的失败，什么样的失败只是失败而没有下文，什么样的失败再次尝试了，会不会让成功更有迹可循。举例说明，上述的减肥标准就可以作为失败清单的考察项目，比如我今天因为阴天没有运动，因为自助太诱人而把自己吃撑了。哇，写到这里感觉自己对自己好harsh。</p><p>最后，感觉这些事项还是记在纸上比较好，在小小的手册上是最完美的（已经下单了，哈哈哈哈哈哈哈哈）。</p><h2 id="背单词的治愈">背单词的治愈</h2><p>最近看《word power made easy》，并做习题和纸质笔记，感觉回到了初中高中，那种最传统的应试英语课上，很怀念。自大学以来，把除了最传统的应试法以外学英语的方法都尝试了一遍，最后发现还是备考雅思和 GRE 的时候词汇量，阅读能力提高最多（…）听力是精听最快，当然这属于应试英语的盲区。</p><p>背单词感觉是封校期间最能找到心灵平静的活动，就是那种单纯地用最传统、我最熟悉的方式获取知识的感觉，而且不用考试，这就是我这种小镇做题家的舒适圈，还有什么比这更治愈的呢？</p>]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随想 </tag>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R 笔记：Logistic 回归</title>
      <link href="/posts/65296/"/>
      <url>/posts/65296/</url>
      
        <content type="html"><![CDATA[<p>Logistic 回归是通过一系列连续或类别型的预测变量来预测<strong>二值型</strong>结果变量的方法。</p><p>如因变量为是否患胃癌，有是或否两种结果。选择两组人，一组为胃癌患者，另一组为正常。采集相关的数据作为自变量，如年龄、性别、饮食等等，可以有多种。自变量可以是连续的，也可以是因子类型的，通过Logistic回归，就可以大致了解哪些因素是胃癌的危险因素。</p><h2 id="分析数据集">分析数据集</h2><p>以 R 包 <code>AER</code> 中的 <code>Affairs</code> 数据集作为案例学习 Logistic 回归，分析可能与出轨有关的因素。</p><p><code>Affairs</code> 数据集包含了 601 个受访者的相关数据，包括出轨次数、性别、年龄、婚龄、是否有孩子、宗教、教育、职业及婚姻评分等 9 个变量。</p><p>安装并载入 <code>Affairs</code> 数据集</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;AER&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>Affairs<span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&#x27;AER&#x27;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>Affairs<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">]</span> <span class="punctuation">)</span></span><br><span class="line"><span class="comment">#    affairs gender age yearsmarried children</span></span><br><span class="line"><span class="comment"># 4        0   male  37           10       no</span></span><br><span class="line"><span class="comment"># 5        0 female  27            4       no</span></span><br><span class="line"><span class="comment"># 11       0 female  32           15      yes</span></span><br></pre></td></tr></table></figure><p>描述性统计一下</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>Affairs<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#         affairs       gender             age     yearsmarried  children   religiousness       education      occupation          rating     </span></span><br><span class="line"><span class="comment">#  Min.   : 0.000   female:315   Min.   :17.50   Min.   : 0.125   no :171   Min.   :1.000   Min.   : 9.00   Min.   :1.000   Min.   :1.000  </span></span><br><span class="line"><span class="comment">#  1st Qu.: 0.000   male  :286   1st Qu.:27.00   1st Qu.: 4.000   yes:430   1st Qu.:2.000   1st Qu.:14.00   1st Qu.:3.000   1st Qu.:3.000  </span></span><br><span class="line"><span class="comment">#  Median : 0.000                Median :32.00   Median : 7.000             Median :3.000   Median :16.00   Median :5.000   Median :4.000  </span></span><br><span class="line"><span class="comment">#  Mean   : 1.456                Mean   :32.49   Mean   : 8.178             Mean   :3.116   Mean   :16.17   Mean   :4.195   Mean   :3.932  </span></span><br><span class="line"><span class="comment">#  3rd Qu.: 0.000                3rd Qu.:37.00   3rd Qu.:15.000             3rd Qu.:4.000   3rd Qu.:18.00   3rd Qu.:6.000   3rd Qu.:5.000  </span></span><br><span class="line"><span class="comment">#  Max.   :12.000                Max.   :57.00   Max.   :15.000             Max.   :5.000   Max.   :20.00   Max.   :7.000   Max.   :5.000 </span></span><br><span class="line"></span><br><span class="line">table<span class="punctuation">(</span>Affairs<span class="operator">$</span>affairs<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   0   1   2   3   7  12 </span></span><br><span class="line"><span class="comment"># 451  34  17  19  42  38 </span></span><br><span class="line"></span><br><span class="line">prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>Affairs<span class="operator">$</span>affairs<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">*</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         0         1         2         3         7        12 </span></span><br><span class="line"><span class="comment"># 75.041597  5.657238  2.828619  3.161398  6.988353  6.322795 </span></span><br><span class="line"></span><br><span class="line">prop.table<span class="punctuation">(</span>table<span class="punctuation">(</span>Affairs<span class="operator">$</span>gender<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">*</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   female     male </span></span><br><span class="line"><span class="comment"># 52.41265 47.58735 </span></span><br></pre></td></tr></table></figure><p>只关注是否出轨，新建 <code>isaffair</code> 变量，并转换为因子</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Affairs<span class="operator">$</span>isaffair<span class="punctuation">[</span>Affairs<span class="operator">$</span>affairs <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">Affairs<span class="operator">$</span>isaffair<span class="punctuation">[</span>Affairs<span class="operator">$</span>affairs <span class="operator">==</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">table<span class="punctuation">(</span>Affairs<span class="operator">$</span>isaffair<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   0   1 </span></span><br><span class="line"><span class="comment"># 451 150 </span></span><br></pre></td></tr></table></figure><h2 id="glm-回归"><code>glm()</code> 回归</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">attach<span class="punctuation">(</span>Affairs<span class="punctuation">)</span></span><br><span class="line">fit <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>isaffair<span class="operator">~</span>gender<span class="operator">+</span>age<span class="operator">+</span>yearsmarried<span class="operator">+</span></span><br><span class="line">             children<span class="operator">+</span>religiousness<span class="operator">+</span>education<span class="operator">+</span></span><br><span class="line">             occupation<span class="operator">+</span>rating<span class="punctuation">,</span> data <span class="operator">=</span> Affairs<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Call:</span></span><br><span class="line"><span class="comment"># glm(formula = isaffair ~ gender + age + yearsmarried + children + </span></span><br><span class="line"><span class="comment">#     religiousness + education + occupation + rating, family = binomial(), </span></span><br><span class="line"><span class="comment">#     data = Affairs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deviance Residuals: </span></span><br><span class="line"><span class="comment">#     Min       1Q   Median       3Q      Max  </span></span><br><span class="line"><span class="comment"># -1.5713  -0.7499  -0.5690  -0.2539   2.5191  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Coefficients:</span></span><br><span class="line"><span class="comment">#               Estimate Std. Error z value Pr(&gt;|z|)    </span></span><br><span class="line"><span class="comment"># (Intercept)    1.37726    0.88776   1.551 0.120807    </span></span><br><span class="line"><span class="comment"># gendermale     0.28029    0.23909   1.172 0.241083    </span></span><br><span class="line"><span class="comment"># age           -0.04426    0.01825  -2.425 0.015301 *  </span></span><br><span class="line"><span class="comment"># yearsmarried   0.09477    0.03221   2.942 0.003262 ** </span></span><br><span class="line"><span class="comment"># childrenyes    0.39767    0.29151   1.364 0.172508    </span></span><br><span class="line"><span class="comment"># religiousness -0.32472    0.08975  -3.618 0.000297 ***</span></span><br><span class="line"><span class="comment"># education      0.02105    0.05051   0.417 0.676851    </span></span><br><span class="line"><span class="comment"># occupation     0.03092    0.07178   0.431 0.666630    </span></span><br><span class="line"><span class="comment"># rating        -0.46845    0.09091  -5.153 2.56e-07 ***</span></span><br><span class="line"><span class="comment"># ---</span></span><br><span class="line"><span class="comment"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (Dispersion parameter for binomial family taken to be 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     Null deviance: 675.38  on 600  degrees of freedom</span></span><br><span class="line"><span class="comment"># Residual deviance: 609.51  on 592  degrees of freedom</span></span><br><span class="line"><span class="comment"># AIC: 627.51</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of Fisher Scoring iterations: 4</span></span><br></pre></td></tr></table></figure><p>有四个变量显著，其余如性别、职业、教育等不显著，与实际情况类似。<br>将不显著的变量去除，再次回归</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">fit_new <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>isaffair<span class="operator">~</span>age<span class="operator">+</span>yearsmarried<span class="operator">+</span></span><br><span class="line">                 religiousness<span class="operator">+</span>rating<span class="punctuation">,</span> data <span class="operator">=</span> Affairs<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>fit_new<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Call:</span></span><br><span class="line"><span class="comment"># glm(formula = isaffair ~ age + yearsmarried + religiousness + </span></span><br><span class="line"><span class="comment">#     rating, family = binomial(), data = Affairs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deviance Residuals: </span></span><br><span class="line"><span class="comment">#     Min       1Q   Median       3Q      Max  </span></span><br><span class="line"><span class="comment"># -1.6278  -0.7550  -0.5701  -0.2624   2.3998  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Coefficients:</span></span><br><span class="line"><span class="comment">#               Estimate Std. Error z value Pr(&gt;|z|)    </span></span><br><span class="line"><span class="comment"># (Intercept)    1.93083    0.61032   3.164 0.001558 ** </span></span><br><span class="line"><span class="comment"># age           -0.03527    0.01736  -2.032 0.042127 *  </span></span><br><span class="line"><span class="comment"># yearsmarried   0.10062    0.02921   3.445 0.000571 ***</span></span><br><span class="line"><span class="comment"># religiousness -0.32902    0.08945  -3.678 0.000235 ***</span></span><br><span class="line"><span class="comment"># rating        -0.46136    0.08884  -5.193 2.06e-07 ***</span></span><br><span class="line"><span class="comment"># ---</span></span><br><span class="line"><span class="comment"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (Dispersion parameter for binomial family taken to be 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     Null deviance: 675.38  on 600  degrees of freedom</span></span><br><span class="line"><span class="comment"># Residual deviance: 615.36  on 596  degrees of freedom</span></span><br><span class="line"><span class="comment"># AIC: 625.36</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of Fisher Scoring iterations: 4</span></span><br></pre></td></tr></table></figure><p>可以用 <code>anova()</code> 分析比较一下两个模型<br>对于广义线性回归，可使用卡方检验</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">anova<span class="punctuation">(</span>fit<span class="punctuation">,</span> fit_new<span class="punctuation">,</span> test <span class="operator">=</span> <span class="string">&#x27;Chisq&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Analysis of Deviance Table</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Model 1: isaffair ~ gender + age + yearsmarried + children + religiousness + </span></span><br><span class="line"><span class="comment">#     education + occupation + rating</span></span><br><span class="line"><span class="comment"># Model 2: isaffair ~ age + yearsmarried + religiousness + rating</span></span><br><span class="line"><span class="comment">#   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)</span></span><br><span class="line"><span class="comment"># 1       592     609.51                     </span></span><br><span class="line"><span class="comment"># 2       596     615.36 -4  -5.8474   0.2108</span></span><br></pre></td></tr></table></figure><p>卡方检验值不显著，说明两个模型差别不大，去除的变量不会显著提高方程的预测精度。</p><h2 id="结果解释">结果解释</h2><h3 id="回归系数">回归系数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">coef<span class="punctuation">(</span>fit_new<span class="punctuation">)</span></span><br><span class="line">  <span class="comment"># (Intercept)           age  yearsmarried religiousness        rating </span></span><br><span class="line">  <span class="comment">#  1.93083017   -0.03527112    0.10062274   -0.32902386   -0.46136144 </span></span><br></pre></td></tr></table></figure><p>Logistic 回归中，响应变量是 y=e 的对数优势比，回归系数的含义是，当其他的预测变量不变时，一单位预测变量变化时，可能引起的响应变量对数优势比的变化。<br>由于使用的是对数优势比，需进行指数运算才能回到正常模式。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exp</span><span class="punctuation">(</span>coef<span class="punctuation">(</span>fit_new<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="comment"># (Intercept)           age  yearsmarried religiousness        rating </span></span><br><span class="line">  <span class="comment">#   6.8952321     0.9653437     1.1058594     0.7196258     0.6304248 </span></span><br></pre></td></tr></table></figure><p>结果表示，当婚龄增加一年时，出轨的优势比将×1.1058594；相反年龄增加一岁时，出轨的优势比将×0.9653437，即婚龄越大，越容易出轨，年龄越小越容易出轨。预测变量不能为0，所以截距项没有意义。</p><h3 id="预测数据">预测数据</h3><p>创建新的数据集用来预测，这里选平均值</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 评分变化</span></span><br><span class="line">test <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rating<span class="operator">=</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> age<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>age<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   yearsmarried<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>yearsmarried<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   religiousness<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>religiousness<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">test</span><br><span class="line"><span class="comment">#   rating      age yearsmarried religiousness</span></span><br><span class="line"><span class="comment"># 1      1 32.48752     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 2      2 32.48752     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 3      3 32.48752     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 4      4 32.48752     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 5      5 32.48752     8.177696      3.116473</span></span><br><span class="line"></span><br><span class="line">test<span class="operator">$</span>prob <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit_new<span class="punctuation">,</span> newdata <span class="operator">=</span> test<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&#x27;response&#x27;</span><span class="punctuation">)</span></span><br><span class="line">test</span><br><span class="line"><span class="comment">#   rating      age yearsmarried religiousness      prob</span></span><br><span class="line"><span class="comment"># 1      1 32.48752     8.177696      3.116473 0.5302296</span></span><br><span class="line"><span class="comment"># 2      2 32.48752     8.177696      3.116473 0.4157377</span></span><br><span class="line"><span class="comment"># 3      3 32.48752     8.177696      3.116473 0.3096712</span></span><br><span class="line"><span class="comment"># 4      4 32.48752     8.177696      3.116473 0.2204547</span></span><br><span class="line"><span class="comment"># 5      5 32.48752     8.177696      3.116473 0.1513079</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 年龄变化</span></span><br><span class="line">test <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rating<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>rating<span class="punctuation">)</span><span class="punctuation">,</span> age<span class="operator">=</span>seq<span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">60</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   yearsmarried<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>yearsmarried<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   religiousness<span class="operator">=</span>mean<span class="punctuation">(</span>Affairs<span class="operator">$</span>religiousness<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">test</span><br><span class="line"><span class="comment">#    rating age yearsmarried religiousness</span></span><br><span class="line"><span class="comment"># 1 3.93178  20     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 2 3.93178  30     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 3 3.93178  40     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 4 3.93178  50     8.177696      3.116473</span></span><br><span class="line"><span class="comment"># 5 3.93178  60     8.177696      3.116473</span></span><br><span class="line">test<span class="operator">$</span>prob <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>fit_new<span class="punctuation">,</span> newdata <span class="operator">=</span> test<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&#x27;response&#x27;</span><span class="punctuation">)</span></span><br><span class="line">test</span><br><span class="line"><span class="comment">#    rating age yearsmarried religiousness       prob</span></span><br><span class="line"><span class="comment"># 1 3.93178  20     8.177696      3.116473 0.31193344</span></span><br><span class="line"><span class="comment"># 2 3.93178  30     8.177696      3.116473 0.24162210</span></span><br><span class="line"><span class="comment"># 3 3.93178  40     8.177696      3.116473 0.18294542</span></span><br><span class="line"><span class="comment"># 4 3.93178  50     8.177696      3.116473 0.13596342</span></span><br><span class="line"><span class="comment"># 5 3.93178  60     8.177696      3.116473 0.09957638</span></span><br></pre></td></tr></table></figure><p>可见评分约低，出轨的可能性越大；年龄约小，出轨的可能性越大。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>折腾博客的思考🤔</title>
      <link href="/posts/22544/"/>
      <url>/posts/22544/</url>
      
        <content type="html"><![CDATA[<p>研究了四五天的博客搭建，看了各种用户文档，可以说是废寝忘食🤓，一睡醒就在想怎么把博客弄得符合自己的要求。但是这真的有意义吗？这引起了我的思考。</p><span id="more"></span><p>起因是这样的，这几天都在用 Typora 写 R 语言的学习笔记。虽然它都编辑方式很友好，和 Word 一样所见即所得，也可以用各种快捷键帮助格式化，不用记 Markdown 的语法，但是，再尝试了官网的所有主题之后，我依然没有找到趁手的……不是我挑，有的配色挺好，但段落间距不太合适；有的间距很舒服，但中文字体支持不好，看起来很糟糕；有的很棒，支持思源黑体，但是配色又不好。就这样来来回回换了十几个主题，也改了不少主题文件，终于，累了，太费劲了，不如另起炉灶。</p><p>于是我先是去网上找好用的 Markdown 编辑器，要所见即所得的。几番寻找，不少人都提到了 Gridea 这个静态博客客户端。看了几个样板博客，发现还挺不错，排版很舒服，关键是可以部署到 GitHub 上，这样在哪都能访问了，也可以分享给其他人。</p><p>说干就干，试着用自带的模版建了一个博客，还传到了 GitHub Pages 上。访问和排版都没有问题，但是，但是，官方都模板功能很基础，没有文章目录，也没有黑暗模式，我怎么能忍呢😑？又去找 Gridea 的主题，发现了两个不错的：Porky 和 Pure。Porky 自带黑暗模式，配色很喜欢；Pure 只有几种配色可选，没有黑暗模式，但是文章的排版很喜欢；其他主题要么太花哨，要么太简陋。这可咋整，好但没完全好。</p><p>为了追求“完美”，我一个学生物的竟然开始捣鼓起了 <code>HTML</code> 😨。什么 <code>body</code>、<code>border-radius</code>、<code>background</code>、<code>p</code>、<code>a</code>、<code>#FFD700</code> 等等各种有关网页的知识开始充斥我的大脑🤤。为了迅速了解相关知识，没少看各种文档。经过不断的学习、摸索和修改，终于把原 Porky 主题改成我喜欢的样式了，很高兴，我终于有自己的博客了😎！</p><p>不过问题又来了，还是少很多东西啊，代码高亮、文章目录、返回顶部、全文搜索等功能都没有。我尝试着从其他的主题中移植这些功能（其实就是照猫画虎），千辛万苦把代码高亮搞定了。但是由于没有学过 <code>HTML</code> 语法，其他的功能怎么弄也实现不了。这种感觉很糟，想做确做不了，无能为力，心力憔悴😣。一度想就此放弃，毕竟现有功能也不是说不够用。但是，得不到的永远在骚动，心里还是放不下，我想要😭！</p><p>又于是乎，经过搜索，我发现了比 Gridea 更强大的 Hexo。</p><blockquote><p>Hexo is a fast, simple &amp; powerful blog framework powered by Node.js.</p></blockquote><p>官网说 Hexo 有以下优点</p><blockquote><ul><li>Node.js 所带来的超快生成速度，让上百个页面在几秒内瞬间完成渲染。</li><li>Hexo 支持 GitHub Flavored Markdown 的所有功能，甚至可以整合 Octopress 的大多数插件。</li><li>只需一条指令即可部署到 GitHub Pages, Heroku 或其他平台。</li><li>强大的 API 带来无限的可能，与数种模板引擎（EJS，Pug，Nunjucks）和工具（Babel，PostCSS，Less/Sass）轻易集成</li></ul></blockquote><p>只需要几个命令就能使用 Hexo</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo init blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>🤞Wow，这么 NB ？！这不正是我想要的吗？Hexo 安装和部署的全过程均使用命令行完成，还好学过一点 Linux，再加上有前人已经帮踩坑了，很快就搭建起了博客。 Hexo 虽比 Gridea 更强大，但是相应的配置也要复杂一些，还没有图形化的界面，全靠编辑配置文件 。不过这都没啥，早已身经百战了 👓 。</p><p>又是一番折腾，Hexo 也配置好了。正当我以为可以歇歇时，一看主题市场，好家伙一共 362 个主题！这个兴奋啊，这总不能没有我喜欢的了吧🤓？下主题、配置主题、看效果，这一套流程走了有几十遍，然而，还真没有……我 **！要吐血了！有的主题功能很全，我先要的全部都有，但是往往太花哨了；有的呢，简洁舒服，但是功能又不够。啊！这不又回去了吗……</p><p>唉😟，咋整？</p><p>回过头来看，想起一句笑话</p><blockquote><p>差生文具多</p></blockquote><p>这可不是我吗？过于注重形式，而忽略了内容。</p><blockquote><p>内容与形式是辩证法的一对基本范畴，内容是事物一切内在要素的总和，形式是这些内在要素的结构和组织方式。</p></blockquote><p>内容和形式的关系是辩证统一的。任何事物既有其内容，也有其形式，不存在无内容的形式，也没有无形式的内容，内容决定形式，形式服从内容，并随内容的变化而变化。形式对内容又有反作用，形式适合内容，就促进内容的发展，形式不适合内容，则阻碍内容的发展。</p><p>就好比钢琴十级的初学者和朗朗的差别，内容上的差异反应在他们的演奏技术和艺术上，形式上的差异则可以说是演奏形式。初学者随便一个钢琴就能弹，并且曲子都很简单，也说不上什么艺术；朗朗呢，世界级钢琴演奏家，钢琴肯定是很贵的。这不是说便宜的钢琴不能弹，他 B 站上还有弹玩具钢琴的视频，而是普通的会极大地限制朗朗的发挥。</p><p>这下我明白了，是 Gredia 不够用吗，不是，而是我过于关注博客形式，却忽略了博客的内容。内容才是一个博客的精华，就像用什么设备拍摄并不重要，拍摄的内容，讲的故事才是主要的，咳咳。一个博客，它可以很简陋，可以很粗糙。前几天学 R 语言的时候看到的一个北大老师的博客，教授级配色、各种颜色混搭，就像是没有没有装修的毛胚房，可以说与现在的审美完全不搭。但是，里面可全是好东西。一个博客，它不可以没有内容。看过几个全屏雪花乱飞，左下角有只猫会跟着鼠标转头，点击鼠标还会发射小心心的博客，里面确没啥实质性的东西，还有广告。装饰无可厚非，但是虚有其表，外强中干就不是什么值得提倡的好事了。如果我再这样下去，我的博客也会像这样吧，好看是好看，但是文章没几篇。</p><p>好的形式能促进内容的发展，什么是好的形式？首先好的形式要适合内容，要和内容相得益彰，既不过于低劣至于拖内容的后腿，也不能太过超越至于宣兵夺主；其次好的形式要给内容留以发展空间，内容是会变化的，总体是向上的，形式如果没有足够的空间，终究也不适合内容的发展。</p><p>所以，重心还是在内容上，过分关注形式是本末倒置。先好好写文章，耐心沉淀，等什么时候博客的功能确实是不够用了，再来升级吧😼。</p>]]></content>
      
      
      <categories>
          
          <category> 日记随想 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随想 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记：4.25</title>
      <link href="/posts/60559/"/>
      <url>/posts/60559/</url>
      
        <content type="html"><![CDATA[<p>特邀作者：猫猫</p><h2 id="实验">实验</h2><ul><li>做到最后一步了，成败在此一举！</li><li>真的很希望能做成功，这样离逃离这个地狱又近了一步。中期过去之后都比较顺利，嘿嘿～</li><li>师兄说好明天去拍电镜，今天上午又说拍不了，emo 了一会儿，下午又说可以拍了吼吼吼好开心～</li><li>那个送去拍电镜的电极结果很好，如果这个不成还可以用拍电镜的这个继续做。</li><li><blockquote><p>噶油~</p></blockquote></li><li>旋转烘箱像烤鸡的电烤箱…！DMF 洒到裤子上了，裤子不能要了，幸亏没洒到有洞的地方……这件事告诉我们做实验不能穿太好的衣服，也不能穿 literally 太破的衣服……</li><li>室友课题组的老师好凶，一个破碎仪坏了都要说什么天打五雷劈的鬼话，很难相信这是从一个学者口中说出来的，果然贫贱科研百事哀啊（望着原子力显微镜和曲面显示屏的感慨）！</li></ul><h2 id="吃">吃</h2><ul><li>最近早餐沉迷酸菜猪肉馅包子，好好吃。想吃妈妈做的酸菜猪肉炖粉条子了。</li><li>中午 @aohuiliu 为了安慰 emo 的我，请客吃了钵钵鸡，猪皮好好吃，也不是很辣，喜欢（ both 钵钵鸡 and 人）。</li><li><blockquote><p>䨻猫组 5</p></blockquote></li><li>晚饭抛弃了方便面，吃了套餐，没有二楼好吃。</li><li>买了昨天还卖 12 今天就卖 10 块的草莓，一盒几乎有 2 斤，中午吃一半，晚上吃了一半，撑死了，嗝～</li><li><blockquote><p>摸肚肚！哈哈哈哈哈哈哈哈！</p></blockquote></li></ul><h2 id="运动">运动</h2><ul><li>早上和 @aohuiliu 跑了 1.7 km，累累 5</li><li><blockquote><p>我 2.5 km 55555</p></blockquote></li></ul><h2 id="乱七芭蕉">乱七芭蕉</h2><ul><li>扎了小辫子，好像戳到某人的 xp 了（某人可以贴图）</li><li>今天玩的单词游戏是包含 ea 的单词，某人好菜</li><li>快递终于到了，3.29 日下单的，哈哈。</li><li>今天也喜欢 aohuiliu。</li><li><blockquote><p>今天也喜欢猫嘿嘿</p></blockquote></li></ul><img src="https://s2.loli.net/2022/06/14/tmpXybJfEP2oKeZ.jpg" alt="1" style="zoom:70%;" /><img src="https://s2.loli.net/2022/06/14/t3oI1u9hApzJRBn.jpg" alt="2" style="zoom:70%;" />]]></content>
      
      
      <categories>
          
          <category> 猫猫专栏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记：4.24</title>
      <link href="/posts/11342/"/>
      <url>/posts/11342/</url>
      
        <content type="html"><![CDATA[<h2 id="🐱的小辫子">🐱的小辫子</h2><p>一个字，可爱😽。<br>再来一个就更好了🤓。</p><h2 id="hia">hia</h2><p>😻给的红油面皮+豆干蛋<br>好香，好 hia！</p><h2 id="单词游戏">单词游戏</h2><p>c 开头， b 开头，sh 开头，<br>sh*t, di*k,<br>还挺好玩哈哈哈哈，停不下来，煮面皮的时候还在想。</p><h2 id="背了😹的包包">背了😹的包包</h2><img src="https://s2.loli.net/2022/06/14/wQAvlELdBcHniMS.jpg" alt="猫猫的包" style="zoom:80%;" />像个傻子<h2 id="实验室差距">实验室差距</h2><p>曲面显示器，超大屏幕……<br>我们怎么没有？</p><h2 id="沉迷博客装修">沉迷博客装修</h2><p>搞了一天，终于有点样子了。</p><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_0" checked="true" disabled="true"><label for="cbx_0"> 黑暗模式</label></li><li class="task-list-item"><input type="checkbox" id="cbx_1" checked="true" disabled="true"><label for="cbx_1"> 代码高亮</label></li><li class="task-list-item"><input type="checkbox" id="cbx_2" checked="true" disabled="true"><label for="cbx_2"> 图片圆角</label></li><li class="task-list-item"><input type="checkbox" id="cbx_3" checked="true" disabled="true"><label for="cbx_3"> 阴影去掉</label></li></ul><p><strong>代办</strong></p><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_4" disabled="true"><label for="cbx_4"> 文章目录</label></li><li class="task-list-item"><input type="checkbox" id="cbx_5" disabled="true"><label for="cbx_5"> 滚动进度</label></li><li class="task-list-item"><input type="checkbox" id="cbx_6" disabled="true"><label for="cbx_6"> 一键返回</label></li></ul><p>吐槽一句，Github 同步怎么老是失败？？</p><h2 id="MTT-Done">MTT Done!</h2><p>貌似是最后一个实验，结果还没看。<br>实验室的酶标仪真的垃圾，打印出来的字还没食堂打小票的清楚……<br>没办法直接导出电子版，还得手输。</p><p>折线图添加显著性检验标记（<em>p</em> 值）的 R 脚本已完成，运行即可。</p>]]></content>
      
      
      <categories>
          
          <category> 日记随想 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日记：4.23</title>
      <link href="/posts/60943/"/>
      <url>/posts/60943/</url>
      
        <content type="html"><![CDATA[<p>和猫猫的一些日常~</p><h2 id="hia😁">hia😁</h2><p>小炒鸡腿肉<br>凉皮+盐酥鸡块</p><p><strong>姐姐</strong>请客：<em>双炫冰激凌</em></p><h2 id="还是hia，不过是xx">还是hia，不过是xx</h2><p>****** 此处省略</p><h2 id="🌸🌸">🌸🌸</h2><p>猫猫戴着好可爱 (*^▽^*)</p><h2 id="MTT实验">MTT实验</h2><p>终于结束，明天还有一个数据<br>但是好像不咋地……</p>]]></content>
      
      
      <categories>
          
          <category> 日记随想 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>R 笔记：t 检验</title>
      <link href="/posts/17149/"/>
      <url>/posts/17149/</url>
      
        <content type="html"><![CDATA[<p>Student’s t test 是假设检验的重要方法。</p><span id="more"></span><h2 id="Student’s-t-test-2">Student’s t test</h2><p>学生 t 检验（student’s t test，也称 t-test）是一种统计检验，用于比较两组的均值。在假设检验中常用于确定某个过程、处理是否对目标真的有显著影响，或者两组是否有显著差异。<br>比如：想知道鸢尾花的平均花瓣长度是否和花的种类有关，收集两种鸢尾花的花瓣长度数据，每组测量 25 次，可使用 t 检验检测两组之间的差异。</p><p>零假设 H<sub>0</sub>：两组均值之间的真实差异为零，即没有差异</p><p>备择假设 H<sub>a</sub>：真实差异不为零</p><p>适用情况： t 检验只能用于比较两组的均值（也称成对比较），如果想比较两组以上，用 ANOVA 检验或 post-hoc test。</p><h2 id="t-检验的假设前提和类型">t 检验的假设前提和类型</h2><h3 id="t-检验假设"><strong>t 检验假设</strong></h3><ol><li>数据之间相互独立</li><li>数据满足（或近似满足）正态分布</li><li>方差同质性：被比较的组的方差相似</li></ol><p>若数据不满足要求，可以尝试非参数检验（nonparametric test），如 Wilcoxon Signed-Rank test。</p><h3 id="t-检验类型"><strong>t 检验类型</strong></h3><p>one-sample，two-sample，paired t-test？</p><ul><li>paired t-test，配对样本均值检验：组来自同一类别（如某种处理的前后测量）</li><li>two-sample，两独立样本均值检验：组来自两个不同类别（如两种物种，来自两个城市的人），也即 independent t-stet</li><li>one-sample，单样本均值检验：一组和标准值相比较（如将液体的 pH 与中性 pH 7 相比）</li></ul><p>one-tailed，two-tailed t-test？</p><ul><li>two-tailed， 双侧 t 检验：只关注两组是否有差异</li><li>one-tailed，单侧 t 检验：需要知道两组的均值谁大谁小</li></ul><p>如想知道鸢尾花的平均花瓣长度是否和花的种类有关，观测来自两种花，故使用 two-sample t-test；只关注是否有差异，故使用 two-tailed t-test。</p><h3 id="t-检验方程"><strong>t 检验方程</strong></h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mrow><mover accent="true"><msub><mi>x</mi><mn>1</mn></msub><mo>ˉ</mo></mover><mo>−</mo><mover accent="true"><msub><mi>x</mi><mn>2</mn></msub><mo>ˉ</mo></mover></mrow><msqrt><mrow><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo stretchy="false">)</mo></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">t=\frac{\bar{x_{1}}-\bar{x_{2}}}{\sqrt{s^{2}(\frac{1}{n_{1} }+ \frac{1}{n_{2} })} }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9903em;vertical-align:-1.73em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.185em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.185em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.145em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90l0 -0c4,-6.7,10,-10,18,-10 H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5zM1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.655em;"><span></span></span></span></span></span></span></span><span style="top:-3.415em;"><span class="pstrut" style="height:3.185em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.862em;"><span class="pstrut" style="height:3.185em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>式中，t 为 t 值，x1，x2 是两组的均值，s两组的合并标准误差，n1，n2 是每组的观测个数</p><p>t 值大，则两组的均值差异大于合并标准误差，表明两组的差异显著</p><h2 id="实例"><strong>实例</strong></h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检验鸢尾花花瓣长度是否与花的种类有关</span></span><br><span class="line"><span class="comment"># Petal.Length：花瓣长度</span></span><br><span class="line"><span class="comment"># Species：花种类</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> flower.data <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;flower.data.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;character&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为因子</span></span><br><span class="line"><span class="operator">&gt;</span> flower.data<span class="operator">$</span>Species <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> <span class="built_in">class</span><span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;factor&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>flower.data<span class="punctuation">)</span></span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>  setosa</span><br><span class="line"><span class="number">5</span>          <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.7</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="operator">&gt;</span> table<span class="punctuation">(</span>flower.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">   setosa virginica </span><br><span class="line">       <span class="number">25</span>        <span class="number">25</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># two-sample two-tailed t test</span></span><br><span class="line"><span class="operator">&gt;</span> t.test<span class="punctuation">(</span>Petal.Length<span class="operator">~</span>Species<span class="punctuation">,</span> flower.data<span class="punctuation">,</span> paired<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span> alternative<span class="operator">=</span><span class="string">&#x27;two.sided&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Welch Two Sample t<span class="operator">-</span>test</span><br><span class="line"></span><br><span class="line">data<span class="operator">:</span>  Petal.Length by Species</span><br><span class="line">t <span class="operator">=</span> <span class="operator">-</span><span class="number">33.719</span><span class="punctuation">,</span> df <span class="operator">=</span> <span class="number">30.196</span><span class="punctuation">,</span> p<span class="operator">-</span>value <span class="operator">&lt;</span> <span class="number">2.2e-16</span></span><br><span class="line">alternative hypothesis<span class="operator">:</span> true difference <span class="keyword">in</span> means between group setosa and group virginica is not equal to <span class="number">0</span></span><br><span class="line"><span class="number">95</span> percent confidence interval<span class="operator">:</span></span><br><span class="line"> <span class="operator">-</span><span class="number">4.331287</span> <span class="operator">-</span><span class="number">3.836713</span></span><br><span class="line">sample estimates<span class="operator">:</span></span><br><span class="line">   mean <span class="keyword">in</span> group setosa mean <span class="keyword">in</span> group virginica </span><br><span class="line">                  <span class="number">1.456</span>                   <span class="number">5.540</span> </span><br></pre></td></tr></table></figure><p><code>t.test()</code> 输出内容解释</p><ul><li><code>data</code>：对比项</li><li><code>t</code> 值：-33.719，虽然是负的，但是大多数情况下，只关注其绝对值</li><li><code>df</code>：自由度，30.196，自由度与样本大小有关，表示有多少数据点可用于比较，自由度越大，统计检验越有效</li><li><code>p</code> 值：2.2e-16，偶然得到这样的<code>t</code>值的概率</li><li><code>alternative hypothesis</code>：备择假设，setosa 和 virginica 组的真实均值差异不为0</li><li><code>95% confidence interval</code>：95% 置信区间，真实的均值差在 95% 可能性下所处的区间，即两组的真实均值差有 95% 可能性处于<code>[-4.331287, -3.836713]</code>区间内；可以更改区间，但 95% 常用</li><li><code>mean</code>：各组的均值</li></ul><p>由以上结果，样本数据的均值差 = 1.456 - 5.540 = -4.084，置信区间显示均值的真实差异在 <code>[-4.331287, -3.836713]</code> 之间。所以，95% 的情况下均值的真实差异不为0。<code>p</code> 值远小于 0.05，所以可以拒绝原假设（均值差异为0），即可以说，均值的真实差异显著不为0。</p><h2 id="t-检验总结方式"><strong>t 检验总结方式</strong></h2><p>展示重要的信息：t 值，p 值，自由度</p><p>也可以带上均值（mean）和标准差差（standard deviation）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> flower.data <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>Species<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  dplyr<span class="operator">::</span>summarize<span class="punctuation">(</span>mean_length<span class="operator">=</span>mean<span class="punctuation">(</span>Petal.Length<span class="punctuation">)</span><span class="punctuation">,</span>sd_length<span class="operator">=</span>sd<span class="punctuation">(</span>Petal.Length<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 2 x 3</span></span><br><span class="line">  Species   mean_length sd_length</span><br><span class="line">  <span class="operator">&lt;</span>fct<span class="operator">&gt;</span>           <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span>     <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> setosa           <span class="number">1.46</span>     <span class="number">0.206</span></span><br><span class="line"><span class="number">2</span> virginica        <span class="number">5.54</span>     <span class="number">0.569</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> R </tag>
            
            <tag> 统计检验 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
